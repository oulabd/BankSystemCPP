"use strict";var Fv=Object.create;var on=Object.defineProperty;var jv=Object.getOwnPropertyDescriptor;var qv=Object.getOwnPropertyNames;var Uv=Object.getPrototypeOf,Wv=Object.prototype.hasOwnProperty;var ne=(s,e)=>()=>(s&&(e=s(s=0)),e);var _=(s,e)=>()=>(e||s((e={exports:{}}).exports,e),e.exports),eo=(s,e)=>{for(var t in e)on(s,t,{get:e[t],enumerable:!0})},ec=(s,e,t,n)=>{if(e&&typeof e=="object"||typeof e=="function")for(let r of qv(e))!Wv.call(s,r)&&r!==t&&on(s,r,{get:()=>e[r],enumerable:!(n=jv(e,r))||n.enumerable});return s};var G=(s,e,t)=>(t=s!=null?Fv(Uv(s)):{},ec(e||!s||!s.__esModule?on(t,"default",{value:s,enumerable:!0}):t,s)),Vv=s=>ec(on({},"__esModule",{value:!0}),s);var cc=_((KR,ic)=>{function Hv(){this.__data__=[],this.size=0}ic.exports=Hv});var so=_((ZR,lc)=>{function Bv(s,e){return s===e||s!==s&&e!==e}lc.exports=Bv});var _s=_((JR,uc)=>{var zv=so();function Gv(s,e){for(var t=s.length;t--;)if(zv(s[t][0],e))return t;return-1}uc.exports=Gv});var pc=_((QR,dc)=>{var Kv=_s(),Zv=Array.prototype,Jv=Zv.splice;function Qv(s){var e=this.__data__,t=Kv(e,s);if(t<0)return!1;var n=e.length-1;return t==n?e.pop():Jv.call(e,t,1),--this.size,!0}dc.exports=Qv});var hc=_((XR,fc)=>{var Xv=_s();function Yv(s){var e=this.__data__,t=Xv(e,s);return t<0?void 0:e[t][1]}fc.exports=Yv});var gc=_((YR,mc)=>{var ey=_s();function ty(s){return ey(this.__data__,s)>-1}mc.exports=ty});var yc=_((eT,vc)=>{var ry=_s();function sy(s,e){var t=this.__data__,n=ry(t,s);return n<0?(++this.size,t.push([s,e])):t[n][1]=e,this}vc.exports=sy});var Es=_((tT,bc)=>{var ny=cc(),ay=pc(),oy=hc(),iy=gc(),cy=yc();function zr(s){var e=-1,t=s==null?0:s.length;for(this.clear();++e<t;){var n=s[e];this.set(n[0],n[1])}}zr.prototype.clear=ny;zr.prototype.delete=ay;zr.prototype.get=oy;zr.prototype.has=iy;zr.prototype.set=cy;bc.exports=zr});var wc=_((rT,xc)=>{var ly=Es();function uy(){this.__data__=new ly,this.size=0}xc.exports=uy});var Sc=_((sT,Pc)=>{function dy(s){var e=this.__data__,t=e.delete(s);return this.size=e.size,t}Pc.exports=dy});var Ec=_((nT,_c)=>{function py(s){return this.__data__.get(s)}_c.exports=py});var Rc=_((aT,Cc)=>{function fy(s){return this.__data__.has(s)}Cc.exports=fy});var no=_((oT,Tc)=>{var hy=typeof global=="object"&&global&&global.Object===Object&&global;Tc.exports=hy});var St=_((iT,Ac)=>{var my=no(),gy=typeof self=="object"&&self&&self.Object===Object&&self,vy=my||gy||Function("return this")();Ac.exports=vy});var dn=_((cT,Ic)=>{var yy=St(),by=yy.Symbol;Ic.exports=by});var $c=_((lT,Dc)=>{var kc=dn(),Oc=Object.prototype,xy=Oc.hasOwnProperty,wy=Oc.toString,Cs=kc?kc.toStringTag:void 0;function Py(s){var e=xy.call(s,Cs),t=s[Cs];try{s[Cs]=void 0;var n=!0}catch{}var r=wy.call(s);return n&&(e?s[Cs]=t:delete s[Cs]),r}Dc.exports=Py});var Lc=_((uT,Mc)=>{var Sy=Object.prototype,_y=Sy.toString;function Ey(s){return _y.call(s)}Mc.exports=Ey});var Rs=_((dT,jc)=>{var Nc=dn(),Cy=$c(),Ry=Lc(),Ty="[object Null]",Ay="[object Undefined]",Fc=Nc?Nc.toStringTag:void 0;function Iy(s){return s==null?s===void 0?Ay:Ty:Fc&&Fc in Object(s)?Cy(s):Ry(s)}jc.exports=Iy});var ao=_((pT,qc)=>{function ky(s){var e=typeof s;return s!=null&&(e=="object"||e=="function")}qc.exports=ky});var oo=_((fT,Uc)=>{var Oy=Rs(),Dy=ao(),$y="[object AsyncFunction]",My="[object Function]",Ly="[object GeneratorFunction]",Ny="[object Proxy]";function Fy(s){if(!Dy(s))return!1;var e=Oy(s);return e==My||e==Ly||e==$y||e==Ny}Uc.exports=Fy});var Vc=_((hT,Wc)=>{var jy=St(),qy=jy["__core-js_shared__"];Wc.exports=qy});var zc=_((mT,Bc)=>{var io=Vc(),Hc=function(){var s=/[^.]+$/.exec(io&&io.keys&&io.keys.IE_PROTO||"");return s?"Symbol(src)_1."+s:""}();function Uy(s){return!!Hc&&Hc in s}Bc.exports=Uy});var co=_((gT,Gc)=>{var Wy=Function.prototype,Vy=Wy.toString;function Hy(s){if(s!=null){try{return Vy.call(s)}catch{}try{return s+""}catch{}}return""}Gc.exports=Hy});var Zc=_((vT,Kc)=>{var By=oo(),zy=zc(),Gy=ao(),Ky=co(),Zy=/[\\^$.*+?()[\]{}|]/g,Jy=/^\[object .+?Constructor\]$/,Qy=Function.prototype,Xy=Object.prototype,Yy=Qy.toString,eb=Xy.hasOwnProperty,tb=RegExp("^"+Yy.call(eb).replace(Zy,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function rb(s){if(!Gy(s)||zy(s))return!1;var e=By(s)?tb:Jy;return e.test(Ky(s))}Kc.exports=rb});var Qc=_((yT,Jc)=>{function sb(s,e){return s?.[e]}Jc.exports=sb});var cr=_((bT,Xc)=>{var nb=Zc(),ab=Qc();function ob(s,e){var t=ab(s,e);return nb(t)?t:void 0}Xc.exports=ob});var pn=_((xT,Yc)=>{var ib=cr(),cb=St(),lb=ib(cb,"Map");Yc.exports=lb});var Ts=_((wT,el)=>{var ub=cr(),db=ub(Object,"create");el.exports=db});var sl=_((PT,rl)=>{var tl=Ts();function pb(){this.__data__=tl?tl(null):{},this.size=0}rl.exports=pb});var al=_((ST,nl)=>{function fb(s){var e=this.has(s)&&delete this.__data__[s];return this.size-=e?1:0,e}nl.exports=fb});var il=_((_T,ol)=>{var hb=Ts(),mb="__lodash_hash_undefined__",gb=Object.prototype,vb=gb.hasOwnProperty;function yb(s){var e=this.__data__;if(hb){var t=e[s];return t===mb?void 0:t}return vb.call(e,s)?e[s]:void 0}ol.exports=yb});var ll=_((ET,cl)=>{var bb=Ts(),xb=Object.prototype,wb=xb.hasOwnProperty;function Pb(s){var e=this.__data__;return bb?e[s]!==void 0:wb.call(e,s)}cl.exports=Pb});var dl=_((CT,ul)=>{var Sb=Ts(),_b="__lodash_hash_undefined__";function Eb(s,e){var t=this.__data__;return this.size+=this.has(s)?0:1,t[s]=Sb&&e===void 0?_b:e,this}ul.exports=Eb});var fl=_((RT,pl)=>{var Cb=sl(),Rb=al(),Tb=il(),Ab=ll(),Ib=dl();function Gr(s){var e=-1,t=s==null?0:s.length;for(this.clear();++e<t;){var n=s[e];this.set(n[0],n[1])}}Gr.prototype.clear=Cb;Gr.prototype.delete=Rb;Gr.prototype.get=Tb;Gr.prototype.has=Ab;Gr.prototype.set=Ib;pl.exports=Gr});var gl=_((TT,ml)=>{var hl=fl(),kb=Es(),Ob=pn();function Db(){this.size=0,this.__data__={hash:new hl,map:new(Ob||kb),string:new hl}}ml.exports=Db});var yl=_((AT,vl)=>{function $b(s){var e=typeof s;return e=="string"||e=="number"||e=="symbol"||e=="boolean"?s!=="__proto__":s===null}vl.exports=$b});var As=_((IT,bl)=>{var Mb=yl();function Lb(s,e){var t=s.__data__;return Mb(e)?t[typeof e=="string"?"string":"hash"]:t.map}bl.exports=Lb});var wl=_((kT,xl)=>{var Nb=As();function Fb(s){var e=Nb(this,s).delete(s);return this.size-=e?1:0,e}xl.exports=Fb});var Sl=_((OT,Pl)=>{var jb=As();function qb(s){return jb(this,s).get(s)}Pl.exports=qb});var El=_((DT,_l)=>{var Ub=As();function Wb(s){return Ub(this,s).has(s)}_l.exports=Wb});var Rl=_(($T,Cl)=>{var Vb=As();function Hb(s,e){var t=Vb(this,s),n=t.size;return t.set(s,e),this.size+=t.size==n?0:1,this}Cl.exports=Hb});var lo=_((MT,Tl)=>{var Bb=gl(),zb=wl(),Gb=Sl(),Kb=El(),Zb=Rl();function Kr(s){var e=-1,t=s==null?0:s.length;for(this.clear();++e<t;){var n=s[e];this.set(n[0],n[1])}}Kr.prototype.clear=Bb;Kr.prototype.delete=zb;Kr.prototype.get=Gb;Kr.prototype.has=Kb;Kr.prototype.set=Zb;Tl.exports=Kr});var Il=_((LT,Al)=>{var Jb=Es(),Qb=pn(),Xb=lo(),Yb=200;function ex(s,e){var t=this.__data__;if(t instanceof Jb){var n=t.__data__;if(!Qb||n.length<Yb-1)return n.push([s,e]),this.size=++t.size,this;t=this.__data__=new Xb(n)}return t.set(s,e),this.size=t.size,this}Al.exports=ex});var Ol=_((NT,kl)=>{var tx=Es(),rx=wc(),sx=Sc(),nx=Ec(),ax=Rc(),ox=Il();function Zr(s){var e=this.__data__=new tx(s);this.size=e.size}Zr.prototype.clear=rx;Zr.prototype.delete=sx;Zr.prototype.get=nx;Zr.prototype.has=ax;Zr.prototype.set=ox;kl.exports=Zr});var $l=_((FT,Dl)=>{var ix="__lodash_hash_undefined__";function cx(s){return this.__data__.set(s,ix),this}Dl.exports=cx});var Ll=_((jT,Ml)=>{function lx(s){return this.__data__.has(s)}Ml.exports=lx});var Fl=_((qT,Nl)=>{var ux=lo(),dx=$l(),px=Ll();function fn(s){var e=-1,t=s==null?0:s.length;for(this.__data__=new ux;++e<t;)this.add(s[e])}fn.prototype.add=fn.prototype.push=dx;fn.prototype.has=px;Nl.exports=fn});var ql=_((UT,jl)=>{function fx(s,e){for(var t=-1,n=s==null?0:s.length;++t<n;)if(e(s[t],t,s))return!0;return!1}jl.exports=fx});var Wl=_((WT,Ul)=>{function hx(s,e){return s.has(e)}Ul.exports=hx});var uo=_((VT,Vl)=>{var mx=Fl(),gx=ql(),vx=Wl(),yx=1,bx=2;function xx(s,e,t,n,r,a){var o=t&yx,i=s.length,c=e.length;if(i!=c&&!(o&&c>i))return!1;var u=a.get(s),d=a.get(e);if(u&&d)return u==e&&d==s;var f=-1,h=!0,p=t&bx?new mx:void 0;for(a.set(s,e),a.set(e,s);++f<i;){var g=s[f],y=e[f];if(n)var v=o?n(y,g,f,e,s,a):n(g,y,f,s,e,a);if(v!==void 0){if(v)continue;h=!1;break}if(p){if(!gx(e,function(w,C){if(!vx(p,C)&&(g===w||r(g,w,t,n,a)))return p.push(C)})){h=!1;break}}else if(!(g===y||r(g,y,t,n,a))){h=!1;break}}return a.delete(s),a.delete(e),h}Vl.exports=xx});var Bl=_((HT,Hl)=>{var wx=St(),Px=wx.Uint8Array;Hl.exports=Px});var Gl=_((BT,zl)=>{function Sx(s){var e=-1,t=Array(s.size);return s.forEach(function(n,r){t[++e]=[r,n]}),t}zl.exports=Sx});var Zl=_((zT,Kl)=>{function _x(s){var e=-1,t=Array(s.size);return s.forEach(function(n){t[++e]=n}),t}Kl.exports=_x});var eu=_((GT,Yl)=>{var Jl=dn(),Ql=Bl(),Ex=so(),Cx=uo(),Rx=Gl(),Tx=Zl(),Ax=1,Ix=2,kx="[object Boolean]",Ox="[object Date]",Dx="[object Error]",$x="[object Map]",Mx="[object Number]",Lx="[object RegExp]",Nx="[object Set]",Fx="[object String]",jx="[object Symbol]",qx="[object ArrayBuffer]",Ux="[object DataView]",Xl=Jl?Jl.prototype:void 0,po=Xl?Xl.valueOf:void 0;function Wx(s,e,t,n,r,a,o){switch(t){case Ux:if(s.byteLength!=e.byteLength||s.byteOffset!=e.byteOffset)return!1;s=s.buffer,e=e.buffer;case qx:return!(s.byteLength!=e.byteLength||!a(new Ql(s),new Ql(e)));case kx:case Ox:case Mx:return Ex(+s,+e);case Dx:return s.name==e.name&&s.message==e.message;case Lx:case Fx:return s==e+"";case $x:var i=Rx;case Nx:var c=n&Ax;if(i||(i=Tx),s.size!=e.size&&!c)return!1;var u=o.get(s);if(u)return u==e;n|=Ix,o.set(s,e);var d=Cx(i(s),i(e),n,r,a,o);return o.delete(s),d;case jx:if(po)return po.call(s)==po.call(e)}return!1}Yl.exports=Wx});var ru=_((KT,tu)=>{function Vx(s,e){for(var t=-1,n=e.length,r=s.length;++t<n;)s[r+t]=e[t];return s}tu.exports=Vx});var hn=_((ZT,su)=>{var Hx=Array.isArray;su.exports=Hx});var au=_((JT,nu)=>{var Bx=ru(),zx=hn();function Gx(s,e,t){var n=e(s);return zx(s)?n:Bx(n,t(s))}nu.exports=Gx});var iu=_((QT,ou)=>{function Kx(s,e){for(var t=-1,n=s==null?0:s.length,r=0,a=[];++t<n;){var o=s[t];e(o,t,s)&&(a[r++]=o)}return a}ou.exports=Kx});var lu=_((XT,cu)=>{function Zx(){return[]}cu.exports=Zx});var pu=_((YT,du)=>{var Jx=iu(),Qx=lu(),Xx=Object.prototype,Yx=Xx.propertyIsEnumerable,uu=Object.getOwnPropertySymbols,ew=uu?function(s){return s==null?[]:(s=Object(s),Jx(uu(s),function(e){return Yx.call(s,e)}))}:Qx;du.exports=ew});var hu=_((eA,fu)=>{function tw(s,e){for(var t=-1,n=Array(s);++t<s;)n[t]=e(t);return n}fu.exports=tw});var Is=_((tA,mu)=>{function rw(s){return s!=null&&typeof s=="object"}mu.exports=rw});var vu=_((rA,gu)=>{var sw=Rs(),nw=Is(),aw="[object Arguments]";function ow(s){return nw(s)&&sw(s)==aw}gu.exports=ow});var wu=_((sA,xu)=>{var yu=vu(),iw=Is(),bu=Object.prototype,cw=bu.hasOwnProperty,lw=bu.propertyIsEnumerable,uw=yu(function(){return arguments}())?yu:function(s){return iw(s)&&cw.call(s,"callee")&&!lw.call(s,"callee")};xu.exports=uw});var Su=_((nA,Pu)=>{function dw(){return!1}Pu.exports=dw});var fo=_((ks,Jr)=>{var pw=St(),fw=Su(),Cu=typeof ks=="object"&&ks&&!ks.nodeType&&ks,_u=Cu&&typeof Jr=="object"&&Jr&&!Jr.nodeType&&Jr,hw=_u&&_u.exports===Cu,Eu=hw?pw.Buffer:void 0,mw=Eu?Eu.isBuffer:void 0,gw=mw||fw;Jr.exports=gw});var Tu=_((aA,Ru)=>{var vw=9007199254740991,yw=/^(?:0|[1-9]\d*)$/;function bw(s,e){var t=typeof s;return e=e??vw,!!e&&(t=="number"||t!="symbol"&&yw.test(s))&&s>-1&&s%1==0&&s<e}Ru.exports=bw});var ho=_((oA,Au)=>{var xw=9007199254740991;function ww(s){return typeof s=="number"&&s>-1&&s%1==0&&s<=xw}Au.exports=ww});var ku=_((iA,Iu)=>{var Pw=Rs(),Sw=ho(),_w=Is(),Ew="[object Arguments]",Cw="[object Array]",Rw="[object Boolean]",Tw="[object Date]",Aw="[object Error]",Iw="[object Function]",kw="[object Map]",Ow="[object Number]",Dw="[object Object]",$w="[object RegExp]",Mw="[object Set]",Lw="[object String]",Nw="[object WeakMap]",Fw="[object ArrayBuffer]",jw="[object DataView]",qw="[object Float32Array]",Uw="[object Float64Array]",Ww="[object Int8Array]",Vw="[object Int16Array]",Hw="[object Int32Array]",Bw="[object Uint8Array]",zw="[object Uint8ClampedArray]",Gw="[object Uint16Array]",Kw="[object Uint32Array]",ve={};ve[qw]=ve[Uw]=ve[Ww]=ve[Vw]=ve[Hw]=ve[Bw]=ve[zw]=ve[Gw]=ve[Kw]=!0;ve[Ew]=ve[Cw]=ve[Fw]=ve[Rw]=ve[jw]=ve[Tw]=ve[Aw]=ve[Iw]=ve[kw]=ve[Ow]=ve[Dw]=ve[$w]=ve[Mw]=ve[Lw]=ve[Nw]=!1;function Zw(s){return _w(s)&&Sw(s.length)&&!!ve[Pw(s)]}Iu.exports=Zw});var Du=_((cA,Ou)=>{function Jw(s){return function(e){return s(e)}}Ou.exports=Jw});var Mu=_((Os,Qr)=>{var Qw=no(),$u=typeof Os=="object"&&Os&&!Os.nodeType&&Os,Ds=$u&&typeof Qr=="object"&&Qr&&!Qr.nodeType&&Qr,Xw=Ds&&Ds.exports===$u,mo=Xw&&Qw.process,Yw=function(){try{var s=Ds&&Ds.require&&Ds.require("util").types;return s||mo&&mo.binding&&mo.binding("util")}catch{}}();Qr.exports=Yw});var go=_((lA,Fu)=>{var eP=ku(),tP=Du(),Lu=Mu(),Nu=Lu&&Lu.isTypedArray,rP=Nu?tP(Nu):eP;Fu.exports=rP});var qu=_((uA,ju)=>{var sP=hu(),nP=wu(),aP=hn(),oP=fo(),iP=Tu(),cP=go(),lP=Object.prototype,uP=lP.hasOwnProperty;function dP(s,e){var t=aP(s),n=!t&&nP(s),r=!t&&!n&&oP(s),a=!t&&!n&&!r&&cP(s),o=t||n||r||a,i=o?sP(s.length,String):[],c=i.length;for(var u in s)(e||uP.call(s,u))&&!(o&&(u=="length"||r&&(u=="offset"||u=="parent")||a&&(u=="buffer"||u=="byteLength"||u=="byteOffset")||iP(u,c)))&&i.push(u);return i}ju.exports=dP});var Wu=_((dA,Uu)=>{var pP=Object.prototype;function fP(s){var e=s&&s.constructor,t=typeof e=="function"&&e.prototype||pP;return s===t}Uu.exports=fP});var Hu=_((pA,Vu)=>{function hP(s,e){return function(t){return s(e(t))}}Vu.exports=hP});var zu=_((fA,Bu)=>{var mP=Hu(),gP=mP(Object.keys,Object);Bu.exports=gP});var Ku=_((hA,Gu)=>{var vP=Wu(),yP=zu(),bP=Object.prototype,xP=bP.hasOwnProperty;function wP(s){if(!vP(s))return yP(s);var e=[];for(var t in Object(s))xP.call(s,t)&&t!="constructor"&&e.push(t);return e}Gu.exports=wP});var Ju=_((mA,Zu)=>{var PP=oo(),SP=ho();function _P(s){return s!=null&&SP(s.length)&&!PP(s)}Zu.exports=_P});var Xu=_((gA,Qu)=>{var EP=qu(),CP=Ku(),RP=Ju();function TP(s){return RP(s)?EP(s):CP(s)}Qu.exports=TP});var ed=_((vA,Yu)=>{var AP=au(),IP=pu(),kP=Xu();function OP(s){return AP(s,kP,IP)}Yu.exports=OP});var sd=_((yA,rd)=>{var td=ed(),DP=1,$P=Object.prototype,MP=$P.hasOwnProperty;function LP(s,e,t,n,r,a){var o=t&DP,i=td(s),c=i.length,u=td(e),d=u.length;if(c!=d&&!o)return!1;for(var f=c;f--;){var h=i[f];if(!(o?h in e:MP.call(e,h)))return!1}var p=a.get(s),g=a.get(e);if(p&&g)return p==e&&g==s;var y=!0;a.set(s,e),a.set(e,s);for(var v=o;++f<c;){h=i[f];var w=s[h],C=e[h];if(n)var E=o?n(C,w,h,e,s,a):n(w,C,h,s,e,a);if(!(E===void 0?w===C||r(w,C,t,n,a):E)){y=!1;break}v||(v=h=="constructor")}if(y&&!v){var R=s.constructor,A=e.constructor;R!=A&&"constructor"in s&&"constructor"in e&&!(typeof R=="function"&&R instanceof R&&typeof A=="function"&&A instanceof A)&&(y=!1)}return a.delete(s),a.delete(e),y}rd.exports=LP});var ad=_((bA,nd)=>{var NP=cr(),FP=St(),jP=NP(FP,"DataView");nd.exports=jP});var id=_((xA,od)=>{var qP=cr(),UP=St(),WP=qP(UP,"Promise");od.exports=WP});var ld=_((wA,cd)=>{var VP=cr(),HP=St(),BP=VP(HP,"Set");cd.exports=BP});var dd=_((PA,ud)=>{var zP=cr(),GP=St(),KP=zP(GP,"WeakMap");ud.exports=KP});var bd=_((SA,yd)=>{var vo=ad(),yo=pn(),bo=id(),xo=ld(),wo=dd(),vd=Rs(),Xr=co(),pd="[object Map]",ZP="[object Object]",fd="[object Promise]",hd="[object Set]",md="[object WeakMap]",gd="[object DataView]",JP=Xr(vo),QP=Xr(yo),XP=Xr(bo),YP=Xr(xo),eS=Xr(wo),lr=vd;(vo&&lr(new vo(new ArrayBuffer(1)))!=gd||yo&&lr(new yo)!=pd||bo&&lr(bo.resolve())!=fd||xo&&lr(new xo)!=hd||wo&&lr(new wo)!=md)&&(lr=function(s){var e=vd(s),t=e==ZP?s.constructor:void 0,n=t?Xr(t):"";if(n)switch(n){case JP:return gd;case QP:return pd;case XP:return fd;case YP:return hd;case eS:return md}return e});yd.exports=lr});var Rd=_((_A,Cd)=>{var Po=Ol(),tS=uo(),rS=eu(),sS=sd(),xd=bd(),wd=hn(),Pd=fo(),nS=go(),aS=1,Sd="[object Arguments]",_d="[object Array]",mn="[object Object]",oS=Object.prototype,Ed=oS.hasOwnProperty;function iS(s,e,t,n,r,a){var o=wd(s),i=wd(e),c=o?_d:xd(s),u=i?_d:xd(e);c=c==Sd?mn:c,u=u==Sd?mn:u;var d=c==mn,f=u==mn,h=c==u;if(h&&Pd(s)){if(!Pd(e))return!1;o=!0,d=!1}if(h&&!d)return a||(a=new Po),o||nS(s)?tS(s,e,t,n,r,a):rS(s,e,c,t,n,r,a);if(!(t&aS)){var p=d&&Ed.call(s,"__wrapped__"),g=f&&Ed.call(e,"__wrapped__");if(p||g){var y=p?s.value():s,v=g?e.value():e;return a||(a=new Po),r(y,v,t,n,a)}}return h?(a||(a=new Po),sS(s,e,t,n,r,a)):!1}Cd.exports=iS});var kd=_((EA,Id)=>{var cS=Rd(),Td=Is();function Ad(s,e,t,n,r){return s===e?!0:s==null||e==null||!Td(s)&&!Td(e)?s!==s&&e!==e:cS(s,e,t,n,Ad,r)}Id.exports=Ad});var Dd=_((CA,Od)=>{var lS=kd();function uS(s,e){return lS(s,e)}Od.exports=uS});var $d=ne(()=>{"use strict"});var De,Md=ne(()=>{"use strict";De={CLI_EXECUTABLE:"cliExecutable",COMMENT_CODELENS_ENABLED:"commentCodeLensEnabled",OPEN_ON_STARTUP:"openOnStartup",RUN_CODEX_IN_WSL:"runCodexInWindowsSubsystemForLinux",API_ENDPOINT:"apiEndpoint",LOG_LEVEL:"logLevel",USE_EXPERIMENTAL_MCP_LSP_SERVER:"useExperimentalMcpLspServer"}});function gn(){let s=()=>{},e=()=>{};return{promise:new Promise((n,r)=>{s=n,e=r}),resolve:s,reject:e}}var Ld=ne(()=>{"use strict"});var Nd=ne(()=>{"use strict"});var Fd=ne(()=>{"use strict"});var rt,jd=ne(()=>{"use strict";rt={HAS_PROBABLY_SEEN_2025_08_27_NUX:"hasProbablySeen2025-08-27-nux",NUX_2025_09_15:"viewed2025-09-15-nux",NUX_2025_09_15_FULL_CHATGPT_AUTH_VIEWED:"viewed2025-09-15-full-chatgpt-auth-nux",NUX_2025_09_15_APIKEY_AUTH_VIEWED:"viewed2025-09-15-apikey-auth-nux",WINDOWS_WSL_REMINDER_DISMISSED_AT:"windows-wsl-reminder-dismissed-date",WINDOWS_SANDBOX_ENABLED:"windows-sandbox-enabled",UPSELL_BANNER_CODEX_REMOTE_DISMISSED_AT:"upsell-banner-codex-remote-dismissed-at",SHOW_COPILOT_LOGIN_FIRST:"show-copilot-login-first",USE_COPILOT_AUTH_IF_AVAILABLE:"use-copilot-auth-if-available",COPILOT_DEFAULT_MODEL:"copilot-default-model",ACTIVE_WORKSPACE_ROOTS:"active-workspace-roots",WORKSPACE_ROOT_OPTIONS:"electron-saved-workspace-roots",OPEN_IN_TARGET_PREFERENCES:"open-in-target-preferences"}});var qd=ne(()=>{"use strict"});async function Ud(s,e,t,n,r){let a={},o=await e(),i;if(o!=null){i=ur;let{baseUrl:c,secret:u}=o;a.model_provider=ur,a[`model_providers.${ur}`]={name:dS,base_url:c,experimental_bearer_token:u,wire_api:"responses"}}else i=null;if(r){let c=await r();if(c)for(let[u,d]of Object.entries(c))a[u]=d}return{cwd:t[0],model:s,modelProvider:i,config:a,approvalPolicy:n.approvalPolicy,baseInstructions:null,developerInstructions:null,compactPrompt:null,sandbox:n.sandboxPolicy.type,profile:null,includeApplyPatchTool:null}}var ur,dS,Wd=ne(()=>{"use strict";ur="codex_vscode_copilot",dS="Copilot"});function Vd(s,e,t){return{sandboxPolicy:{writable_roots:[...s,...e?.writableRoots||[]],exclude_slash_tmp:e?.excludeSlashTmp||!1,exclude_tmpdir_env_var:e?.excludeTmpdirEnvVar||!1,network_access:e?.networkAccess||!1,type:"workspace-write"},approvalPolicy:t??"on-request"}}var Hd=ne(()=>{"use strict"});var Bd=ne(()=>{"use strict"});var zd=ne(()=>{"use strict"});var Gd=ne(()=>{"use strict"});var Ze=ne(()=>{"use strict";$d();Md();Ld();Nd();Fd();jd();qd();Wd();Hd();Bd();zd();Gd()});function ze(s,e){return Xd().get(s)??e}async function yn(s,e){let t=fS[s]??Yr.ConfigurationTarget.Global;await Xd().update(s,e,t)}function Xd(){return Yr.workspace.getConfiguration("chatgpt")}var Yr,fS,Ut=ne(()=>{"use strict";Ze();Yr=G(require("vscode")),fS={[De.COMMENT_CODELENS_ENABLED]:Yr.ConfigurationTarget.Workspace,[De.OPEN_ON_STARTUP]:Yr.ConfigurationTarget.Workspace}});var bn=ne(()=>{"use strict"});function Yd(s){if(xn)throw new Error("Logger already set");xn=s}function T(){if(!xn)throw new Error("Logger not set");return xn}var xn,pr=ne(()=>{});function Ro(){let s=T(),e=vS(s);if(!e)return;if(xS(e))return Co(e);if(bS(e))return Co(To(e));let t=yS(e,s);if(t)return t;s.warn(`[resolveCodexHomeFromWsl] Unable to translate Linux path "${e}" to a Windows path`)}function vS(s){return tp(["/usr/bin/env","bash","-lc",'printf %s "${CODEX_HOME:-$HOME/.codex}"'],"readCodexHomePathFromWslEnv",s)}function yS(s,e){let t=tp(["wslpath","-w",s],`resolveCodexHomeFromWsl:wslpath(${s})`,e);return t?Co(t):void 0}function tp(s,e,t){try{let n=(0,ep.spawnSync)("wsl.exe",s,{encoding:"utf8",windowsHide:!0});if(n.error){t.warn(`[${e}] command error: ${String(n.error)}`);return}if(n.status!==0){t.warn(`[${e}] non-zero exit (${n.status}): ${n.stderr?.toString()??""}`);return}let r=n.stdout?.toString().trim();if(!r){t.warn(`[${e}] command returned empty output`);return}return r}catch(n){t.warn(`[${e}] unexpected error: ${String(n)}`);return}}function Co(s){return s.replace(/\//g,"\\")}function bS(s){return/^\/mnt\/[a-zA-Z]\//.test(s)?!0:/^\\{1,2}mnt\\[a-zA-Z]\\/.test(s)}function xS(s){return!!(/^[a-zA-Z]:[\\/]/.test(s)||/^\\\\/.test(s))}function To(s){let e=s.match(/^\/mnt\/([a-zA-Z])\/(.*)$/);if(e){let r=e[1].toUpperCase(),a=e[2].replace(/\//g,"\\");return`${r}:\\${a}`}let t=s.match(/^\\{1,2}[Mm][Nn][Tt]\\([a-zA-Z])\\(.*)$/i);if(t){let r=t[1].toUpperCase(),a=t[2].replace(/[\\/]/g,"\\");return`${r}:\\${a}`}let n=s.match(/^C:\\mnt\\c(.*)$/i);return n?`C:\\${n[1].replace(/^([\\/])+/,"").replace(/[\\/]/g,"\\")}`:s.replace(/\//g,"\\")}var ep,Ao=ne(()=>{ep=require("child_process");pr()});function fr(s={}){let{preferWsl:e=!1}=s,t=T();if(e&&process.platform==="win32"){let n=Ro();if(n)return n;t.info("[resolveCodexHome] Falling back to host home directory because WSL CODEX_HOME could not be resolved")}return process.env.CODEX_HOME??sp.join(rp.homedir(),".codex")}var rp,sp,Io=ne(()=>{rp=G(require("node:os")),sp=G(require("node:path"));pr();Ao()});async function ap(s,e,t=10,n){let r=s.trim();if(r.length===0||e.length===0||t<=0)return[];let a=`**/*${PS(r)}*`,o=n?.rgPath??"rg",i=n?.runCommand??wS,c=[];for(let u of e){if(c.length>=t)break;try{let d=[o,"--files","--iglob",a],{stdout:f,code:h}=await i(d,u);if(h!==0)return[];let p=f.split(/\r?\n/).map(g=>g.trim()).filter(Boolean);for(let g of p){if(c.length>=t)break;let y=$s.default.isAbsolute(g)?g:$s.default.join(u,g),v=$s.default.basename(y).replace(/\\/g,"/"),w=$s.default.relative(u,y).replace(/\\/g,"/"),C=w&&!w.startsWith("..")?w:y;c.push({label:v,path:C,fsPath:y})}}catch(d){T().warn(`rg search failed in ${u}: ${String(d)}`)}}return c}function PS(s){let e=["*","?","[","]","{","}","!","\\"],t="";for(let n of s)t+=e.includes(n)?"\\"+n:n;return t}var np,$s,wS,op=ne(()=>{np=require("child_process"),$s=G(require("node:path"));pr();wS=(s,e)=>new Promise((t,n)=>{let r=(0,np.spawn)(s[0],s.slice(1),{cwd:e,env:{...process.env},stdio:["ignore","pipe","pipe"]});if(!r.pid){n(new Error(`failed to start process: \`${s.join(" ")}\``));return}let a=[];r.stdout?.on("data",o=>{a.push(o)}),r.once("error",o=>n(o)),r.once("exit",o=>t({stdout:Buffer.concat(a).toString("utf8"),code:o}))})});async function es(s,e,t={}){let{trim:n=!0,allowNonZeroExitCodes:r,env:a}=t;try{let{stdout:o,stderr:i}=await SS("git",e,{cwd:s,encoding:"utf8",env:a?{...process.env,...a}:process.env});return{success:!0,stdout:n?o.trim():o,stderr:n?i.trim():i}}catch(o){let i=o,c=i.code,u=typeof c=="number"?c:typeof c=="string"?Number.parseInt(c,10):void 0,d=u!=null&&Array.isArray(r)&&r.includes(u),f=(i.stdout??"").toString(),h=(i.stderr??"").toString();return{success:d,stdout:n?f.trim():f,stderr:n?h.trim():h}}}async function wn(s){let{success:e,stdout:t}=await es(s,["rev-parse","--show-toplevel"]);return e&&t?t:null}async function cp(s){let[e,t,n]=await Promise.all([es(s,["diff","--cached"],{allowNonZeroExitCodes:[0,1]}),es(s,["diff"],{allowNonZeroExitCodes:[0,1]}),es(s,["ls-files","--others","--exclude-standard","-z"],{trim:!1})]);if([e,t,n].find(i=>!i.success))return{uncommittedChanges:{type:"error"}};let a=[e.stdout,t.stdout].filter(i=>i.trim().length>0),o=n.stdout.split("\0").map(i=>i.trim()).filter(i=>i.length>0)??[];if(o.length>0)for(let i of o){let c=await es(s,["diff","--no-index","--","/dev/null",i],{trim:!1,allowNonZeroExitCodes:[0,1]});if(!c.success)return{uncommittedChanges:{type:"error"}};c.stdout.trim().length>0&&a.push(c.stdout.trimEnd())}return{uncommittedChanges:{type:"success",unifiedDiff:a.join(`
`)}}}async function lp(s,e){let t=await es(s,e);return t.success&&t.stdout?t.stdout:null}var ko,ip,SS,mI,Pn=ne(()=>{ko=require("node:child_process"),ip=require("node:util");Io();pr();SS=(0,ip.promisify)(ko.execFile),mI=200*1024*1024});async function up(s){return Promise.all(s.map(_S))}async function _S(s){let e=await wn(s)??s,t=await lp(e,["config","--get","remote.origin.url"]);return{dir:s,root:e,originUrl:t??null}}var dp=ne(()=>{Pn()});function ES(s,e){let t=new Set,n=new Set,r=new Set,a=null,o=[s,e].filter(Boolean).join(`
`),i=(N,K)=>{let L=(K??"").trim();if(!L)return;let J=L.charAt(0),re=L.charAt(L.length-1),Z=L;(J==="'"||J==='"')&&re===J&&L.length>=2&&(Z=L.slice(1,-1)),Z&&N.add(Z)},c=(N,K)=>{for(let L of K)if(N[L])return N[L]},u=/^(?:Applied patch(?: to)?\s+(?:(["'])(?<qpath>.+?)\1|(?<path>.+?))\s+cleanly\.?)$/i,d=/^(?:Applied patch(?: to)?\s+(?:(["'])(?<qpath>.+?)\1|(?<path>.+?))\s+with conflicts\.?)$/i,f=/^(?:Applying patch\s+(?:(["'])(?<qpath>.+?)\1|(?<path>.+?))\s+with\s+\d+\s+rejects?\.{0,3})$/i,h=/^(?:Checking patch\s+(?:(["'])(?<qpath>.+?)\1|(?<path>.+?))\.\.\.)$/i,p=/^(?:Performing three-way merge|Falling back to three-way merge)\.\.\.$/i,g=/^Failed to perform three-way merge\.\.\.$/i,y=/^Falling back to direct application\.\.\.$/i,v=/^U\s+(?<path>.+)$/,w=/^error:\s+patch failed:\s+(?<path>.+?)(?::\d+)?(?:\s|$)/i,C=/^error:\s+(?<path>.+?):\s+patch does not apply$/i,E=/^(?:error: )?repository lacks the necessary blob to (?:perform|fall back on) 3-?way merge\.?$/i,R=/^error:\s+(?<path>.+?):\s+does not match index\b/i,A=/^error:\s+(?<path>.+?):\s+does not exist in index\b/i,D=/^error:\s+(?<path>.+?)\s+already exists in (?:the )?working directory\b/i,j=/^error:\s+patch failed:\s+(?<path>.+?)\s+File exists/i,V=/^error:\s+path\s+(?<path>.+?)\s+has been renamed\/deleted/i,$=/^error:\s+cannot apply binary patch to\s+['"]?(?<path>.+?)['"]?\s+without full index line$/i,B=/^error:\s+binary patch does not apply to\s+['"]?(?<path>.+?)['"]?$/i,H=/^error:\s+binary patch to\s+['"]?(?<path>.+?)['"]?\s+creates incorrect result\b/i,W=/^error:\s+cannot read the current contents of\s+['"]?(?<path>.+?)['"]?$/i,k=/^Skipped patch\s+['"]?(?<path>.+?)['"]\.$/i,M=/^warning:\s*Cannot merge binary files:\s+(?<path>.+?)\s+\(ours\s+vs\.\s+theirs\)/i;for(let N of o.split(/\r?\n/)){let K=N.trim();if(!K)continue;let L;if(L=K.match(u)){let J=c(L.groups??{},["qpath","path"]);i(t,J),a=J??a,r.delete(J??""),n.delete(J??"");continue}if(L=K.match(d)){let J=c(L.groups??{},["qpath","path"]);i(r,J),a=J??a,t.delete(J??""),n.delete(J??"");continue}if(L=K.match(f)){let J=c(L.groups??{},["qpath","path"]);i(r,J),a=J??a,t.delete(J??""),n.delete(J??"");continue}if(L=K.match(v)){i(r,L.groups?.path),a=L.groups?.path??a,t.delete(L.groups?.path??""),n.delete(L.groups?.path??"");continue}if(L=K.match(h)){a=c(L.groups??{},["qpath","path"])??a;continue}if((L=K.match(w))||(L=K.match(C))){i(n,L.groups?.path),a=L.groups?.path??a;continue}if(!(p.test(K)||y.test(K))){if(g.test(K)){a&&(i(n,a),t.delete(a),r.delete(a));continue}if(E.test(K)){a&&(i(n,a),t.delete(a),r.delete(a));continue}if((L=K.match(R))||(L=K.match(A))||(L=K.match(D))||(L=K.match(j))||(L=K.match(V))||(L=K.match($))||(L=K.match(B))||(L=K.match(H))||(L=K.match(W))||(L=K.match(k))){i(n,L.groups?.path),a=L.groups?.path??a,t.delete(L.groups?.path??""),r.delete(L.groups?.path??"");continue}if(L=K.match(M)){i(r,L.groups?.path),a=L.groups?.path??a,t.delete(L.groups?.path??""),n.delete(L.groups?.path??"");continue}}}for(let N of r)t.delete(N),n.delete(N);for(let N of t)n.delete(N);return{appliedPaths:Array.from(t).sort(),skippedPaths:Array.from(n).sort(),conflictedPaths:Array.from(r).sort()}}function CS(s){let e=new Set,t=/^diff --git a\/(.*?) b\/(.*)$/gm,n;for(;(n=t.exec(s))!=null;){let[r,a,o]=n;a&&a!=="/dev/null"&&e.add(a),o&&o!=="/dev/null"&&e.add(o)}return Array.from(e)}async function hp({cwd:s,diff:e,revert:t},{resolveRoot:n=wn,runProcess:r=TS,preferWslPaths:a=!1,convertWindowsPathToWslPath:o,convertWslPathToWindowsPath:i}={}){let c=T(),u=await n(s);if(!u)throw new Error(`${s} is not a git repository`);let d=await Ms.promises.mkdtemp(Sn.join((0,fp.tmpdir)(),"codex-apply-")),f=Sn.join(d,"patch.diff");await Ms.promises.writeFile(f,e,"utf8"),a&&o&&(f=o(f));try{t&&await RS(u,e,{runProcess:r,preferWslPaths:a,convertWslPathToWindowsPath:i});let h=["git","apply",t?"-R":null,"--3way",f].filter(Boolean).map(E=>E),{code:p,stdout:g,stderr:y}=await r(h,u);c.info(`applyPatch revert:${t} code:${p} stdout:${g} stderr:${y}`);let{appliedPaths:v,skippedPaths:w,conflictedPaths:C}=ES(g,y);return{status:p===0?"success":p===1?"partial-success":"error",appliedPaths:v,skippedPaths:w,conflictedPaths:C}}finally{await Ms.promises.rm(d,{recursive:!0,force:!0})}}async function RS(s,e,{runProcess:t,preferWslPaths:n,convertWslPathToWindowsPath:r}){let a=CS(e);if(a.length===0)return;let o=[];await Promise.all(a.map(async i=>{let c=Sn.join(s,i);n&&r&&(c=r(c));try{await Ms.promises.access(c),o.push(i)}catch{}})),o.length!==0&&await t(["git","add","--",...o],s)}var pp,Ms,fp,Sn,TS,mp=ne(()=>{pp=require("node:child_process"),Ms=require("node:fs"),fp=require("node:os"),Sn=G(require("node:path"));pr();Pn();TS=(s,e)=>new Promise((t,n)=>{let[r,...a]=s,o=(0,pp.spawn)(r,a,{cwd:e,env:{...process.env},stdio:["ignore","pipe","pipe"]}),i=[],c=[];o.stdout?.on("data",u=>{i.push(u)}),o.stderr?.on("data",u=>{c.push(u)}),o.on("error",u=>{n(u)}),o.on("close",u=>{t({code:u??1,stdout:Buffer.concat(i).toString("utf8"),stderr:Buffer.concat(c).toString("utf8")})})})});var gp=ne(()=>{});var _n,vp=ne(()=>{_n=class{store={};subscribers=new Set;get(e){if(e in this.store)return this.store[e]}set(e,t){t===void 0?delete this.store[e]:this.store[e]=t,this.notifySubscribers(e,t)}addSubscriber(e){return this.subscribers.add(e),()=>this.subscribers.delete(e)}notifySubscribers(e,t){this.subscribers.forEach(n=>n(e,t))}}});var Re=ne(()=>{Io();op();dp();Pn();mp();pr();gp();vp();Ao()});function En(s){return yp[s]<=yp[IS]}function kS(){let s=bp.window.createOutputChannel("Codex",{log:!0}),e={trace:(t,...n)=>{En("trace")&&s.trace(t,...n)},debug:(t,...n)=>{En("debug")&&s.debug(t,...n)},info:(t,...n)=>{En("info")&&s.info(t,...n)},error:(t,...n)=>{s.error(t,...n)},warn:(t,...n)=>{En("warning")&&s.warn(t,...n)},dispose:()=>s.dispose()};return Yd(e),e}var bp,AS,IS,yp,Ue,Pe=ne(()=>{"use strict";Ut();bn();Ze();Re();bp=G(require("vscode")),AS="warning",IS=ze(De.LOG_LEVEL,AS),yp={error:0,warning:1,info:2,debug:3,trace:4};Ue=kS()});var Vf=_((pa,Wf)=>{(function(s,e){typeof pa=="object"&&typeof Wf<"u"?e(pa):typeof define=="function"&&define.amd?define(["exports"],e):e(s.URI=s.URI||{})})(pa,function(s){"use strict";function e(){for(var b=arguments.length,m=Array(b),x=0;x<b;x++)m[x]=arguments[x];if(m.length>1){m[0]=m[0].slice(0,-1);for(var P=m.length-1,S=1;S<P;++S)m[S]=m[S].slice(1,-1);return m[P]=m[P].slice(1),m.join("")}else return m[0]}function t(b){return"(?:"+b+")"}function n(b){return b===void 0?"undefined":b===null?"null":Object.prototype.toString.call(b).split(" ").pop().split("]").shift().toLowerCase()}function r(b){return b.toUpperCase()}function a(b){return b!=null?b instanceof Array?b:typeof b.length!="number"||b.split||b.setInterval||b.call?[b]:Array.prototype.slice.call(b):[]}function o(b,m){var x=b;if(m)for(var P in m)x[P]=m[P];return x}function i(b){var m="[A-Za-z]",x="[\\x0D]",P="[0-9]",S="[\\x22]",U=e(P,"[A-Fa-f]"),se="[\\x0A]",ce="[\\x20]",pe=t(t("%[EFef]"+U+"%"+U+U+"%"+U+U)+"|"+t("%[89A-Fa-f]"+U+"%"+U+U)+"|"+t("%"+U+U)),ke="[\\:\\/\\?\\#\\[\\]\\@]",ie="[\\!\\$\\&\\'\\(\\)\\*\\+\\,\\;\\=]",xe=e(ke,ie),Oe=b?"[\\xA0-\\u200D\\u2010-\\u2029\\u202F-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF]":"[]",ye=b?"[\\uE000-\\uF8FF]":"[]",ue=e(m,P,"[\\-\\.\\_\\~]",Oe),we=t(m+e(m,P,"[\\+\\-\\.]")+"*"),fe=t(t(pe+"|"+e(ue,ie,"[\\:]"))+"*"),ar=t(t("25[0-5]")+"|"+t("2[0-4]"+P)+"|"+t("1"+P+P)+"|"+t("[1-9]"+P)+"|"+P),et=t(t("25[0-5]")+"|"+t("2[0-4]"+P)+"|"+t("1"+P+P)+"|"+t("0?[1-9]"+P)+"|0?0?"+P),it=t(et+"\\."+et+"\\."+et+"\\."+et),he=t(U+"{1,4}"),tt=t(t(he+"\\:"+he)+"|"+it),ct=t(t(he+"\\:")+"{6}"+tt),Pt=t("\\:\\:"+t(he+"\\:")+"{5}"+tt),or=t(t(he)+"?\\:\\:"+t(he+"\\:")+"{4}"+tt),kt=t(t(t(he+"\\:")+"{0,1}"+he)+"?\\:\\:"+t(he+"\\:")+"{3}"+tt),bs=t(t(t(he+"\\:")+"{0,2}"+he)+"?\\:\\:"+t(he+"\\:")+"{2}"+tt),sn=t(t(t(he+"\\:")+"{0,3}"+he)+"?\\:\\:"+he+"\\:"+tt),nn=t(t(t(he+"\\:")+"{0,4}"+he)+"?\\:\\:"+tt),jr=t(t(t(he+"\\:")+"{0,5}"+he)+"?\\:\\:"+he),qr=t(t(t(he+"\\:")+"{0,6}"+he)+"?\\:\\:"),Ot=t([ct,Pt,or,kt,bs,sn,nn,jr,qr].join("|")),Ur=t(t(ue+"|"+pe)+"+"),Xa=t(Ot+"\\%25"+Ur),ir=t(Ot+t("\\%25|\\%(?!"+U+"{2})")+Ur),kv=t("[vV]"+U+"+\\."+e(ue,ie,"[\\:]")+"+"),Ov=t("\\["+t(ir+"|"+Ot+"|"+kv)+"\\]"),Ji=t(t(pe+"|"+e(ue,ie))+"*"),xs=t(Ov+"|"+it+"(?!"+Ji+")|"+Ji),ws=t(P+"*"),Qi=t(t(fe+"@")+"?"+xs+t("\\:"+ws)+"?"),Ps=t(pe+"|"+e(ue,ie,"[\\:\\@]")),Dv=t(Ps+"*"),Xi=t(Ps+"+"),$v=t(t(pe+"|"+e(ue,ie,"[\\@]"))+"+"),Dt=t(t("\\/"+Dv)+"*"),Wr=t("\\/"+t(Xi+Dt)+"?"),Ya=t($v+Dt),an=t(Xi+Dt),Vr="(?!"+Ps+")",LR=t(Dt+"|"+Wr+"|"+Ya+"|"+an+"|"+Vr),Hr=t(t(Ps+"|"+e("[\\/\\?]",ye))+"*"),Ss=t(t(Ps+"|[\\/\\?]")+"*"),Yi=t(t("\\/\\/"+Qi+Dt)+"|"+Wr+"|"+an+"|"+Vr),Mv=t(we+"\\:"+Yi+t("\\?"+Hr)+"?"+t("\\#"+Ss)+"?"),Lv=t(t("\\/\\/"+Qi+Dt)+"|"+Wr+"|"+Ya+"|"+Vr),Nv=t(Lv+t("\\?"+Hr)+"?"+t("\\#"+Ss)+"?"),NR=t(Mv+"|"+Nv),FR=t(we+"\\:"+Yi+t("\\?"+Hr)+"?"),jR="^("+we+")\\:"+t(t("\\/\\/("+t("("+fe+")@")+"?("+xs+")"+t("\\:("+ws+")")+"?)")+"?("+Dt+"|"+Wr+"|"+an+"|"+Vr+")")+t("\\?("+Hr+")")+"?"+t("\\#("+Ss+")")+"?$",qR="^(){0}"+t(t("\\/\\/("+t("("+fe+")@")+"?("+xs+")"+t("\\:("+ws+")")+"?)")+"?("+Dt+"|"+Wr+"|"+Ya+"|"+Vr+")")+t("\\?("+Hr+")")+"?"+t("\\#("+Ss+")")+"?$",UR="^("+we+")\\:"+t(t("\\/\\/("+t("("+fe+")@")+"?("+xs+")"+t("\\:("+ws+")")+"?)")+"?("+Dt+"|"+Wr+"|"+an+"|"+Vr+")")+t("\\?("+Hr+")")+"?$",WR="^"+t("\\#("+Ss+")")+"?$",VR="^"+t("("+fe+")@")+"?("+xs+")"+t("\\:("+ws+")")+"?$";return{NOT_SCHEME:new RegExp(e("[^]",m,P,"[\\+\\-\\.]"),"g"),NOT_USERINFO:new RegExp(e("[^\\%\\:]",ue,ie),"g"),NOT_HOST:new RegExp(e("[^\\%\\[\\]\\:]",ue,ie),"g"),NOT_PATH:new RegExp(e("[^\\%\\/\\:\\@]",ue,ie),"g"),NOT_PATH_NOSCHEME:new RegExp(e("[^\\%\\/\\@]",ue,ie),"g"),NOT_QUERY:new RegExp(e("[^\\%]",ue,ie,"[\\:\\@\\/\\?]",ye),"g"),NOT_FRAGMENT:new RegExp(e("[^\\%]",ue,ie,"[\\:\\@\\/\\?]"),"g"),ESCAPE:new RegExp(e("[^]",ue,ie),"g"),UNRESERVED:new RegExp(ue,"g"),OTHER_CHARS:new RegExp(e("[^\\%]",ue,xe),"g"),PCT_ENCODED:new RegExp(pe,"g"),IPV4ADDRESS:new RegExp("^("+it+")$"),IPV6ADDRESS:new RegExp("^\\[?("+Ot+")"+t(t("\\%25|\\%(?!"+U+"{2})")+"("+Ur+")")+"?\\]?$")}}var c=i(!1),u=i(!0),d=function(){function b(m,x){var P=[],S=!0,U=!1,se=void 0;try{for(var ce=m[Symbol.iterator](),pe;!(S=(pe=ce.next()).done)&&(P.push(pe.value),!(x&&P.length===x));S=!0);}catch(ke){U=!0,se=ke}finally{try{!S&&ce.return&&ce.return()}finally{if(U)throw se}}return P}return function(m,x){if(Array.isArray(m))return m;if(Symbol.iterator in Object(m))return b(m,x);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),f=function(b){if(Array.isArray(b)){for(var m=0,x=Array(b.length);m<b.length;m++)x[m]=b[m];return x}else return Array.from(b)},h=2147483647,p=36,g=1,y=26,v=38,w=700,C=72,E=128,R="-",A=/^xn--/,D=/[^\0-\x7E]/,j=/[\x2E\u3002\uFF0E\uFF61]/g,V={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},$=p-g,B=Math.floor,H=String.fromCharCode;function W(b){throw new RangeError(V[b])}function k(b,m){for(var x=[],P=b.length;P--;)x[P]=m(b[P]);return x}function M(b,m){var x=b.split("@"),P="";x.length>1&&(P=x[0]+"@",b=x[1]),b=b.replace(j,".");var S=b.split("."),U=k(S,m).join(".");return P+U}function N(b){for(var m=[],x=0,P=b.length;x<P;){var S=b.charCodeAt(x++);if(S>=55296&&S<=56319&&x<P){var U=b.charCodeAt(x++);(U&64512)==56320?m.push(((S&1023)<<10)+(U&1023)+65536):(m.push(S),x--)}else m.push(S)}return m}var K=function(m){return String.fromCodePoint.apply(String,f(m))},L=function(m){return m-48<10?m-22:m-65<26?m-65:m-97<26?m-97:p},J=function(m,x){return m+22+75*(m<26)-((x!=0)<<5)},re=function(m,x,P){var S=0;for(m=P?B(m/w):m>>1,m+=B(m/x);m>$*y>>1;S+=p)m=B(m/$);return B(S+($+1)*m/(m+v))},Z=function(m){var x=[],P=m.length,S=0,U=E,se=C,ce=m.lastIndexOf(R);ce<0&&(ce=0);for(var pe=0;pe<ce;++pe)m.charCodeAt(pe)>=128&&W("not-basic"),x.push(m.charCodeAt(pe));for(var ke=ce>0?ce+1:0;ke<P;){for(var ie=S,xe=1,Oe=p;;Oe+=p){ke>=P&&W("invalid-input");var ye=L(m.charCodeAt(ke++));(ye>=p||ye>B((h-S)/xe))&&W("overflow"),S+=ye*xe;var ue=Oe<=se?g:Oe>=se+y?y:Oe-se;if(ye<ue)break;var we=p-ue;xe>B(h/we)&&W("overflow"),xe*=we}var fe=x.length+1;se=re(S-ie,fe,ie==0),B(S/fe)>h-U&&W("overflow"),U+=B(S/fe),S%=fe,x.splice(S++,0,U)}return String.fromCodePoint.apply(String,x)},_e=function(m){var x=[];m=N(m);var P=m.length,S=E,U=0,se=C,ce=!0,pe=!1,ke=void 0;try{for(var ie=m[Symbol.iterator](),xe;!(ce=(xe=ie.next()).done);ce=!0){var Oe=xe.value;Oe<128&&x.push(H(Oe))}}catch(ir){pe=!0,ke=ir}finally{try{!ce&&ie.return&&ie.return()}finally{if(pe)throw ke}}var ye=x.length,ue=ye;for(ye&&x.push(R);ue<P;){var we=h,fe=!0,ar=!1,et=void 0;try{for(var it=m[Symbol.iterator](),he;!(fe=(he=it.next()).done);fe=!0){var tt=he.value;tt>=S&&tt<we&&(we=tt)}}catch(ir){ar=!0,et=ir}finally{try{!fe&&it.return&&it.return()}finally{if(ar)throw et}}var ct=ue+1;we-S>B((h-U)/ct)&&W("overflow"),U+=(we-S)*ct,S=we;var Pt=!0,or=!1,kt=void 0;try{for(var bs=m[Symbol.iterator](),sn;!(Pt=(sn=bs.next()).done);Pt=!0){var nn=sn.value;if(nn<S&&++U>h&&W("overflow"),nn==S){for(var jr=U,qr=p;;qr+=p){var Ot=qr<=se?g:qr>=se+y?y:qr-se;if(jr<Ot)break;var Ur=jr-Ot,Xa=p-Ot;x.push(H(J(Ot+Ur%Xa,0))),jr=B(Ur/Xa)}x.push(H(J(jr,0))),se=re(U,ct,ue==ye),U=0,++ue}}}catch(ir){or=!0,kt=ir}finally{try{!Pt&&bs.return&&bs.return()}finally{if(or)throw kt}}++U,++S}return x.join("")},je=function(m){return M(m,function(x){return A.test(x)?Z(x.slice(4).toLowerCase()):x})},Ve=function(m){return M(m,function(x){return D.test(x)?"xn--"+_e(x):x})},le={version:"2.1.0",ucs2:{decode:N,encode:K},decode:Z,encode:_e,toASCII:Ve,toUnicode:je},Ae={};function Me(b){var m=b.charCodeAt(0),x=void 0;return m<16?x="%0"+m.toString(16).toUpperCase():m<128?x="%"+m.toString(16).toUpperCase():m<2048?x="%"+(m>>6|192).toString(16).toUpperCase()+"%"+(m&63|128).toString(16).toUpperCase():x="%"+(m>>12|224).toString(16).toUpperCase()+"%"+(m>>6&63|128).toString(16).toUpperCase()+"%"+(m&63|128).toString(16).toUpperCase(),x}function He(b){for(var m="",x=0,P=b.length;x<P;){var S=parseInt(b.substr(x+1,2),16);if(S<128)m+=String.fromCharCode(S),x+=3;else if(S>=194&&S<224){if(P-x>=6){var U=parseInt(b.substr(x+4,2),16);m+=String.fromCharCode((S&31)<<6|U&63)}else m+=b.substr(x,6);x+=6}else if(S>=224){if(P-x>=9){var se=parseInt(b.substr(x+4,2),16),ce=parseInt(b.substr(x+7,2),16);m+=String.fromCharCode((S&15)<<12|(se&63)<<6|ce&63)}else m+=b.substr(x,9);x+=9}else m+=b.substr(x,3),x+=3}return m}function jt(b,m){function x(P){var S=He(P);return S.match(m.UNRESERVED)?S:P}return b.scheme&&(b.scheme=String(b.scheme).replace(m.PCT_ENCODED,x).toLowerCase().replace(m.NOT_SCHEME,"")),b.userinfo!==void 0&&(b.userinfo=String(b.userinfo).replace(m.PCT_ENCODED,x).replace(m.NOT_USERINFO,Me).replace(m.PCT_ENCODED,r)),b.host!==void 0&&(b.host=String(b.host).replace(m.PCT_ENCODED,x).toLowerCase().replace(m.NOT_HOST,Me).replace(m.PCT_ENCODED,r)),b.path!==void 0&&(b.path=String(b.path).replace(m.PCT_ENCODED,x).replace(b.scheme?m.NOT_PATH:m.NOT_PATH_NOSCHEME,Me).replace(m.PCT_ENCODED,r)),b.query!==void 0&&(b.query=String(b.query).replace(m.PCT_ENCODED,x).replace(m.NOT_QUERY,Me).replace(m.PCT_ENCODED,r)),b.fragment!==void 0&&(b.fragment=String(b.fragment).replace(m.PCT_ENCODED,x).replace(m.NOT_FRAGMENT,Me).replace(m.PCT_ENCODED,r)),b}function At(b){return b.replace(/^0*(.*)/,"$1")||"0"}function Ie(b,m){var x=b.match(m.IPV4ADDRESS)||[],P=d(x,2),S=P[1];return S?S.split(".").map(At).join("."):b}function Ee(b,m){var x=b.match(m.IPV6ADDRESS)||[],P=d(x,3),S=P[1],U=P[2];if(S){for(var se=S.toLowerCase().split("::").reverse(),ce=d(se,2),pe=ce[0],ke=ce[1],ie=ke?ke.split(":").map(At):[],xe=pe.split(":").map(At),Oe=m.IPV4ADDRESS.test(xe[xe.length-1]),ye=Oe?7:8,ue=xe.length-ye,we=Array(ye),fe=0;fe<ye;++fe)we[fe]=ie[fe]||xe[ue+fe]||"";Oe&&(we[ye-1]=Ie(we[ye-1],m));var ar=we.reduce(function(ct,Pt,or){if(!Pt||Pt==="0"){var kt=ct[ct.length-1];kt&&kt.index+kt.length===or?kt.length++:ct.push({index:or,length:1})}return ct},[]),et=ar.sort(function(ct,Pt){return Pt.length-ct.length})[0],it=void 0;if(et&&et.length>1){var he=we.slice(0,et.index),tt=we.slice(et.index+et.length);it=he.join(":")+"::"+tt.join(":")}else it=we.join(":");return U&&(it+="%"+U),it}else return b}var rr=/^(?:([^:\/?#]+):)?(?:\/\/((?:([^\/?#@]*)@)?(\[[^\/?#\]]+\]|[^\/?#:]*)(?:\:(\d*))?))?([^?#]*)(?:\?([^#]*))?(?:#((?:.|\n|\r)*))?/i,qe="".match(/(){0}/)[1]===void 0;function de(b){var m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},x={},P=m.iri!==!1?u:c;m.reference==="suffix"&&(b=(m.scheme?m.scheme+":":"")+"//"+b);var S=b.match(rr);if(S){qe?(x.scheme=S[1],x.userinfo=S[3],x.host=S[4],x.port=parseInt(S[5],10),x.path=S[6]||"",x.query=S[7],x.fragment=S[8],isNaN(x.port)&&(x.port=S[5])):(x.scheme=S[1]||void 0,x.userinfo=b.indexOf("@")!==-1?S[3]:void 0,x.host=b.indexOf("//")!==-1?S[4]:void 0,x.port=parseInt(S[5],10),x.path=S[6]||"",x.query=b.indexOf("?")!==-1?S[7]:void 0,x.fragment=b.indexOf("#")!==-1?S[8]:void 0,isNaN(x.port)&&(x.port=b.match(/\/\/(?:.|\n)*\:(?:\/|\?|\#|$)/)?S[4]:void 0)),x.host&&(x.host=Ee(Ie(x.host,P),P)),x.scheme===void 0&&x.userinfo===void 0&&x.host===void 0&&x.port===void 0&&!x.path&&x.query===void 0?x.reference="same-document":x.scheme===void 0?x.reference="relative":x.fragment===void 0?x.reference="absolute":x.reference="uri",m.reference&&m.reference!=="suffix"&&m.reference!==x.reference&&(x.error=x.error||"URI is not a "+m.reference+" reference.");var U=Ae[(m.scheme||x.scheme||"").toLowerCase()];if(!m.unicodeSupport&&(!U||!U.unicodeSupport)){if(x.host&&(m.domainHost||U&&U.domainHost))try{x.host=le.toASCII(x.host.replace(P.PCT_ENCODED,He).toLowerCase())}catch(se){x.error=x.error||"Host's domain name can not be converted to ASCII via punycode: "+se}jt(x,c)}else jt(x,P);U&&U.parse&&U.parse(x,m)}else x.error=x.error||"URI can not be parsed.";return x}function qt(b,m){var x=m.iri!==!1?u:c,P=[];return b.userinfo!==void 0&&(P.push(b.userinfo),P.push("@")),b.host!==void 0&&P.push(Ee(Ie(String(b.host),x),x).replace(x.IPV6ADDRESS,function(S,U,se){return"["+U+(se?"%25"+se:"")+"]"})),(typeof b.port=="number"||typeof b.port=="string")&&(P.push(":"),P.push(String(b.port))),P.length?P.join(""):void 0}var It=/^\.\.?\//,sr=/^\/\.(\/|$)/,nr=/^\/\.\.(\/|$)/,Ne=/^\/?(?:.|\n)*?(?=\/|$)/;function ot(b){for(var m=[];b.length;)if(b.match(It))b=b.replace(It,"");else if(b.match(sr))b=b.replace(sr,"/");else if(b.match(nr))b=b.replace(nr,"/"),m.pop();else if(b==="."||b==="..")b="";else{var x=b.match(Ne);if(x){var P=x[0];b=b.slice(P.length),m.push(P)}else throw new Error("Unexpected dot segment condition")}return m.join("")}function Ke(b){var m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},x=m.iri?u:c,P=[],S=Ae[(m.scheme||b.scheme||"").toLowerCase()];if(S&&S.serialize&&S.serialize(b,m),b.host&&!x.IPV6ADDRESS.test(b.host)){if(m.domainHost||S&&S.domainHost)try{b.host=m.iri?le.toUnicode(b.host):le.toASCII(b.host.replace(x.PCT_ENCODED,He).toLowerCase())}catch(ce){b.error=b.error||"Host's domain name can not be converted to "+(m.iri?"Unicode":"ASCII")+" via punycode: "+ce}}jt(b,x),m.reference!=="suffix"&&b.scheme&&(P.push(b.scheme),P.push(":"));var U=qt(b,m);if(U!==void 0&&(m.reference!=="suffix"&&P.push("//"),P.push(U),b.path&&b.path.charAt(0)!=="/"&&P.push("/")),b.path!==void 0){var se=b.path;!m.absolutePath&&(!S||!S.absolutePath)&&(se=ot(se)),U===void 0&&(se=se.replace(/^\/\//,"/%2F")),P.push(se)}return b.query!==void 0&&(P.push("?"),P.push(b.query)),b.fragment!==void 0&&(P.push("#"),P.push(b.fragment)),P.join("")}function Be(b,m){var x=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},P=arguments[3],S={};return P||(b=de(Ke(b,x),x),m=de(Ke(m,x),x)),x=x||{},!x.tolerant&&m.scheme?(S.scheme=m.scheme,S.userinfo=m.userinfo,S.host=m.host,S.port=m.port,S.path=ot(m.path||""),S.query=m.query):(m.userinfo!==void 0||m.host!==void 0||m.port!==void 0?(S.userinfo=m.userinfo,S.host=m.host,S.port=m.port,S.path=ot(m.path||""),S.query=m.query):(m.path?(m.path.charAt(0)==="/"?S.path=ot(m.path):((b.userinfo!==void 0||b.host!==void 0||b.port!==void 0)&&!b.path?S.path="/"+m.path:b.path?S.path=b.path.slice(0,b.path.lastIndexOf("/")+1)+m.path:S.path=m.path,S.path=ot(S.path)),S.query=m.query):(S.path=b.path,m.query!==void 0?S.query=m.query:S.query=b.query),S.userinfo=b.userinfo,S.host=b.host,S.port=b.port),S.scheme=b.scheme),S.fragment=m.fragment,S}function xt(b,m,x){var P=o({scheme:"null"},x);return Ke(Be(de(b,P),de(m,P),P,!0),P)}function Ye(b,m){return typeof b=="string"?b=Ke(de(b,m),m):n(b)==="object"&&(b=de(Ke(b,m),m)),b}function rn(b,m,x){return typeof b=="string"?b=Ke(de(b,x),x):n(b)==="object"&&(b=Ke(b,x)),typeof m=="string"?m=Ke(de(m,x),x):n(m)==="object"&&(m=Ke(m,x)),b===m}function Ja(b,m){return b&&b.toString().replace(!m||!m.iri?c.ESCAPE:u.ESCAPE,Me)}function ht(b,m){return b&&b.toString().replace(!m||!m.iri?c.PCT_ENCODED:u.PCT_ENCODED,He)}var vs={scheme:"http",domainHost:!0,parse:function(m,x){return m.host||(m.error=m.error||"HTTP URIs must have a host."),m},serialize:function(m,x){var P=String(m.scheme).toLowerCase()==="https";return(m.port===(P?443:80)||m.port==="")&&(m.port=void 0),m.path||(m.path="/"),m}},Wi={scheme:"https",domainHost:vs.domainHost,parse:vs.parse,serialize:vs.serialize};function Vi(b){return typeof b.secure=="boolean"?b.secure:String(b.scheme).toLowerCase()==="wss"}var ys={scheme:"ws",domainHost:!0,parse:function(m,x){var P=m;return P.secure=Vi(P),P.resourceName=(P.path||"/")+(P.query?"?"+P.query:""),P.path=void 0,P.query=void 0,P},serialize:function(m,x){if((m.port===(Vi(m)?443:80)||m.port==="")&&(m.port=void 0),typeof m.secure=="boolean"&&(m.scheme=m.secure?"wss":"ws",m.secure=void 0),m.resourceName){var P=m.resourceName.split("?"),S=d(P,2),U=S[0],se=S[1];m.path=U&&U!=="/"?U:void 0,m.query=se,m.resourceName=void 0}return m.fragment=void 0,m}},Hi={scheme:"wss",domainHost:ys.domainHost,parse:ys.parse,serialize:ys.serialize},bv={},xv=!0,Bi="[A-Za-z0-9\\-\\.\\_\\~"+(xv?"\\xA0-\\u200D\\u2010-\\u2029\\u202F-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF":"")+"]",wt="[0-9A-Fa-f]",wv=t(t("%[EFef]"+wt+"%"+wt+wt+"%"+wt+wt)+"|"+t("%[89A-Fa-f]"+wt+"%"+wt+wt)+"|"+t("%"+wt+wt)),Pv="[A-Za-z0-9\\!\\$\\%\\'\\*\\+\\-\\^\\_\\`\\{\\|\\}\\~]",Sv="[\\!\\$\\%\\'\\(\\)\\*\\+\\,\\-\\.0-9\\<\\>A-Z\\x5E-\\x7E]",_v=e(Sv,'[\\"\\\\]'),Ev="[\\!\\$\\'\\(\\)\\*\\+\\,\\;\\:\\@]",Cv=new RegExp(Bi,"g"),Fr=new RegExp(wv,"g"),Rv=new RegExp(e("[^]",Pv,"[\\.]",'[\\"]',_v),"g"),zi=new RegExp(e("[^]",Bi,Ev),"g"),Tv=zi;function Qa(b){var m=He(b);return m.match(Cv)?m:b}var Gi={scheme:"mailto",parse:function(m,x){var P=m,S=P.to=P.path?P.path.split(","):[];if(P.path=void 0,P.query){for(var U=!1,se={},ce=P.query.split("&"),pe=0,ke=ce.length;pe<ke;++pe){var ie=ce[pe].split("=");switch(ie[0]){case"to":for(var xe=ie[1].split(","),Oe=0,ye=xe.length;Oe<ye;++Oe)S.push(xe[Oe]);break;case"subject":P.subject=ht(ie[1],x);break;case"body":P.body=ht(ie[1],x);break;default:U=!0,se[ht(ie[0],x)]=ht(ie[1],x);break}}U&&(P.headers=se)}P.query=void 0;for(var ue=0,we=S.length;ue<we;++ue){var fe=S[ue].split("@");if(fe[0]=ht(fe[0]),x.unicodeSupport)fe[1]=ht(fe[1],x).toLowerCase();else try{fe[1]=le.toASCII(ht(fe[1],x).toLowerCase())}catch(ar){P.error=P.error||"Email address's domain name can not be converted to ASCII via punycode: "+ar}S[ue]=fe.join("@")}return P},serialize:function(m,x){var P=m,S=a(m.to);if(S){for(var U=0,se=S.length;U<se;++U){var ce=String(S[U]),pe=ce.lastIndexOf("@"),ke=ce.slice(0,pe).replace(Fr,Qa).replace(Fr,r).replace(Rv,Me),ie=ce.slice(pe+1);try{ie=x.iri?le.toUnicode(ie):le.toASCII(ht(ie,x).toLowerCase())}catch(ue){P.error=P.error||"Email address's domain name can not be converted to "+(x.iri?"Unicode":"ASCII")+" via punycode: "+ue}S[U]=ke+"@"+ie}P.path=S.join(",")}var xe=m.headers=m.headers||{};m.subject&&(xe.subject=m.subject),m.body&&(xe.body=m.body);var Oe=[];for(var ye in xe)xe[ye]!==bv[ye]&&Oe.push(ye.replace(Fr,Qa).replace(Fr,r).replace(zi,Me)+"="+xe[ye].replace(Fr,Qa).replace(Fr,r).replace(Tv,Me));return Oe.length&&(P.query=Oe.join("&")),P}},Av=/^([^\:]+)\:(.*)/,Ki={scheme:"urn",parse:function(m,x){var P=m.path&&m.path.match(Av),S=m;if(P){var U=x.scheme||S.scheme||"urn",se=P[1].toLowerCase(),ce=P[2],pe=U+":"+(x.nid||se),ke=Ae[pe];S.nid=se,S.nss=ce,S.path=void 0,ke&&(S=ke.parse(S,x))}else S.error=S.error||"URN can not be parsed.";return S},serialize:function(m,x){var P=x.scheme||m.scheme||"urn",S=m.nid,U=P+":"+(x.nid||S),se=Ae[U];se&&(m=se.serialize(m,x));var ce=m,pe=m.nss;return ce.path=(S||x.nid)+":"+pe,ce}},Iv=/^[0-9A-Fa-f]{8}(?:\-[0-9A-Fa-f]{4}){3}\-[0-9A-Fa-f]{12}$/,Zi={scheme:"urn:uuid",parse:function(m,x){var P=m;return P.uuid=P.nss,P.nss=void 0,!x.tolerant&&(!P.uuid||!P.uuid.match(Iv))&&(P.error=P.error||"UUID is not valid."),P},serialize:function(m,x){var P=m;return P.nss=(m.uuid||"").toLowerCase(),P}};Ae[vs.scheme]=vs,Ae[Wi.scheme]=Wi,Ae[ys.scheme]=ys,Ae[Hi.scheme]=Hi,Ae[Gi.scheme]=Gi,Ae[Ki.scheme]=Ki,Ae[Zi.scheme]=Zi,s.SCHEMES=Ae,s.pctEncChar=Me,s.pctDecChars=He,s.parse=de,s.removeDotSegments=ot,s.serialize=Ke,s.resolveComponents=Be,s.resolve=xt,s.normalize=Ye,s.equal=rn,s.escapeComponent=Ja,s.unescapeComponent=ht,Object.defineProperty(s,"__esModule",{value:!0})})});var fa=_((SD,Hf)=>{"use strict";Hf.exports=function s(e,t){if(e===t)return!0;if(e&&t&&typeof e=="object"&&typeof t=="object"){if(e.constructor!==t.constructor)return!1;var n,r,a;if(Array.isArray(e)){if(n=e.length,n!=t.length)return!1;for(r=n;r--!==0;)if(!s(e[r],t[r]))return!1;return!0}if(e.constructor===RegExp)return e.source===t.source&&e.flags===t.flags;if(e.valueOf!==Object.prototype.valueOf)return e.valueOf()===t.valueOf();if(e.toString!==Object.prototype.toString)return e.toString()===t.toString();if(a=Object.keys(e),n=a.length,n!==Object.keys(t).length)return!1;for(r=n;r--!==0;)if(!Object.prototype.hasOwnProperty.call(t,a[r]))return!1;for(r=n;r--!==0;){var o=a[r];if(!s(e[o],t[o]))return!1}return!0}return e!==e&&t!==t}});var zf=_((_D,Bf)=>{"use strict";Bf.exports=function(e){for(var t=0,n=e.length,r=0,a;r<n;)t++,a=e.charCodeAt(r++),a>=55296&&a<=56319&&r<n&&(a=e.charCodeAt(r),(a&64512)==56320&&r++);return t}});var Dr=_((ED,Zf)=>{"use strict";Zf.exports={copy:R0,checkDataType:ni,checkDataTypes:T0,coerceToTypes:A0,toHash:oi,getProperty:ii,escapeQuotes:ci,equal:fa(),ucs2length:zf(),varOccurences:O0,varReplace:D0,schemaHasRules:$0,schemaHasRulesExcept:M0,schemaUnknownRules:L0,toQuotedString:ai,getPathExpr:N0,getPath:F0,getData:U0,unescapeFragment:W0,unescapeJsonPointer:ui,escapeFragment:V0,escapeJsonPointer:li};function R0(s,e){e=e||{};for(var t in s)e[t]=s[t];return e}function ni(s,e,t,n){var r=n?" !== ":" === ",a=n?" || ":" && ",o=n?"!":"",i=n?"":"!";switch(s){case"null":return e+r+"null";case"array":return o+"Array.isArray("+e+")";case"object":return"("+o+e+a+"typeof "+e+r+'"object"'+a+i+"Array.isArray("+e+"))";case"integer":return"(typeof "+e+r+'"number"'+a+i+"("+e+" % 1)"+a+e+r+e+(t?a+o+"isFinite("+e+")":"")+")";case"number":return"(typeof "+e+r+'"'+s+'"'+(t?a+o+"isFinite("+e+")":"")+")";default:return"typeof "+e+r+'"'+s+'"'}}function T0(s,e,t){switch(s.length){case 1:return ni(s[0],e,t,!0);default:var n="",r=oi(s);r.array&&r.object&&(n=r.null?"(":"(!"+e+" || ",n+="typeof "+e+' !== "object")',delete r.null,delete r.array,delete r.object),r.number&&delete r.integer;for(var a in r)n+=(n?" && ":"")+ni(a,e,t,!0);return n}}var Gf=oi(["string","number","integer","boolean","null"]);function A0(s,e){if(Array.isArray(e)){for(var t=[],n=0;n<e.length;n++){var r=e[n];(Gf[r]||s==="array"&&r==="array")&&(t[t.length]=r)}if(t.length)return t}else{if(Gf[e])return[e];if(s==="array"&&e==="array")return["array"]}}function oi(s){for(var e={},t=0;t<s.length;t++)e[s[t]]=!0;return e}var I0=/^[a-z$_][a-z$_0-9]*$/i,k0=/'|\\/g;function ii(s){return typeof s=="number"?"["+s+"]":I0.test(s)?"."+s:"['"+ci(s)+"']"}function ci(s){return s.replace(k0,"\\$&").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/\f/g,"\\f").replace(/\t/g,"\\t")}function O0(s,e){e+="[^0-9]";var t=s.match(new RegExp(e,"g"));return t?t.length:0}function D0(s,e,t){return e+="([^0-9])",t=t.replace(/\$/g,"$$$$"),s.replace(new RegExp(e,"g"),t+"$1")}function $0(s,e){if(typeof s=="boolean")return!s;for(var t in s)if(e[t])return!0}function M0(s,e,t){if(typeof s=="boolean")return!s&&t!="not";for(var n in s)if(n!=t&&e[n])return!0}function L0(s,e){if(typeof s!="boolean"){for(var t in s)if(!e[t])return t}}function ai(s){return"'"+ci(s)+"'"}function N0(s,e,t,n){var r=t?"'/' + "+e+(n?"":".replace(/~/g, '~0').replace(/\\//g, '~1')"):n?"'[' + "+e+" + ']'":"'[\\'' + "+e+" + '\\']'";return Kf(s,r)}function F0(s,e,t){var n=ai(t?"/"+li(e):ii(e));return Kf(s,n)}var j0=/^\/(?:[^~]|~0|~1)*$/,q0=/^([0-9]+)(#|\/(?:[^~]|~0|~1)*)?$/;function U0(s,e,t){var n,r,a,o;if(s==="")return"rootData";if(s[0]=="/"){if(!j0.test(s))throw new Error("Invalid JSON-pointer: "+s);r=s,a="rootData"}else{if(o=s.match(q0),!o)throw new Error("Invalid JSON-pointer: "+s);if(n=+o[1],r=o[2],r=="#"){if(n>=e)throw new Error("Cannot access property/index "+n+" levels up, current level is "+e);return t[e-n]}if(n>e)throw new Error("Cannot access data "+n+" levels up, current level is "+e);if(a="data"+(e-n||""),!r)return a}for(var i=a,c=r.split("/"),u=0;u<c.length;u++){var d=c[u];d&&(a+=ii(ui(d)),i+=" && "+a)}return i}function Kf(s,e){return s=='""'?e:(s+" + "+e).replace(/([^\\])' \+ '/g,"$1")}function W0(s){return ui(decodeURIComponent(s))}function V0(s){return encodeURIComponent(li(s))}function li(s){return s.replace(/~/g,"~0").replace(/\//g,"~1")}function ui(s){return s.replace(/~1/g,"/").replace(/~0/g,"~")}});var di=_((CD,Jf)=>{"use strict";var H0=Dr();Jf.exports=B0;function B0(s){H0.copy(s,this)}});var Xf=_((RD,Qf)=>{"use strict";var Jt=Qf.exports=function(s,e,t){typeof e=="function"&&(t=e,e={}),t=e.cb||t;var n=typeof t=="function"?t:t.pre||function(){},r=t.post||function(){};ha(e,n,r,s,"",s)};Jt.keywords={additionalItems:!0,items:!0,contains:!0,additionalProperties:!0,propertyNames:!0,not:!0};Jt.arrayKeywords={items:!0,allOf:!0,anyOf:!0,oneOf:!0};Jt.propsKeywords={definitions:!0,properties:!0,patternProperties:!0,dependencies:!0};Jt.skipKeywords={default:!0,enum:!0,const:!0,required:!0,maximum:!0,minimum:!0,exclusiveMaximum:!0,exclusiveMinimum:!0,multipleOf:!0,maxLength:!0,minLength:!0,pattern:!0,format:!0,maxItems:!0,minItems:!0,uniqueItems:!0,maxProperties:!0,minProperties:!0};function ha(s,e,t,n,r,a,o,i,c,u){if(n&&typeof n=="object"&&!Array.isArray(n)){e(n,r,a,o,i,c,u);for(var d in n){var f=n[d];if(Array.isArray(f)){if(d in Jt.arrayKeywords)for(var h=0;h<f.length;h++)ha(s,e,t,f[h],r+"/"+d+"/"+h,a,r,d,n,h)}else if(d in Jt.propsKeywords){if(f&&typeof f=="object")for(var p in f)ha(s,e,t,f[p],r+"/"+d+"/"+z0(p),a,r,d,n,p)}else(d in Jt.keywords||s.allKeys&&!(d in Jt.skipKeywords))&&ha(s,e,t,f,r+"/"+d,a,r,d,n)}t(n,r,a,o,i,c,u)}}function z0(s){return s.replace(/~/g,"~0").replace(/\//g,"~1")}});var xa=_((TD,rh)=>{"use strict";var Zs=Vf(),Yf=fa(),ya=Dr(),ma=di(),G0=Xf();rh.exports=Xt;Xt.normalizeId=Qt;Xt.fullPath=ga;Xt.url=va;Xt.ids=X0;Xt.inlineRef=pi;Xt.schema=ba;function Xt(s,e,t){var n=this._refs[t];if(typeof n=="string")if(this._refs[n])n=this._refs[n];else return Xt.call(this,s,e,n);if(n=n||this._schemas[t],n instanceof ma)return pi(n.schema,this._opts.inlineRefs)?n.schema:n.validate||this._compile(n);var r=ba.call(this,e,t),a,o,i;return r&&(a=r.schema,e=r.root,i=r.baseId),a instanceof ma?o=a.validate||s.call(this,a.schema,e,void 0,i):a!==void 0&&(o=pi(a,this._opts.inlineRefs)?a:s.call(this,a,e,void 0,i)),o}function ba(s,e){var t=Zs.parse(e),n=th(t),r=ga(this._getId(s.schema));if(Object.keys(s.schema).length===0||n!==r){var a=Qt(n),o=this._refs[a];if(typeof o=="string")return K0.call(this,s,o,t);if(o instanceof ma)o.validate||this._compile(o),s=o;else if(o=this._schemas[a],o instanceof ma){if(o.validate||this._compile(o),a==Qt(e))return{schema:o,root:s,baseId:r};s=o}else return;if(!s.schema)return;r=ga(this._getId(s.schema))}return eh.call(this,t,r,s.schema,s)}function K0(s,e,t){var n=ba.call(this,s,e);if(n){var r=n.schema,a=n.baseId;s=n.root;var o=this._getId(r);return o&&(a=va(a,o)),eh.call(this,t,a,r,s)}}var Z0=ya.toHash(["properties","patternProperties","enum","dependencies","definitions"]);function eh(s,e,t,n){if(s.fragment=s.fragment||"",s.fragment.slice(0,1)=="/"){for(var r=s.fragment.split("/"),a=1;a<r.length;a++){var o=r[a];if(o){if(o=ya.unescapeFragment(o),t=t[o],t===void 0)break;var i;if(!Z0[o]&&(i=this._getId(t),i&&(e=va(e,i)),t.$ref)){var c=va(e,t.$ref),u=ba.call(this,n,c);u&&(t=u.schema,n=u.root,e=u.baseId)}}}if(t!==void 0&&t!==n.schema)return{schema:t,root:n,baseId:e}}}var J0=ya.toHash(["type","format","pattern","maxLength","minLength","maxProperties","minProperties","maxItems","minItems","maximum","minimum","uniqueItems","multipleOf","required","enum"]);function pi(s,e){if(e===!1)return!1;if(e===void 0||e===!0)return fi(s);if(e)return hi(s)<=e}function fi(s){var e;if(Array.isArray(s)){for(var t=0;t<s.length;t++)if(e=s[t],typeof e=="object"&&!fi(e))return!1}else for(var n in s)if(n=="$ref"||(e=s[n],typeof e=="object"&&!fi(e)))return!1;return!0}function hi(s){var e=0,t;if(Array.isArray(s)){for(var n=0;n<s.length;n++)if(t=s[n],typeof t=="object"&&(e+=hi(t)),e==1/0)return 1/0}else for(var r in s){if(r=="$ref")return 1/0;if(J0[r])e++;else if(t=s[r],typeof t=="object"&&(e+=hi(t)+1),e==1/0)return 1/0}return e}function ga(s,e){e!==!1&&(s=Qt(s));var t=Zs.parse(s);return th(t)}function th(s){return Zs.serialize(s).split("#")[0]+"#"}var Q0=/#\/?$/;function Qt(s){return s?s.replace(Q0,""):""}function va(s,e){return e=Qt(e),Zs.resolve(s,e)}function X0(s){var e=Qt(this._getId(s)),t={"":e},n={"":ga(e,!1)},r={},a=this;return G0(s,{allKeys:!0},function(o,i,c,u,d,f,h){if(i!==""){var p=a._getId(o),g=t[u],y=n[u]+"/"+d;if(h!==void 0&&(y+="/"+(typeof h=="number"?h:ya.escapeFragment(h))),typeof p=="string"){p=g=Qt(g?Zs.resolve(g,p):p);var v=a._refs[p];if(typeof v=="string"&&(v=a._refs[v]),v&&v.schema){if(!Yf(o,v.schema))throw new Error('id "'+p+'" resolves to more than one schema')}else if(p!=Qt(y))if(p[0]=="#"){if(r[p]&&!Yf(o,r[p]))throw new Error('id "'+p+'" resolves to more than one schema');r[p]=o}else a._refs[p]=y}t[i]=g,n[i]=y}}),r}});var wa=_((AD,nh)=>{"use strict";var mi=xa();nh.exports={Validation:sh(Y0),MissingRef:sh(gi)};function Y0(s){this.message="validation failed",this.errors=s,this.ajv=this.validation=!0}gi.message=function(s,e){return"can't resolve reference "+e+" from id "+s};function gi(s,e,t){this.message=t||gi.message(s,e),this.missingRef=mi.url(s,e),this.missingSchema=mi.normalizeId(mi.fullPath(this.missingRef))}function sh(s){return s.prototype=Object.create(Error.prototype),s.prototype.constructor=s,s}});var vi=_((ID,ah)=>{"use strict";ah.exports=function(s,e){e||(e={}),typeof e=="function"&&(e={cmp:e});var t=typeof e.cycles=="boolean"?e.cycles:!1,n=e.cmp&&function(a){return function(o){return function(i,c){var u={key:i,value:o[i]},d={key:c,value:o[c]};return a(u,d)}}}(e.cmp),r=[];return function a(o){if(o&&o.toJSON&&typeof o.toJSON=="function"&&(o=o.toJSON()),o!==void 0){if(typeof o=="number")return isFinite(o)?""+o:"null";if(typeof o!="object")return JSON.stringify(o);var i,c;if(Array.isArray(o)){for(c="[",i=0;i<o.length;i++)i&&(c+=","),c+=a(o[i])||"null";return c+"]"}if(o===null)return"null";if(r.indexOf(o)!==-1){if(t)return JSON.stringify("__cycle__");throw new TypeError("Converting circular structure to JSON")}var u=r.push(o)-1,d=Object.keys(o).sort(n&&n(o));for(c="",i=0;i<d.length;i++){var f=d[i],h=a(o[f]);h&&(c&&(c+=","),c+=JSON.stringify(f)+":"+h)}return r.splice(u,1),"{"+c+"}"}}(s)}});var yi=_((kD,oh)=>{"use strict";oh.exports=function(e,t,n){var r="",a=e.schema.$async===!0,o=e.util.schemaHasRulesExcept(e.schema,e.RULES.all,"$ref"),i=e.self._getId(e.schema);if(e.opts.strictKeywords){var c=e.util.schemaUnknownRules(e.schema,e.RULES.keywords);if(c){var u="unknown keyword: "+c;if(e.opts.strictKeywords==="log")e.logger.warn(u);else throw new Error(u)}}if(e.isTop&&(r+=" var validate = ",a&&(e.async=!0,r+="async "),r+="function(data, dataPath, parentData, parentDataProperty, rootData) { 'use strict'; ",i&&(e.opts.sourceCode||e.opts.processCode)&&(r+=" "+("/*# sourceURL="+i+" */")+" ")),typeof e.schema=="boolean"||!(o||e.schema.$ref)){var t="false schema",d=e.level,f=e.dataLevel,h=e.schema[t],p=e.schemaPath+e.util.getProperty(t),g=e.errSchemaPath+"/"+t,A=!e.opts.allErrors,V,y="data"+(f||""),R="valid"+d;if(e.schema===!1){e.isTop?A=!0:r+=" var "+R+" = false; ";var v=v||[];v.push(r),r="",e.createErrors!==!1?(r+=" { keyword: '"+(V||"false schema")+"' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(g)+" , params: {} ",e.opts.messages!==!1&&(r+=" , message: 'boolean schema is false' "),e.opts.verbose&&(r+=" , schema: false , parentSchema: validate.schema"+e.schemaPath+" , data: "+y+" "),r+=" } "):r+=" {} ";var w=r;r=v.pop(),!e.compositeRule&&A?e.async?r+=" throw new ValidationError(["+w+"]); ":r+=" validate.errors = ["+w+"]; return false; ":r+=" var err = "+w+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; "}else e.isTop?a?r+=" return data; ":r+=" validate.errors = null; return true; ":r+=" var "+R+" = true; ";return e.isTop&&(r+=" }; return validate; "),r}if(e.isTop){var C=e.isTop,d=e.level=0,f=e.dataLevel=0,y="data";if(e.rootId=e.resolve.fullPath(e.self._getId(e.root.schema)),e.baseId=e.baseId||e.rootId,delete e.isTop,e.dataPathArr=[""],e.schema.default!==void 0&&e.opts.useDefaults&&e.opts.strictDefaults){var E="default is ignored in the schema root";if(e.opts.strictDefaults==="log")e.logger.warn(E);else throw new Error(E)}r+=" var vErrors = null; ",r+=" var errors = 0;     ",r+=" if (rootData === undefined) rootData = data; "}else{var d=e.level,f=e.dataLevel,y="data"+(f||"");if(i&&(e.baseId=e.resolve.url(e.baseId,i)),a&&!e.async)throw new Error("async schema in sync schema");r+=" var errs_"+d+" = errors;"}var R="valid"+d,A=!e.opts.allErrors,D="",j="",V,$=e.schema.type,B=Array.isArray($);if($&&e.opts.nullable&&e.schema.nullable===!0&&(B?$.indexOf("null")==-1&&($=$.concat("null")):$!="null"&&($=[$,"null"],B=!0)),B&&$.length==1&&($=$[0],B=!1),e.schema.$ref&&o){if(e.opts.extendRefs=="fail")throw new Error('$ref: validation keywords used in schema at path "'+e.errSchemaPath+'" (see option extendRefs)');e.opts.extendRefs!==!0&&(o=!1,e.logger.warn('$ref: keywords ignored in schema at path "'+e.errSchemaPath+'"'))}if(e.schema.$comment&&e.opts.$comment&&(r+=" "+e.RULES.all.$comment.code(e,"$comment")),$){if(e.opts.coerceTypes)var H=e.util.coerceToTypes(e.opts.coerceTypes,$);var W=e.RULES.types[$];if(H||B||W===!0||W&&!Ne(W)){var p=e.schemaPath+".type",g=e.errSchemaPath+"/type",p=e.schemaPath+".type",g=e.errSchemaPath+"/type",k=B?"checkDataTypes":"checkDataType";if(r+=" if ("+e.util[k]($,y,e.opts.strictNumbers,!0)+") { ",H){var M="dataType"+d,N="coerced"+d;r+=" var "+M+" = typeof "+y+"; var "+N+" = undefined; ",e.opts.coerceTypes=="array"&&(r+=" if ("+M+" == 'object' && Array.isArray("+y+") && "+y+".length == 1) { "+y+" = "+y+"[0]; "+M+" = typeof "+y+"; if ("+e.util.checkDataType(e.schema.type,y,e.opts.strictNumbers)+") "+N+" = "+y+"; } "),r+=" if ("+N+" !== undefined) ; ";var K=H;if(K)for(var L,J=-1,re=K.length-1;J<re;)L=K[J+=1],L=="string"?r+=" else if ("+M+" == 'number' || "+M+" == 'boolean') "+N+" = '' + "+y+"; else if ("+y+" === null) "+N+" = ''; ":L=="number"||L=="integer"?(r+=" else if ("+M+" == 'boolean' || "+y+" === null || ("+M+" == 'string' && "+y+" && "+y+" == +"+y+" ",L=="integer"&&(r+=" && !("+y+" % 1)"),r+=")) "+N+" = +"+y+"; "):L=="boolean"?r+=" else if ("+y+" === 'false' || "+y+" === 0 || "+y+" === null) "+N+" = false; else if ("+y+" === 'true' || "+y+" === 1) "+N+" = true; ":L=="null"?r+=" else if ("+y+" === '' || "+y+" === 0 || "+y+" === false) "+N+" = null; ":e.opts.coerceTypes=="array"&&L=="array"&&(r+=" else if ("+M+" == 'string' || "+M+" == 'number' || "+M+" == 'boolean' || "+y+" == null) "+N+" = ["+y+"]; ");r+=" else {   ";var v=v||[];v.push(r),r="",e.createErrors!==!1?(r+=" { keyword: '"+(V||"type")+"' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(g)+" , params: { type: '",B?r+=""+$.join(","):r+=""+$,r+="' } ",e.opts.messages!==!1&&(r+=" , message: 'should be ",B?r+=""+$.join(","):r+=""+$,r+="' "),e.opts.verbose&&(r+=" , schema: validate.schema"+p+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+y+" "),r+=" } "):r+=" {} ";var w=r;r=v.pop(),!e.compositeRule&&A?e.async?r+=" throw new ValidationError(["+w+"]); ":r+=" validate.errors = ["+w+"]; return false; ":r+=" var err = "+w+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",r+=" } if ("+N+" !== undefined) {  ";var Z=f?"data"+(f-1||""):"parentData",_e=f?e.dataPathArr[f]:"parentDataProperty";r+=" "+y+" = "+N+"; ",f||(r+="if ("+Z+" !== undefined)"),r+=" "+Z+"["+_e+"] = "+N+"; } "}else{var v=v||[];v.push(r),r="",e.createErrors!==!1?(r+=" { keyword: '"+(V||"type")+"' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(g)+" , params: { type: '",B?r+=""+$.join(","):r+=""+$,r+="' } ",e.opts.messages!==!1&&(r+=" , message: 'should be ",B?r+=""+$.join(","):r+=""+$,r+="' "),e.opts.verbose&&(r+=" , schema: validate.schema"+p+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+y+" "),r+=" } "):r+=" {} ";var w=r;r=v.pop(),!e.compositeRule&&A?e.async?r+=" throw new ValidationError(["+w+"]); ":r+=" validate.errors = ["+w+"]; return false; ":r+=" var err = "+w+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; "}r+=" } "}}if(e.schema.$ref&&!o)r+=" "+e.RULES.all.$ref.code(e,"$ref")+" ",A&&(r+=" } if (errors === ",C?r+="0":r+="errs_"+d,r+=") { ",j+="}");else{var je=e.RULES;if(je){for(var W,Ve=-1,le=je.length-1;Ve<le;)if(W=je[Ve+=1],Ne(W)){if(W.type&&(r+=" if ("+e.util.checkDataType(W.type,y,e.opts.strictNumbers)+") { "),e.opts.useDefaults){if(W.type=="object"&&e.schema.properties){var h=e.schema.properties,Ae=Object.keys(h),Me=Ae;if(Me)for(var He,jt=-1,At=Me.length-1;jt<At;){He=Me[jt+=1];var Ie=h[He];if(Ie.default!==void 0){var Ee=y+e.util.getProperty(He);if(e.compositeRule){if(e.opts.strictDefaults){var E="default is ignored for: "+Ee;if(e.opts.strictDefaults==="log")e.logger.warn(E);else throw new Error(E)}}else r+=" if ("+Ee+" === undefined ",e.opts.useDefaults=="empty"&&(r+=" || "+Ee+" === null || "+Ee+" === '' "),r+=" ) "+Ee+" = ",e.opts.useDefaults=="shared"?r+=" "+e.useDefault(Ie.default)+" ":r+=" "+JSON.stringify(Ie.default)+" ",r+="; "}}}else if(W.type=="array"&&Array.isArray(e.schema.items)){var rr=e.schema.items;if(rr){for(var Ie,J=-1,qe=rr.length-1;J<qe;)if(Ie=rr[J+=1],Ie.default!==void 0){var Ee=y+"["+J+"]";if(e.compositeRule){if(e.opts.strictDefaults){var E="default is ignored for: "+Ee;if(e.opts.strictDefaults==="log")e.logger.warn(E);else throw new Error(E)}}else r+=" if ("+Ee+" === undefined ",e.opts.useDefaults=="empty"&&(r+=" || "+Ee+" === null || "+Ee+" === '' "),r+=" ) "+Ee+" = ",e.opts.useDefaults=="shared"?r+=" "+e.useDefault(Ie.default)+" ":r+=" "+JSON.stringify(Ie.default)+" ",r+="; "}}}}var de=W.rules;if(de){for(var qt,It=-1,sr=de.length-1;It<sr;)if(qt=de[It+=1],ot(qt)){var nr=qt.code(e,qt.keyword,W.type);nr&&(r+=" "+nr+" ",A&&(D+="}"))}}if(A&&(r+=" "+D+" ",D=""),W.type&&(r+=" } ",$&&$===W.type&&!H)){r+=" else { ";var p=e.schemaPath+".type",g=e.errSchemaPath+"/type",v=v||[];v.push(r),r="",e.createErrors!==!1?(r+=" { keyword: '"+(V||"type")+"' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(g)+" , params: { type: '",B?r+=""+$.join(","):r+=""+$,r+="' } ",e.opts.messages!==!1&&(r+=" , message: 'should be ",B?r+=""+$.join(","):r+=""+$,r+="' "),e.opts.verbose&&(r+=" , schema: validate.schema"+p+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+y+" "),r+=" } "):r+=" {} ";var w=r;r=v.pop(),!e.compositeRule&&A?e.async?r+=" throw new ValidationError(["+w+"]); ":r+=" validate.errors = ["+w+"]; return false; ":r+=" var err = "+w+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",r+=" } "}A&&(r+=" if (errors === ",C?r+="0":r+="errs_"+d,r+=") { ",j+="}")}}}A&&(r+=" "+j+" "),C?(a?(r+=" if (errors === 0) return data;           ",r+=" else throw new ValidationError(vErrors); "):(r+=" validate.errors = vErrors; ",r+=" return errors === 0;       "),r+=" }; return validate;"):r+=" var "+R+" = errors === errs_"+d+";";function Ne(Be){for(var xt=Be.rules,Ye=0;Ye<xt.length;Ye++)if(ot(xt[Ye]))return!0}function ot(Be){return e.schema[Be.keyword]!==void 0||Be.implements&&Ke(Be)}function Ke(Be){for(var xt=Be.implements,Ye=0;Ye<xt.length;Ye++)if(e.schema[xt[Ye]]!==void 0)return!0}return r}});var dh=_((OD,uh)=>{"use strict";var Pa=xa(),_a=Dr(),ch=wa(),eC=vi(),ih=yi(),tC=_a.ucs2length,rC=fa(),sC=ch.Validation;uh.exports=bi;function bi(s,e,t,n){var r=this,a=this._opts,o=[void 0],i={},c=[],u={},d=[],f={},h=[];e=e||{schema:s,refVal:o,refs:i};var p=nC.call(this,s,e,n),g=this._compilations[p.index];if(p.compiling)return g.callValidate=E;var y=this._formats,v=this.RULES;try{var w=R(s,e,t,n);g.validate=w;var C=g.callValidate;return C&&(C.schema=w.schema,C.errors=null,C.refs=w.refs,C.refVal=w.refVal,C.root=w.root,C.$async=w.$async,a.sourceCode&&(C.source=w.source)),w}finally{aC.call(this,s,e,n)}function E(){var k=g.validate,M=k.apply(this,arguments);return E.errors=k.errors,M}function R(k,M,N,K){var L=!M||M&&M.schema==k;if(M.schema!=e.schema)return bi.call(r,k,M,N,K);var J=k.$async===!0,re=ih({isTop:!0,schema:k,isRoot:L,baseId:K,root:M,schemaPath:"",errSchemaPath:"#",errorPath:'""',MissingRefError:ch.MissingRef,RULES:v,validate:ih,util:_a,resolve:Pa,resolveRef:A,usePattern:B,useDefault:H,useCustomRule:W,opts:a,formats:y,logger:r.logger,self:r});re=Sa(o,cC)+Sa(c,oC)+Sa(d,iC)+Sa(h,lC)+re,a.processCode&&(re=a.processCode(re,k));var Z;try{var _e=new Function("self","RULES","formats","root","refVal","defaults","customRules","equal","ucs2length","ValidationError",re);Z=_e(r,v,y,e,o,d,h,rC,tC,sC),o[0]=Z}catch(je){throw r.logger.error("Error compiling schema, function code:",re),je}return Z.schema=k,Z.errors=null,Z.refs=i,Z.refVal=o,Z.root=L?Z:M,J&&(Z.$async=!0),a.sourceCode===!0&&(Z.source={code:re,patterns:c,defaults:d}),Z}function A(k,M,N){M=Pa.url(k,M);var K=i[M],L,J;if(K!==void 0)return L=o[K],J="refVal["+K+"]",$(L,J);if(!N&&e.refs){var re=e.refs[M];if(re!==void 0)return L=e.refVal[re],J=D(M,L),$(L,J)}J=D(M);var Z=Pa.call(r,R,e,M);if(Z===void 0){var _e=t&&t[M];_e&&(Z=Pa.inlineRef(_e,a.inlineRefs)?_e:bi.call(r,_e,e,t,k))}if(Z===void 0)j(M);else return V(M,Z),$(Z,J)}function D(k,M){var N=o.length;return o[N]=M,i[k]=N,"refVal"+N}function j(k){delete i[k]}function V(k,M){var N=i[k];o[N]=M}function $(k,M){return typeof k=="object"||typeof k=="boolean"?{code:M,schema:k,inline:!0}:{code:M,$async:k&&!!k.$async}}function B(k){var M=u[k];return M===void 0&&(M=u[k]=c.length,c[M]=k),"pattern"+M}function H(k){switch(typeof k){case"boolean":case"number":return""+k;case"string":return _a.toQuotedString(k);case"object":if(k===null)return"null";var M=eC(k),N=f[M];return N===void 0&&(N=f[M]=d.length,d[N]=k),"default"+N}}function W(k,M,N,K){if(r._opts.validateSchema!==!1){var L=k.definition.dependencies;if(L&&!L.every(function(Me){return Object.prototype.hasOwnProperty.call(N,Me)}))throw new Error("parent schema must have all required keywords: "+L.join(","));var J=k.definition.validateSchema;if(J){var re=J(M);if(!re){var Z="keyword schema is invalid: "+r.errorsText(J.errors);if(r._opts.validateSchema=="log")r.logger.error(Z);else throw new Error(Z)}}}var _e=k.definition.compile,je=k.definition.inline,Ve=k.definition.macro,le;if(_e)le=_e.call(r,M,N,K);else if(Ve)le=Ve.call(r,M,N,K),a.validateSchema!==!1&&r.validateSchema(le,!0);else if(je)le=je.call(r,K,k.keyword,M,N);else if(le=k.definition.validate,!le)return;if(le===void 0)throw new Error('custom keyword "'+k.keyword+'"failed to compile');var Ae=h.length;return h[Ae]=le,{code:"customRule"+Ae,validate:le}}}function nC(s,e,t){var n=lh.call(this,s,e,t);return n>=0?{index:n,compiling:!0}:(n=this._compilations.length,this._compilations[n]={schema:s,root:e,baseId:t},{index:n,compiling:!1})}function aC(s,e,t){var n=lh.call(this,s,e,t);n>=0&&this._compilations.splice(n,1)}function lh(s,e,t){for(var n=0;n<this._compilations.length;n++){var r=this._compilations[n];if(r.schema==s&&r.root==e&&r.baseId==t)return n}return-1}function oC(s,e){return"var pattern"+s+" = new RegExp("+_a.toQuotedString(e[s])+");"}function iC(s){return"var default"+s+" = defaults["+s+"];"}function cC(s,e){return e[s]===void 0?"":"var refVal"+s+" = refVal["+s+"];"}function lC(s){return"var customRule"+s+" = customRules["+s+"];"}function Sa(s,e){if(!s.length)return"";for(var t="",n=0;n<s.length;n++)t+=e(n,s);return t}});var fh=_((DD,ph)=>{"use strict";var Ea=ph.exports=function(){this._cache={}};Ea.prototype.put=function(e,t){this._cache[e]=t};Ea.prototype.get=function(e){return this._cache[e]};Ea.prototype.del=function(e){delete this._cache[e]};Ea.prototype.clear=function(){this._cache={}}});var Eh=_(($D,_h)=>{"use strict";var uC=Dr(),dC=/^(\d\d\d\d)-(\d\d)-(\d\d)$/,pC=[0,31,28,31,30,31,30,31,31,30,31,30,31],fC=/^(\d\d):(\d\d):(\d\d)(\.\d+)?(z|[+-]\d\d(?::?\d\d)?)?$/i,hh=/^(?=.{1,253}\.?$)[a-z0-9](?:[a-z0-9-]{0,61}[a-z0-9])?(?:\.[a-z0-9](?:[-0-9a-z]{0,61}[0-9a-z])?)*\.?$/i,hC=/^(?:[a-z][a-z0-9+\-.]*:)(?:\/?\/(?:(?:[a-z0-9\-._~!$&'()*+,;=:]|%[0-9a-f]{2})*@)?(?:\[(?:(?:(?:(?:[0-9a-f]{1,4}:){6}|::(?:[0-9a-f]{1,4}:){5}|(?:[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){4}|(?:(?:[0-9a-f]{1,4}:){0,1}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){3}|(?:(?:[0-9a-f]{1,4}:){0,2}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){2}|(?:(?:[0-9a-f]{1,4}:){0,3}[0-9a-f]{1,4})?::[0-9a-f]{1,4}:|(?:(?:[0-9a-f]{1,4}:){0,4}[0-9a-f]{1,4})?::)(?:[0-9a-f]{1,4}:[0-9a-f]{1,4}|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?))|(?:(?:[0-9a-f]{1,4}:){0,5}[0-9a-f]{1,4})?::[0-9a-f]{1,4}|(?:(?:[0-9a-f]{1,4}:){0,6}[0-9a-f]{1,4})?::)|[Vv][0-9a-f]+\.[a-z0-9\-._~!$&'()*+,;=:]+)\]|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?)|(?:[a-z0-9\-._~!$&'()*+,;=]|%[0-9a-f]{2})*)(?::\d*)?(?:\/(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})*)*|\/(?:(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})*)*)?|(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})*)*)(?:\?(?:[a-z0-9\-._~!$&'()*+,;=:@/?]|%[0-9a-f]{2})*)?(?:#(?:[a-z0-9\-._~!$&'()*+,;=:@/?]|%[0-9a-f]{2})*)?$/i,mC=/^(?:[a-z][a-z0-9+\-.]*:)?(?:\/?\/(?:(?:[a-z0-9\-._~!$&'()*+,;=:]|%[0-9a-f]{2})*@)?(?:\[(?:(?:(?:(?:[0-9a-f]{1,4}:){6}|::(?:[0-9a-f]{1,4}:){5}|(?:[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){4}|(?:(?:[0-9a-f]{1,4}:){0,1}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){3}|(?:(?:[0-9a-f]{1,4}:){0,2}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){2}|(?:(?:[0-9a-f]{1,4}:){0,3}[0-9a-f]{1,4})?::[0-9a-f]{1,4}:|(?:(?:[0-9a-f]{1,4}:){0,4}[0-9a-f]{1,4})?::)(?:[0-9a-f]{1,4}:[0-9a-f]{1,4}|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?))|(?:(?:[0-9a-f]{1,4}:){0,5}[0-9a-f]{1,4})?::[0-9a-f]{1,4}|(?:(?:[0-9a-f]{1,4}:){0,6}[0-9a-f]{1,4})?::)|[Vv][0-9a-f]+\.[a-z0-9\-._~!$&'()*+,;=:]+)\]|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?)|(?:[a-z0-9\-._~!$&'"()*+,;=]|%[0-9a-f]{2})*)(?::\d*)?(?:\/(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})*)*|\/(?:(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})*)*)?|(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})*)*)?(?:\?(?:[a-z0-9\-._~!$&'"()*+,;=:@/?]|%[0-9a-f]{2})*)?(?:#(?:[a-z0-9\-._~!$&'"()*+,;=:@/?]|%[0-9a-f]{2})*)?$/i,mh=/^(?:(?:[^\x00-\x20"'<>%\\^`{|}]|%[0-9a-f]{2})|\{[+#./;?&=,!@|]?(?:[a-z0-9_]|%[0-9a-f]{2})+(?::[1-9][0-9]{0,3}|\*)?(?:,(?:[a-z0-9_]|%[0-9a-f]{2})+(?::[1-9][0-9]{0,3}|\*)?)*\})*$/i,gh=/^(?:(?:http[s\u017F]?|ftp):\/\/)(?:(?:[\0-\x08\x0E-\x1F!-\x9F\xA1-\u167F\u1681-\u1FFF\u200B-\u2027\u202A-\u202E\u2030-\u205E\u2060-\u2FFF\u3001-\uD7FF\uE000-\uFEFE\uFF00-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])+(?::(?:[\0-\x08\x0E-\x1F!-\x9F\xA1-\u167F\u1681-\u1FFF\u200B-\u2027\u202A-\u202E\u2030-\u205E\u2060-\u2FFF\u3001-\uD7FF\uE000-\uFEFE\uFF00-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])*)?@)?(?:(?!10(?:\.[0-9]{1,3}){3})(?!127(?:\.[0-9]{1,3}){3})(?!169\.254(?:\.[0-9]{1,3}){2})(?!192\.168(?:\.[0-9]{1,3}){2})(?!172\.(?:1[6-9]|2[0-9]|3[01])(?:\.[0-9]{1,3}){2})(?:[1-9][0-9]?|1[0-9][0-9]|2[01][0-9]|22[0-3])(?:\.(?:1?[0-9]{1,2}|2[0-4][0-9]|25[0-5])){2}(?:\.(?:[1-9][0-9]?|1[0-9][0-9]|2[0-4][0-9]|25[0-4]))|(?:(?:(?:[0-9a-z\xA1-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])+-)*(?:[0-9a-z\xA1-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])+)(?:\.(?:(?:[0-9a-z\xA1-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])+-)*(?:[0-9a-z\xA1-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])+)*(?:\.(?:(?:[a-z\xA1-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF]){2,})))(?::[0-9]{2,5})?(?:\/(?:[\0-\x08\x0E-\x1F!-\x9F\xA1-\u167F\u1681-\u1FFF\u200B-\u2027\u202A-\u202E\u2030-\u205E\u2060-\u2FFF\u3001-\uD7FF\uE000-\uFEFE\uFF00-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])*)?$/i,vh=/^(?:urn:uuid:)?[0-9a-f]{8}-(?:[0-9a-f]{4}-){3}[0-9a-f]{12}$/i,yh=/^(?:\/(?:[^~/]|~0|~1)*)*$/,bh=/^#(?:\/(?:[a-z0-9_\-.!$&'()*+,;:=@]|%[0-9a-f]{2}|~0|~1)*)*$/i,xh=/^(?:0|[1-9][0-9]*)(?:#|(?:\/(?:[^~/]|~0|~1)*)*)$/;_h.exports=Ca;function Ca(s){return s=s=="full"?"full":"fast",uC.copy(Ca[s])}Ca.fast={date:/^\d\d\d\d-[0-1]\d-[0-3]\d$/,time:/^(?:[0-2]\d:[0-5]\d:[0-5]\d|23:59:60)(?:\.\d+)?(?:z|[+-]\d\d(?::?\d\d)?)?$/i,"date-time":/^\d\d\d\d-[0-1]\d-[0-3]\d[t\s](?:[0-2]\d:[0-5]\d:[0-5]\d|23:59:60)(?:\.\d+)?(?:z|[+-]\d\d(?::?\d\d)?)$/i,uri:/^(?:[a-z][a-z0-9+\-.]*:)(?:\/?\/)?[^\s]*$/i,"uri-reference":/^(?:(?:[a-z][a-z0-9+\-.]*:)?\/?\/)?(?:[^\\\s#][^\s#]*)?(?:#[^\\\s]*)?$/i,"uri-template":mh,url:gh,email:/^[a-z0-9.!#$%&'*+/=?^_`{|}~-]+@[a-z0-9](?:[a-z0-9-]{0,61}[a-z0-9])?(?:\.[a-z0-9](?:[a-z0-9-]{0,61}[a-z0-9])?)*$/i,hostname:hh,ipv4:/^(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?)$/,ipv6:/^\s*(?:(?:(?:[0-9a-f]{1,4}:){7}(?:[0-9a-f]{1,4}|:))|(?:(?:[0-9a-f]{1,4}:){6}(?::[0-9a-f]{1,4}|(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(?:(?:[0-9a-f]{1,4}:){5}(?:(?:(?::[0-9a-f]{1,4}){1,2})|:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(?:(?:[0-9a-f]{1,4}:){4}(?:(?:(?::[0-9a-f]{1,4}){1,3})|(?:(?::[0-9a-f]{1,4})?:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(?:(?:[0-9a-f]{1,4}:){3}(?:(?:(?::[0-9a-f]{1,4}){1,4})|(?:(?::[0-9a-f]{1,4}){0,2}:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(?:(?:[0-9a-f]{1,4}:){2}(?:(?:(?::[0-9a-f]{1,4}){1,5})|(?:(?::[0-9a-f]{1,4}){0,3}:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(?:(?:[0-9a-f]{1,4}:){1}(?:(?:(?::[0-9a-f]{1,4}){1,6})|(?:(?::[0-9a-f]{1,4}){0,4}:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(?::(?:(?:(?::[0-9a-f]{1,4}){1,7})|(?:(?::[0-9a-f]{1,4}){0,5}:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:)))(?:%.+)?\s*$/i,regex:Sh,uuid:vh,"json-pointer":yh,"json-pointer-uri-fragment":bh,"relative-json-pointer":xh};Ca.full={date:wh,time:Ph,"date-time":yC,uri:xC,"uri-reference":mC,"uri-template":mh,url:gh,email:/^[a-z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-z0-9!#$%&'*+/=?^_`{|}~-]+)*@(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?$/i,hostname:hh,ipv4:/^(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?)$/,ipv6:/^\s*(?:(?:(?:[0-9a-f]{1,4}:){7}(?:[0-9a-f]{1,4}|:))|(?:(?:[0-9a-f]{1,4}:){6}(?::[0-9a-f]{1,4}|(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(?:(?:[0-9a-f]{1,4}:){5}(?:(?:(?::[0-9a-f]{1,4}){1,2})|:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(?:(?:[0-9a-f]{1,4}:){4}(?:(?:(?::[0-9a-f]{1,4}){1,3})|(?:(?::[0-9a-f]{1,4})?:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(?:(?:[0-9a-f]{1,4}:){3}(?:(?:(?::[0-9a-f]{1,4}){1,4})|(?:(?::[0-9a-f]{1,4}){0,2}:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(?:(?:[0-9a-f]{1,4}:){2}(?:(?:(?::[0-9a-f]{1,4}){1,5})|(?:(?::[0-9a-f]{1,4}){0,3}:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(?:(?:[0-9a-f]{1,4}:){1}(?:(?:(?::[0-9a-f]{1,4}){1,6})|(?:(?::[0-9a-f]{1,4}){0,4}:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(?::(?:(?:(?::[0-9a-f]{1,4}){1,7})|(?:(?::[0-9a-f]{1,4}){0,5}:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:)))(?:%.+)?\s*$/i,regex:Sh,uuid:vh,"json-pointer":yh,"json-pointer-uri-fragment":bh,"relative-json-pointer":xh};function gC(s){return s%4===0&&(s%100!==0||s%400===0)}function wh(s){var e=s.match(dC);if(!e)return!1;var t=+e[1],n=+e[2],r=+e[3];return n>=1&&n<=12&&r>=1&&r<=(n==2&&gC(t)?29:pC[n])}function Ph(s,e){var t=s.match(fC);if(!t)return!1;var n=t[1],r=t[2],a=t[3],o=t[5];return(n<=23&&r<=59&&a<=59||n==23&&r==59&&a==60)&&(!e||o)}var vC=/t|\s/i;function yC(s){var e=s.split(vC);return e.length==2&&wh(e[0])&&Ph(e[1],!0)}var bC=/\/|:/;function xC(s){return bC.test(s)&&hC.test(s)}var wC=/[^\\]\\Z/;function Sh(s){if(wC.test(s))return!1;try{return new RegExp(s),!0}catch{return!1}}});var Rh=_((MD,Ch)=>{"use strict";Ch.exports=function(e,t,n){var r=" ",a=e.level,o=e.dataLevel,i=e.schema[t],c=e.errSchemaPath+"/"+t,u=!e.opts.allErrors,d="data"+(o||""),f="valid"+a,h,p;if(i=="#"||i=="#/")e.isRoot?(h=e.async,p="validate"):(h=e.root.schema.$async===!0,p="root.refVal[0]");else{var g=e.resolveRef(e.baseId,i,e.isRoot);if(g===void 0){var y=e.MissingRefError.message(e.baseId,i);if(e.opts.missingRefs=="fail"){e.logger.error(y);var v=v||[];v.push(r),r="",e.createErrors!==!1?(r+=" { keyword: '$ref' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(c)+" , params: { ref: '"+e.util.escapeQuotes(i)+"' } ",e.opts.messages!==!1&&(r+=" , message: 'can\\'t resolve reference "+e.util.escapeQuotes(i)+"' "),e.opts.verbose&&(r+=" , schema: "+e.util.toQuotedString(i)+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+d+" "),r+=" } "):r+=" {} ";var w=r;r=v.pop(),!e.compositeRule&&u?e.async?r+=" throw new ValidationError(["+w+"]); ":r+=" validate.errors = ["+w+"]; return false; ":r+=" var err = "+w+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",u&&(r+=" if (false) { ")}else if(e.opts.missingRefs=="ignore")e.logger.warn(y),u&&(r+=" if (true) { ");else throw new e.MissingRefError(e.baseId,i,y)}else if(g.inline){var C=e.util.copy(e);C.level++;var E="valid"+C.level;C.schema=g.schema,C.schemaPath="",C.errSchemaPath=i;var R=e.validate(C).replace(/validate\.schema/g,g.code);r+=" "+R+" ",u&&(r+=" if ("+E+") { ")}else h=g.$async===!0||e.async&&g.$async!==!1,p=g.code}if(p){var v=v||[];v.push(r),r="",e.opts.passContext?r+=" "+p+".call(this, ":r+=" "+p+"( ",r+=" "+d+", (dataPath || '')",e.errorPath!='""'&&(r+=" + "+e.errorPath);var A=o?"data"+(o-1||""):"parentData",D=o?e.dataPathArr[o]:"parentDataProperty";r+=" , "+A+" , "+D+", rootData)  ";var j=r;if(r=v.pop(),h){if(!e.async)throw new Error("async schema referenced by sync schema");u&&(r+=" var "+f+"; "),r+=" try { await "+j+"; ",u&&(r+=" "+f+" = true; "),r+=" } catch (e) { if (!(e instanceof ValidationError)) throw e; if (vErrors === null) vErrors = e.errors; else vErrors = vErrors.concat(e.errors); errors = vErrors.length; ",u&&(r+=" "+f+" = false; "),r+=" } ",u&&(r+=" if ("+f+") { ")}else r+=" if (!"+j+") { if (vErrors === null) vErrors = "+p+".errors; else vErrors = vErrors.concat("+p+".errors); errors = vErrors.length; } ",u&&(r+=" else { ")}return r}});var Ah=_((LD,Th)=>{"use strict";Th.exports=function(e,t,n){var r=" ",a=e.schema[t],o=e.schemaPath+e.util.getProperty(t),i=e.errSchemaPath+"/"+t,c=!e.opts.allErrors,u=e.util.copy(e),d="";u.level++;var f="valid"+u.level,h=u.baseId,p=!0,g=a;if(g)for(var y,v=-1,w=g.length-1;v<w;)y=g[v+=1],(e.opts.strictKeywords?typeof y=="object"&&Object.keys(y).length>0||y===!1:e.util.schemaHasRules(y,e.RULES.all))&&(p=!1,u.schema=y,u.schemaPath=o+"["+v+"]",u.errSchemaPath=i+"/"+v,r+="  "+e.validate(u)+" ",u.baseId=h,c&&(r+=" if ("+f+") { ",d+="}"));return c&&(p?r+=" if (true) { ":r+=" "+d.slice(0,-1)+" "),r}});var kh=_((ND,Ih)=>{"use strict";Ih.exports=function(e,t,n){var r=" ",a=e.level,o=e.dataLevel,i=e.schema[t],c=e.schemaPath+e.util.getProperty(t),u=e.errSchemaPath+"/"+t,d=!e.opts.allErrors,f="data"+(o||""),h="valid"+a,p="errs__"+a,g=e.util.copy(e),y="";g.level++;var v="valid"+g.level,w=i.every(function(V){return e.opts.strictKeywords?typeof V=="object"&&Object.keys(V).length>0||V===!1:e.util.schemaHasRules(V,e.RULES.all)});if(w){var C=g.baseId;r+=" var "+p+" = errors; var "+h+" = false;  ";var E=e.compositeRule;e.compositeRule=g.compositeRule=!0;var R=i;if(R)for(var A,D=-1,j=R.length-1;D<j;)A=R[D+=1],g.schema=A,g.schemaPath=c+"["+D+"]",g.errSchemaPath=u+"/"+D,r+="  "+e.validate(g)+" ",g.baseId=C,r+=" "+h+" = "+h+" || "+v+"; if (!"+h+") { ",y+="}";e.compositeRule=g.compositeRule=E,r+=" "+y+" if (!"+h+") {   var err =   ",e.createErrors!==!1?(r+=" { keyword: 'anyOf' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(u)+" , params: {} ",e.opts.messages!==!1&&(r+=" , message: 'should match some schema in anyOf' "),e.opts.verbose&&(r+=" , schema: validate.schema"+c+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+f+" "),r+=" } "):r+=" {} ",r+=";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",!e.compositeRule&&d&&(e.async?r+=" throw new ValidationError(vErrors); ":r+=" validate.errors = vErrors; return false; "),r+=" } else {  errors = "+p+"; if (vErrors !== null) { if ("+p+") vErrors.length = "+p+"; else vErrors = null; } ",e.opts.allErrors&&(r+=" } ")}else d&&(r+=" if (true) { ");return r}});var Dh=_((FD,Oh)=>{"use strict";Oh.exports=function(e,t,n){var r=" ",a=e.schema[t],o=e.errSchemaPath+"/"+t,i=!e.opts.allErrors,c=e.util.toQuotedString(a);return e.opts.$comment===!0?r+=" console.log("+c+");":typeof e.opts.$comment=="function"&&(r+=" self._opts.$comment("+c+", "+e.util.toQuotedString(o)+", validate.root.schema);"),r}});var Mh=_((jD,$h)=>{"use strict";$h.exports=function(e,t,n){var r=" ",a=e.level,o=e.dataLevel,i=e.schema[t],c=e.schemaPath+e.util.getProperty(t),u=e.errSchemaPath+"/"+t,d=!e.opts.allErrors,f="data"+(o||""),h="valid"+a,p=e.opts.$data&&i&&i.$data,g;p?(r+=" var schema"+a+" = "+e.util.getData(i.$data,o,e.dataPathArr)+"; ",g="schema"+a):g=i,p||(r+=" var schema"+a+" = validate.schema"+c+";"),r+="var "+h+" = equal("+f+", schema"+a+"); if (!"+h+") {   ";var y=y||[];y.push(r),r="",e.createErrors!==!1?(r+=" { keyword: 'const' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(u)+" , params: { allowedValue: schema"+a+" } ",e.opts.messages!==!1&&(r+=" , message: 'should be equal to constant' "),e.opts.verbose&&(r+=" , schema: validate.schema"+c+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+f+" "),r+=" } "):r+=" {} ";var v=r;return r=y.pop(),!e.compositeRule&&d?e.async?r+=" throw new ValidationError(["+v+"]); ":r+=" validate.errors = ["+v+"]; return false; ":r+=" var err = "+v+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",r+=" }",d&&(r+=" else { "),r}});var Nh=_((qD,Lh)=>{"use strict";Lh.exports=function(e,t,n){var r=" ",a=e.level,o=e.dataLevel,i=e.schema[t],c=e.schemaPath+e.util.getProperty(t),u=e.errSchemaPath+"/"+t,d=!e.opts.allErrors,f="data"+(o||""),h="valid"+a,p="errs__"+a,g=e.util.copy(e),y="";g.level++;var v="valid"+g.level,w="i"+a,C=g.dataLevel=e.dataLevel+1,E="data"+C,R=e.baseId,A=e.opts.strictKeywords?typeof i=="object"&&Object.keys(i).length>0||i===!1:e.util.schemaHasRules(i,e.RULES.all);if(r+="var "+p+" = errors;var "+h+";",A){var D=e.compositeRule;e.compositeRule=g.compositeRule=!0,g.schema=i,g.schemaPath=c,g.errSchemaPath=u,r+=" var "+v+" = false; for (var "+w+" = 0; "+w+" < "+f+".length; "+w+"++) { ",g.errorPath=e.util.getPathExpr(e.errorPath,w,e.opts.jsonPointers,!0);var j=f+"["+w+"]";g.dataPathArr[C]=w;var V=e.validate(g);g.baseId=R,e.util.varOccurences(V,E)<2?r+=" "+e.util.varReplace(V,E,j)+" ":r+=" var "+E+" = "+j+"; "+V+" ",r+=" if ("+v+") break; }  ",e.compositeRule=g.compositeRule=D,r+=" "+y+" if (!"+v+") {"}else r+=" if ("+f+".length == 0) {";var $=$||[];$.push(r),r="",e.createErrors!==!1?(r+=" { keyword: 'contains' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(u)+" , params: {} ",e.opts.messages!==!1&&(r+=" , message: 'should contain a valid item' "),e.opts.verbose&&(r+=" , schema: validate.schema"+c+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+f+" "),r+=" } "):r+=" {} ";var B=r;return r=$.pop(),!e.compositeRule&&d?e.async?r+=" throw new ValidationError(["+B+"]); ":r+=" validate.errors = ["+B+"]; return false; ":r+=" var err = "+B+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",r+=" } else { ",A&&(r+="  errors = "+p+"; if (vErrors !== null) { if ("+p+") vErrors.length = "+p+"; else vErrors = null; } "),e.opts.allErrors&&(r+=" } "),r}});var jh=_((UD,Fh)=>{"use strict";Fh.exports=function(e,t,n){var r=" ",a=e.level,o=e.dataLevel,i=e.schema[t],c=e.schemaPath+e.util.getProperty(t),u=e.errSchemaPath+"/"+t,d=!e.opts.allErrors,f="data"+(o||""),h="errs__"+a,p=e.util.copy(e),g="";p.level++;var y="valid"+p.level,v={},w={},C=e.opts.ownProperties;for(D in i)if(D!="__proto__"){var E=i[D],R=Array.isArray(E)?w:v;R[D]=E}r+="var "+h+" = errors;";var A=e.errorPath;r+="var missing"+a+";";for(var D in w)if(R=w[D],R.length){if(r+=" if ( "+f+e.util.getProperty(D)+" !== undefined ",C&&(r+=" && Object.prototype.hasOwnProperty.call("+f+", '"+e.util.escapeQuotes(D)+"') "),d){r+=" && ( ";var j=R;if(j)for(var V,$=-1,B=j.length-1;$<B;){V=j[$+=1],$&&(r+=" || ");var H=e.util.getProperty(V),W=f+H;r+=" ( ( "+W+" === undefined ",C&&(r+=" || ! Object.prototype.hasOwnProperty.call("+f+", '"+e.util.escapeQuotes(V)+"') "),r+=") && (missing"+a+" = "+e.util.toQuotedString(e.opts.jsonPointers?V:H)+") ) "}r+=")) {  ";var k="missing"+a,M="' + "+k+" + '";e.opts._errorDataPathProperty&&(e.errorPath=e.opts.jsonPointers?e.util.getPathExpr(A,k,!0):A+" + "+k);var N=N||[];N.push(r),r="",e.createErrors!==!1?(r+=" { keyword: 'dependencies' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(u)+" , params: { property: '"+e.util.escapeQuotes(D)+"', missingProperty: '"+M+"', depsCount: "+R.length+", deps: '"+e.util.escapeQuotes(R.length==1?R[0]:R.join(", "))+"' } ",e.opts.messages!==!1&&(r+=" , message: 'should have ",R.length==1?r+="property "+e.util.escapeQuotes(R[0]):r+="properties "+e.util.escapeQuotes(R.join(", ")),r+=" when property "+e.util.escapeQuotes(D)+" is present' "),e.opts.verbose&&(r+=" , schema: validate.schema"+c+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+f+" "),r+=" } "):r+=" {} ";var K=r;r=N.pop(),!e.compositeRule&&d?e.async?r+=" throw new ValidationError(["+K+"]); ":r+=" validate.errors = ["+K+"]; return false; ":r+=" var err = "+K+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; "}else{r+=" ) { ";var L=R;if(L)for(var V,J=-1,re=L.length-1;J<re;){V=L[J+=1];var H=e.util.getProperty(V),M=e.util.escapeQuotes(V),W=f+H;e.opts._errorDataPathProperty&&(e.errorPath=e.util.getPath(A,V,e.opts.jsonPointers)),r+=" if ( "+W+" === undefined ",C&&(r+=" || ! Object.prototype.hasOwnProperty.call("+f+", '"+e.util.escapeQuotes(V)+"') "),r+=") {  var err =   ",e.createErrors!==!1?(r+=" { keyword: 'dependencies' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(u)+" , params: { property: '"+e.util.escapeQuotes(D)+"', missingProperty: '"+M+"', depsCount: "+R.length+", deps: '"+e.util.escapeQuotes(R.length==1?R[0]:R.join(", "))+"' } ",e.opts.messages!==!1&&(r+=" , message: 'should have ",R.length==1?r+="property "+e.util.escapeQuotes(R[0]):r+="properties "+e.util.escapeQuotes(R.join(", ")),r+=" when property "+e.util.escapeQuotes(D)+" is present' "),e.opts.verbose&&(r+=" , schema: validate.schema"+c+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+f+" "),r+=" } "):r+=" {} ",r+=";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; } "}}r+=" }   ",d&&(g+="}",r+=" else { ")}e.errorPath=A;var Z=p.baseId;for(var D in v){var E=v[D];(e.opts.strictKeywords?typeof E=="object"&&Object.keys(E).length>0||E===!1:e.util.schemaHasRules(E,e.RULES.all))&&(r+=" "+y+" = true; if ( "+f+e.util.getProperty(D)+" !== undefined ",C&&(r+=" && Object.prototype.hasOwnProperty.call("+f+", '"+e.util.escapeQuotes(D)+"') "),r+=") { ",p.schema=E,p.schemaPath=c+e.util.getProperty(D),p.errSchemaPath=u+"/"+e.util.escapeFragment(D),r+="  "+e.validate(p)+" ",p.baseId=Z,r+=" }  ",d&&(r+=" if ("+y+") { ",g+="}"))}return d&&(r+="   "+g+" if ("+h+" == errors) {"),r}});var Uh=_((WD,qh)=>{"use strict";qh.exports=function(e,t,n){var r=" ",a=e.level,o=e.dataLevel,i=e.schema[t],c=e.schemaPath+e.util.getProperty(t),u=e.errSchemaPath+"/"+t,d=!e.opts.allErrors,f="data"+(o||""),h="valid"+a,p=e.opts.$data&&i&&i.$data,g;p?(r+=" var schema"+a+" = "+e.util.getData(i.$data,o,e.dataPathArr)+"; ",g="schema"+a):g=i;var y="i"+a,v="schema"+a;p||(r+=" var "+v+" = validate.schema"+c+";"),r+="var "+h+";",p&&(r+=" if (schema"+a+" === undefined) "+h+" = true; else if (!Array.isArray(schema"+a+")) "+h+" = false; else {"),r+=""+h+" = false;for (var "+y+"=0; "+y+"<"+v+".length; "+y+"++) if (equal("+f+", "+v+"["+y+"])) { "+h+" = true; break; }",p&&(r+="  }  "),r+=" if (!"+h+") {   ";var w=w||[];w.push(r),r="",e.createErrors!==!1?(r+=" { keyword: 'enum' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(u)+" , params: { allowedValues: schema"+a+" } ",e.opts.messages!==!1&&(r+=" , message: 'should be equal to one of the allowed values' "),e.opts.verbose&&(r+=" , schema: validate.schema"+c+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+f+" "),r+=" } "):r+=" {} ";var C=r;return r=w.pop(),!e.compositeRule&&d?e.async?r+=" throw new ValidationError(["+C+"]); ":r+=" validate.errors = ["+C+"]; return false; ":r+=" var err = "+C+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",r+=" }",d&&(r+=" else { "),r}});var Vh=_((VD,Wh)=>{"use strict";Wh.exports=function(e,t,n){var r=" ",a=e.level,o=e.dataLevel,i=e.schema[t],c=e.schemaPath+e.util.getProperty(t),u=e.errSchemaPath+"/"+t,d=!e.opts.allErrors,f="data"+(o||"");if(e.opts.format===!1)return d&&(r+=" if (true) { "),r;var h=e.opts.$data&&i&&i.$data,p;h?(r+=" var schema"+a+" = "+e.util.getData(i.$data,o,e.dataPathArr)+"; ",p="schema"+a):p=i;var g=e.opts.unknownFormats,y=Array.isArray(g);if(h){var v="format"+a,w="isObject"+a,C="formatType"+a;r+=" var "+v+" = formats["+p+"]; var "+w+" = typeof "+v+" == 'object' && !("+v+" instanceof RegExp) && "+v+".validate; var "+C+" = "+w+" && "+v+".type || 'string'; if ("+w+") { ",e.async&&(r+=" var async"+a+" = "+v+".async; "),r+=" "+v+" = "+v+".validate; } if (  ",h&&(r+=" ("+p+" !== undefined && typeof "+p+" != 'string') || "),r+=" (",g!="ignore"&&(r+=" ("+p+" && !"+v+" ",y&&(r+=" && self._opts.unknownFormats.indexOf("+p+") == -1 "),r+=") || "),r+=" ("+v+" && "+C+" == '"+n+"' && !(typeof "+v+" == 'function' ? ",e.async?r+=" (async"+a+" ? await "+v+"("+f+") : "+v+"("+f+")) ":r+=" "+v+"("+f+") ",r+=" : "+v+".test("+f+"))))) {"}else{var v=e.formats[i];if(!v){if(g=="ignore")return e.logger.warn('unknown format "'+i+'" ignored in schema at path "'+e.errSchemaPath+'"'),d&&(r+=" if (true) { "),r;if(y&&g.indexOf(i)>=0)return d&&(r+=" if (true) { "),r;throw new Error('unknown format "'+i+'" is used in schema at path "'+e.errSchemaPath+'"')}var w=typeof v=="object"&&!(v instanceof RegExp)&&v.validate,C=w&&v.type||"string";if(w){var E=v.async===!0;v=v.validate}if(C!=n)return d&&(r+=" if (true) { "),r;if(E){if(!e.async)throw new Error("async format in sync schema");var R="formats"+e.util.getProperty(i)+".validate";r+=" if (!(await "+R+"("+f+"))) { "}else{r+=" if (! ";var R="formats"+e.util.getProperty(i);w&&(R+=".validate"),typeof v=="function"?r+=" "+R+"("+f+") ":r+=" "+R+".test("+f+") ",r+=") { "}}var A=A||[];A.push(r),r="",e.createErrors!==!1?(r+=" { keyword: 'format' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(u)+" , params: { format:  ",h?r+=""+p:r+=""+e.util.toQuotedString(i),r+="  } ",e.opts.messages!==!1&&(r+=` , message: 'should match format "`,h?r+="' + "+p+" + '":r+=""+e.util.escapeQuotes(i),r+=`"' `),e.opts.verbose&&(r+=" , schema:  ",h?r+="validate.schema"+c:r+=""+e.util.toQuotedString(i),r+="         , parentSchema: validate.schema"+e.schemaPath+" , data: "+f+" "),r+=" } "):r+=" {} ";var D=r;return r=A.pop(),!e.compositeRule&&d?e.async?r+=" throw new ValidationError(["+D+"]); ":r+=" validate.errors = ["+D+"]; return false; ":r+=" var err = "+D+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",r+=" } ",d&&(r+=" else { "),r}});var Bh=_((HD,Hh)=>{"use strict";Hh.exports=function(e,t,n){var r=" ",a=e.level,o=e.dataLevel,i=e.schema[t],c=e.schemaPath+e.util.getProperty(t),u=e.errSchemaPath+"/"+t,d=!e.opts.allErrors,f="data"+(o||""),h="valid"+a,p="errs__"+a,g=e.util.copy(e);g.level++;var y="valid"+g.level,v=e.schema.then,w=e.schema.else,C=v!==void 0&&(e.opts.strictKeywords?typeof v=="object"&&Object.keys(v).length>0||v===!1:e.util.schemaHasRules(v,e.RULES.all)),E=w!==void 0&&(e.opts.strictKeywords?typeof w=="object"&&Object.keys(w).length>0||w===!1:e.util.schemaHasRules(w,e.RULES.all)),R=g.baseId;if(C||E){var A;g.createErrors=!1,g.schema=i,g.schemaPath=c,g.errSchemaPath=u,r+=" var "+p+" = errors; var "+h+" = true;  ";var D=e.compositeRule;e.compositeRule=g.compositeRule=!0,r+="  "+e.validate(g)+" ",g.baseId=R,g.createErrors=!0,r+="  errors = "+p+"; if (vErrors !== null) { if ("+p+") vErrors.length = "+p+"; else vErrors = null; }  ",e.compositeRule=g.compositeRule=D,C?(r+=" if ("+y+") {  ",g.schema=e.schema.then,g.schemaPath=e.schemaPath+".then",g.errSchemaPath=e.errSchemaPath+"/then",r+="  "+e.validate(g)+" ",g.baseId=R,r+=" "+h+" = "+y+"; ",C&&E?(A="ifClause"+a,r+=" var "+A+" = 'then'; "):A="'then'",r+=" } ",E&&(r+=" else { ")):r+=" if (!"+y+") { ",E&&(g.schema=e.schema.else,g.schemaPath=e.schemaPath+".else",g.errSchemaPath=e.errSchemaPath+"/else",r+="  "+e.validate(g)+" ",g.baseId=R,r+=" "+h+" = "+y+"; ",C&&E?(A="ifClause"+a,r+=" var "+A+" = 'else'; "):A="'else'",r+=" } "),r+=" if (!"+h+") {   var err =   ",e.createErrors!==!1?(r+=" { keyword: 'if' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(u)+" , params: { failingKeyword: "+A+" } ",e.opts.messages!==!1&&(r+=` , message: 'should match "' + `+A+` + '" schema' `),e.opts.verbose&&(r+=" , schema: validate.schema"+c+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+f+" "),r+=" } "):r+=" {} ",r+=";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",!e.compositeRule&&d&&(e.async?r+=" throw new ValidationError(vErrors); ":r+=" validate.errors = vErrors; return false; "),r+=" }   ",d&&(r+=" else { ")}else d&&(r+=" if (true) { ");return r}});var Gh=_((BD,zh)=>{"use strict";zh.exports=function(e,t,n){var r=" ",a=e.level,o=e.dataLevel,i=e.schema[t],c=e.schemaPath+e.util.getProperty(t),u=e.errSchemaPath+"/"+t,d=!e.opts.allErrors,f="data"+(o||""),h="valid"+a,p="errs__"+a,g=e.util.copy(e),y="";g.level++;var v="valid"+g.level,w="i"+a,C=g.dataLevel=e.dataLevel+1,E="data"+C,R=e.baseId;if(r+="var "+p+" = errors;var "+h+";",Array.isArray(i)){var A=e.schema.additionalItems;if(A===!1){r+=" "+h+" = "+f+".length <= "+i.length+"; ";var D=u;u=e.errSchemaPath+"/additionalItems",r+="  if (!"+h+") {   ";var j=j||[];j.push(r),r="",e.createErrors!==!1?(r+=" { keyword: 'additionalItems' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(u)+" , params: { limit: "+i.length+" } ",e.opts.messages!==!1&&(r+=" , message: 'should NOT have more than "+i.length+" items' "),e.opts.verbose&&(r+=" , schema: false , parentSchema: validate.schema"+e.schemaPath+" , data: "+f+" "),r+=" } "):r+=" {} ";var V=r;r=j.pop(),!e.compositeRule&&d?e.async?r+=" throw new ValidationError(["+V+"]); ":r+=" validate.errors = ["+V+"]; return false; ":r+=" var err = "+V+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",r+=" } ",u=D,d&&(y+="}",r+=" else { ")}var $=i;if($){for(var B,H=-1,W=$.length-1;H<W;)if(B=$[H+=1],e.opts.strictKeywords?typeof B=="object"&&Object.keys(B).length>0||B===!1:e.util.schemaHasRules(B,e.RULES.all)){r+=" "+v+" = true; if ("+f+".length > "+H+") { ";var k=f+"["+H+"]";g.schema=B,g.schemaPath=c+"["+H+"]",g.errSchemaPath=u+"/"+H,g.errorPath=e.util.getPathExpr(e.errorPath,H,e.opts.jsonPointers,!0),g.dataPathArr[C]=H;var M=e.validate(g);g.baseId=R,e.util.varOccurences(M,E)<2?r+=" "+e.util.varReplace(M,E,k)+" ":r+=" var "+E+" = "+k+"; "+M+" ",r+=" }  ",d&&(r+=" if ("+v+") { ",y+="}")}}if(typeof A=="object"&&(e.opts.strictKeywords?typeof A=="object"&&Object.keys(A).length>0||A===!1:e.util.schemaHasRules(A,e.RULES.all))){g.schema=A,g.schemaPath=e.schemaPath+".additionalItems",g.errSchemaPath=e.errSchemaPath+"/additionalItems",r+=" "+v+" = true; if ("+f+".length > "+i.length+") {  for (var "+w+" = "+i.length+"; "+w+" < "+f+".length; "+w+"++) { ",g.errorPath=e.util.getPathExpr(e.errorPath,w,e.opts.jsonPointers,!0);var k=f+"["+w+"]";g.dataPathArr[C]=w;var M=e.validate(g);g.baseId=R,e.util.varOccurences(M,E)<2?r+=" "+e.util.varReplace(M,E,k)+" ":r+=" var "+E+" = "+k+"; "+M+" ",d&&(r+=" if (!"+v+") break; "),r+=" } }  ",d&&(r+=" if ("+v+") { ",y+="}")}}else if(e.opts.strictKeywords?typeof i=="object"&&Object.keys(i).length>0||i===!1:e.util.schemaHasRules(i,e.RULES.all)){g.schema=i,g.schemaPath=c,g.errSchemaPath=u,r+="  for (var "+w+" = 0; "+w+" < "+f+".length; "+w+"++) { ",g.errorPath=e.util.getPathExpr(e.errorPath,w,e.opts.jsonPointers,!0);var k=f+"["+w+"]";g.dataPathArr[C]=w;var M=e.validate(g);g.baseId=R,e.util.varOccurences(M,E)<2?r+=" "+e.util.varReplace(M,E,k)+" ":r+=" var "+E+" = "+k+"; "+M+" ",d&&(r+=" if (!"+v+") break; "),r+=" }"}return d&&(r+=" "+y+" if ("+p+" == errors) {"),r}});var xi=_((zD,Kh)=>{"use strict";Kh.exports=function(e,t,n){var r=" ",a=e.level,o=e.dataLevel,i=e.schema[t],c=e.schemaPath+e.util.getProperty(t),u=e.errSchemaPath+"/"+t,d=!e.opts.allErrors,R,f="data"+(o||""),h=e.opts.$data&&i&&i.$data,p;h?(r+=" var schema"+a+" = "+e.util.getData(i.$data,o,e.dataPathArr)+"; ",p="schema"+a):p=i;var g=t=="maximum",y=g?"exclusiveMaximum":"exclusiveMinimum",v=e.schema[y],w=e.opts.$data&&v&&v.$data,C=g?"<":">",E=g?">":"<",R=void 0;if(!(h||typeof i=="number"||i===void 0))throw new Error(t+" must be number");if(!(w||v===void 0||typeof v=="number"||typeof v=="boolean"))throw new Error(y+" must be number or boolean");if(w){var A=e.util.getData(v.$data,o,e.dataPathArr),D="exclusive"+a,j="exclType"+a,V="exclIsNumber"+a,$="op"+a,B="' + "+$+" + '";r+=" var schemaExcl"+a+" = "+A+"; ",A="schemaExcl"+a,r+=" var "+D+"; var "+j+" = typeof "+A+"; if ("+j+" != 'boolean' && "+j+" != 'undefined' && "+j+" != 'number') { ";var R=y,H=H||[];H.push(r),r="",e.createErrors!==!1?(r+=" { keyword: '"+(R||"_exclusiveLimit")+"' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(u)+" , params: {} ",e.opts.messages!==!1&&(r+=" , message: '"+y+" should be boolean' "),e.opts.verbose&&(r+=" , schema: validate.schema"+c+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+f+" "),r+=" } "):r+=" {} ";var W=r;r=H.pop(),!e.compositeRule&&d?e.async?r+=" throw new ValidationError(["+W+"]); ":r+=" validate.errors = ["+W+"]; return false; ":r+=" var err = "+W+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",r+=" } else if ( ",h&&(r+=" ("+p+" !== undefined && typeof "+p+" != 'number') || "),r+=" "+j+" == 'number' ? ( ("+D+" = "+p+" === undefined || "+A+" "+C+"= "+p+") ? "+f+" "+E+"= "+A+" : "+f+" "+E+" "+p+" ) : ( ("+D+" = "+A+" === true) ? "+f+" "+E+"= "+p+" : "+f+" "+E+" "+p+" ) || "+f+" !== "+f+") { var op"+a+" = "+D+" ? '"+C+"' : '"+C+"='; ",i===void 0&&(R=y,u=e.errSchemaPath+"/"+y,p=A,h=w)}else{var V=typeof v=="number",B=C;if(V&&h){var $="'"+B+"'";r+=" if ( ",h&&(r+=" ("+p+" !== undefined && typeof "+p+" != 'number') || "),r+=" ( "+p+" === undefined || "+v+" "+C+"= "+p+" ? "+f+" "+E+"= "+v+" : "+f+" "+E+" "+p+" ) || "+f+" !== "+f+") { "}else{V&&i===void 0?(D=!0,R=y,u=e.errSchemaPath+"/"+y,p=v,E+="="):(V&&(p=Math[g?"min":"max"](v,i)),v===(V?p:!0)?(D=!0,R=y,u=e.errSchemaPath+"/"+y,E+="="):(D=!1,B+="="));var $="'"+B+"'";r+=" if ( ",h&&(r+=" ("+p+" !== undefined && typeof "+p+" != 'number') || "),r+=" "+f+" "+E+" "+p+" || "+f+" !== "+f+") { "}}R=R||t;var H=H||[];H.push(r),r="",e.createErrors!==!1?(r+=" { keyword: '"+(R||"_limit")+"' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(u)+" , params: { comparison: "+$+", limit: "+p+", exclusive: "+D+" } ",e.opts.messages!==!1&&(r+=" , message: 'should be "+B+" ",h?r+="' + "+p:r+=""+p+"'"),e.opts.verbose&&(r+=" , schema:  ",h?r+="validate.schema"+c:r+=""+i,r+="         , parentSchema: validate.schema"+e.schemaPath+" , data: "+f+" "),r+=" } "):r+=" {} ";var W=r;return r=H.pop(),!e.compositeRule&&d?e.async?r+=" throw new ValidationError(["+W+"]); ":r+=" validate.errors = ["+W+"]; return false; ":r+=" var err = "+W+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",r+=" } ",d&&(r+=" else { "),r}});var wi=_((GD,Zh)=>{"use strict";Zh.exports=function(e,t,n){var r=" ",a=e.level,o=e.dataLevel,i=e.schema[t],c=e.schemaPath+e.util.getProperty(t),u=e.errSchemaPath+"/"+t,d=!e.opts.allErrors,y,f="data"+(o||""),h=e.opts.$data&&i&&i.$data,p;if(h?(r+=" var schema"+a+" = "+e.util.getData(i.$data,o,e.dataPathArr)+"; ",p="schema"+a):p=i,!(h||typeof i=="number"))throw new Error(t+" must be number");var g=t=="maxItems"?">":"<";r+="if ( ",h&&(r+=" ("+p+" !== undefined && typeof "+p+" != 'number') || "),r+=" "+f+".length "+g+" "+p+") { ";var y=t,v=v||[];v.push(r),r="",e.createErrors!==!1?(r+=" { keyword: '"+(y||"_limitItems")+"' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(u)+" , params: { limit: "+p+" } ",e.opts.messages!==!1&&(r+=" , message: 'should NOT have ",t=="maxItems"?r+="more":r+="fewer",r+=" than ",h?r+="' + "+p+" + '":r+=""+i,r+=" items' "),e.opts.verbose&&(r+=" , schema:  ",h?r+="validate.schema"+c:r+=""+i,r+="         , parentSchema: validate.schema"+e.schemaPath+" , data: "+f+" "),r+=" } "):r+=" {} ";var w=r;return r=v.pop(),!e.compositeRule&&d?e.async?r+=" throw new ValidationError(["+w+"]); ":r+=" validate.errors = ["+w+"]; return false; ":r+=" var err = "+w+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",r+="} ",d&&(r+=" else { "),r}});var Pi=_((KD,Jh)=>{"use strict";Jh.exports=function(e,t,n){var r=" ",a=e.level,o=e.dataLevel,i=e.schema[t],c=e.schemaPath+e.util.getProperty(t),u=e.errSchemaPath+"/"+t,d=!e.opts.allErrors,y,f="data"+(o||""),h=e.opts.$data&&i&&i.$data,p;if(h?(r+=" var schema"+a+" = "+e.util.getData(i.$data,o,e.dataPathArr)+"; ",p="schema"+a):p=i,!(h||typeof i=="number"))throw new Error(t+" must be number");var g=t=="maxLength"?">":"<";r+="if ( ",h&&(r+=" ("+p+" !== undefined && typeof "+p+" != 'number') || "),e.opts.unicode===!1?r+=" "+f+".length ":r+=" ucs2length("+f+") ",r+=" "+g+" "+p+") { ";var y=t,v=v||[];v.push(r),r="",e.createErrors!==!1?(r+=" { keyword: '"+(y||"_limitLength")+"' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(u)+" , params: { limit: "+p+" } ",e.opts.messages!==!1&&(r+=" , message: 'should NOT be ",t=="maxLength"?r+="longer":r+="shorter",r+=" than ",h?r+="' + "+p+" + '":r+=""+i,r+=" characters' "),e.opts.verbose&&(r+=" , schema:  ",h?r+="validate.schema"+c:r+=""+i,r+="         , parentSchema: validate.schema"+e.schemaPath+" , data: "+f+" "),r+=" } "):r+=" {} ";var w=r;return r=v.pop(),!e.compositeRule&&d?e.async?r+=" throw new ValidationError(["+w+"]); ":r+=" validate.errors = ["+w+"]; return false; ":r+=" var err = "+w+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",r+="} ",d&&(r+=" else { "),r}});var Si=_((ZD,Qh)=>{"use strict";Qh.exports=function(e,t,n){var r=" ",a=e.level,o=e.dataLevel,i=e.schema[t],c=e.schemaPath+e.util.getProperty(t),u=e.errSchemaPath+"/"+t,d=!e.opts.allErrors,y,f="data"+(o||""),h=e.opts.$data&&i&&i.$data,p;if(h?(r+=" var schema"+a+" = "+e.util.getData(i.$data,o,e.dataPathArr)+"; ",p="schema"+a):p=i,!(h||typeof i=="number"))throw new Error(t+" must be number");var g=t=="maxProperties"?">":"<";r+="if ( ",h&&(r+=" ("+p+" !== undefined && typeof "+p+" != 'number') || "),r+=" Object.keys("+f+").length "+g+" "+p+") { ";var y=t,v=v||[];v.push(r),r="",e.createErrors!==!1?(r+=" { keyword: '"+(y||"_limitProperties")+"' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(u)+" , params: { limit: "+p+" } ",e.opts.messages!==!1&&(r+=" , message: 'should NOT have ",t=="maxProperties"?r+="more":r+="fewer",r+=" than ",h?r+="' + "+p+" + '":r+=""+i,r+=" properties' "),e.opts.verbose&&(r+=" , schema:  ",h?r+="validate.schema"+c:r+=""+i,r+="         , parentSchema: validate.schema"+e.schemaPath+" , data: "+f+" "),r+=" } "):r+=" {} ";var w=r;return r=v.pop(),!e.compositeRule&&d?e.async?r+=" throw new ValidationError(["+w+"]); ":r+=" validate.errors = ["+w+"]; return false; ":r+=" var err = "+w+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",r+="} ",d&&(r+=" else { "),r}});var Yh=_((JD,Xh)=>{"use strict";Xh.exports=function(e,t,n){var r=" ",a=e.level,o=e.dataLevel,i=e.schema[t],c=e.schemaPath+e.util.getProperty(t),u=e.errSchemaPath+"/"+t,d=!e.opts.allErrors,f="data"+(o||""),h=e.opts.$data&&i&&i.$data,p;if(h?(r+=" var schema"+a+" = "+e.util.getData(i.$data,o,e.dataPathArr)+"; ",p="schema"+a):p=i,!(h||typeof i=="number"))throw new Error(t+" must be number");r+="var division"+a+";if (",h&&(r+=" "+p+" !== undefined && ( typeof "+p+" != 'number' || "),r+=" (division"+a+" = "+f+" / "+p+", ",e.opts.multipleOfPrecision?r+=" Math.abs(Math.round(division"+a+") - division"+a+") > 1e-"+e.opts.multipleOfPrecision+" ":r+=" division"+a+" !== parseInt(division"+a+") ",r+=" ) ",h&&(r+="  )  "),r+=" ) {   ";var g=g||[];g.push(r),r="",e.createErrors!==!1?(r+=" { keyword: 'multipleOf' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(u)+" , params: { multipleOf: "+p+" } ",e.opts.messages!==!1&&(r+=" , message: 'should be multiple of ",h?r+="' + "+p:r+=""+p+"'"),e.opts.verbose&&(r+=" , schema:  ",h?r+="validate.schema"+c:r+=""+i,r+="         , parentSchema: validate.schema"+e.schemaPath+" , data: "+f+" "),r+=" } "):r+=" {} ";var y=r;return r=g.pop(),!e.compositeRule&&d?e.async?r+=" throw new ValidationError(["+y+"]); ":r+=" validate.errors = ["+y+"]; return false; ":r+=" var err = "+y+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",r+="} ",d&&(r+=" else { "),r}});var tm=_((QD,em)=>{"use strict";em.exports=function(e,t,n){var r=" ",a=e.level,o=e.dataLevel,i=e.schema[t],c=e.schemaPath+e.util.getProperty(t),u=e.errSchemaPath+"/"+t,d=!e.opts.allErrors,f="data"+(o||""),h="errs__"+a,p=e.util.copy(e);p.level++;var g="valid"+p.level;if(e.opts.strictKeywords?typeof i=="object"&&Object.keys(i).length>0||i===!1:e.util.schemaHasRules(i,e.RULES.all)){p.schema=i,p.schemaPath=c,p.errSchemaPath=u,r+=" var "+h+" = errors;  ";var y=e.compositeRule;e.compositeRule=p.compositeRule=!0,p.createErrors=!1;var v;p.opts.allErrors&&(v=p.opts.allErrors,p.opts.allErrors=!1),r+=" "+e.validate(p)+" ",p.createErrors=!0,v&&(p.opts.allErrors=v),e.compositeRule=p.compositeRule=y,r+=" if ("+g+") {   ";var w=w||[];w.push(r),r="",e.createErrors!==!1?(r+=" { keyword: 'not' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(u)+" , params: {} ",e.opts.messages!==!1&&(r+=" , message: 'should NOT be valid' "),e.opts.verbose&&(r+=" , schema: validate.schema"+c+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+f+" "),r+=" } "):r+=" {} ";var C=r;r=w.pop(),!e.compositeRule&&d?e.async?r+=" throw new ValidationError(["+C+"]); ":r+=" validate.errors = ["+C+"]; return false; ":r+=" var err = "+C+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",r+=" } else {  errors = "+h+"; if (vErrors !== null) { if ("+h+") vErrors.length = "+h+"; else vErrors = null; } ",e.opts.allErrors&&(r+=" } ")}else r+="  var err =   ",e.createErrors!==!1?(r+=" { keyword: 'not' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(u)+" , params: {} ",e.opts.messages!==!1&&(r+=" , message: 'should NOT be valid' "),e.opts.verbose&&(r+=" , schema: validate.schema"+c+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+f+" "),r+=" } "):r+=" {} ",r+=";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",d&&(r+=" if (false) { ");return r}});var sm=_((XD,rm)=>{"use strict";rm.exports=function(e,t,n){var r=" ",a=e.level,o=e.dataLevel,i=e.schema[t],c=e.schemaPath+e.util.getProperty(t),u=e.errSchemaPath+"/"+t,d=!e.opts.allErrors,f="data"+(o||""),h="valid"+a,p="errs__"+a,g=e.util.copy(e),y="";g.level++;var v="valid"+g.level,w=g.baseId,C="prevValid"+a,E="passingSchemas"+a;r+="var "+p+" = errors , "+C+" = false , "+h+" = false , "+E+" = null; ";var R=e.compositeRule;e.compositeRule=g.compositeRule=!0;var A=i;if(A)for(var D,j=-1,V=A.length-1;j<V;)D=A[j+=1],(e.opts.strictKeywords?typeof D=="object"&&Object.keys(D).length>0||D===!1:e.util.schemaHasRules(D,e.RULES.all))?(g.schema=D,g.schemaPath=c+"["+j+"]",g.errSchemaPath=u+"/"+j,r+="  "+e.validate(g)+" ",g.baseId=w):r+=" var "+v+" = true; ",j&&(r+=" if ("+v+" && "+C+") { "+h+" = false; "+E+" = ["+E+", "+j+"]; } else { ",y+="}"),r+=" if ("+v+") { "+h+" = "+C+" = true; "+E+" = "+j+"; }";return e.compositeRule=g.compositeRule=R,r+=""+y+"if (!"+h+") {   var err =   ",e.createErrors!==!1?(r+=" { keyword: 'oneOf' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(u)+" , params: { passingSchemas: "+E+" } ",e.opts.messages!==!1&&(r+=" , message: 'should match exactly one schema in oneOf' "),e.opts.verbose&&(r+=" , schema: validate.schema"+c+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+f+" "),r+=" } "):r+=" {} ",r+=";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",!e.compositeRule&&d&&(e.async?r+=" throw new ValidationError(vErrors); ":r+=" validate.errors = vErrors; return false; "),r+="} else {  errors = "+p+"; if (vErrors !== null) { if ("+p+") vErrors.length = "+p+"; else vErrors = null; }",e.opts.allErrors&&(r+=" } "),r}});var am=_((YD,nm)=>{"use strict";nm.exports=function(e,t,n){var r=" ",a=e.level,o=e.dataLevel,i=e.schema[t],c=e.schemaPath+e.util.getProperty(t),u=e.errSchemaPath+"/"+t,d=!e.opts.allErrors,f="data"+(o||""),h=e.opts.$data&&i&&i.$data,p;h?(r+=" var schema"+a+" = "+e.util.getData(i.$data,o,e.dataPathArr)+"; ",p="schema"+a):p=i;var g=h?"(new RegExp("+p+"))":e.usePattern(i);r+="if ( ",h&&(r+=" ("+p+" !== undefined && typeof "+p+" != 'string') || "),r+=" !"+g+".test("+f+") ) {   ";var y=y||[];y.push(r),r="",e.createErrors!==!1?(r+=" { keyword: 'pattern' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(u)+" , params: { pattern:  ",h?r+=""+p:r+=""+e.util.toQuotedString(i),r+="  } ",e.opts.messages!==!1&&(r+=` , message: 'should match pattern "`,h?r+="' + "+p+" + '":r+=""+e.util.escapeQuotes(i),r+=`"' `),e.opts.verbose&&(r+=" , schema:  ",h?r+="validate.schema"+c:r+=""+e.util.toQuotedString(i),r+="         , parentSchema: validate.schema"+e.schemaPath+" , data: "+f+" "),r+=" } "):r+=" {} ";var v=r;return r=y.pop(),!e.compositeRule&&d?e.async?r+=" throw new ValidationError(["+v+"]); ":r+=" validate.errors = ["+v+"]; return false; ":r+=" var err = "+v+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",r+="} ",d&&(r+=" else { "),r}});var im=_((e1,om)=>{"use strict";om.exports=function(e,t,n){var r=" ",a=e.level,o=e.dataLevel,i=e.schema[t],c=e.schemaPath+e.util.getProperty(t),u=e.errSchemaPath+"/"+t,d=!e.opts.allErrors,f="data"+(o||""),h="errs__"+a,p=e.util.copy(e),g="";p.level++;var y="valid"+p.level,v="key"+a,w="idx"+a,C=p.dataLevel=e.dataLevel+1,E="data"+C,R="dataProperties"+a,A=Object.keys(i||{}).filter(J),D=e.schema.patternProperties||{},j=Object.keys(D).filter(J),V=e.schema.additionalProperties,$=A.length||j.length,B=V===!1,H=typeof V=="object"&&Object.keys(V).length,W=e.opts.removeAdditional,k=B||H||W,M=e.opts.ownProperties,N=e.baseId,K=e.schema.required;if(K&&!(e.opts.$data&&K.$data)&&K.length<e.opts.loopRequired)var L=e.util.toHash(K);function J(ht){return ht!=="__proto__"}if(r+="var "+h+" = errors;var "+y+" = true;",M&&(r+=" var "+R+" = undefined;"),k){if(M?r+=" "+R+" = "+R+" || Object.keys("+f+"); for (var "+w+"=0; "+w+"<"+R+".length; "+w+"++) { var "+v+" = "+R+"["+w+"]; ":r+=" for (var "+v+" in "+f+") { ",$){if(r+=" var isAdditional"+a+" = !(false ",A.length)if(A.length>8)r+=" || validate.schema"+c+".hasOwnProperty("+v+") ";else{var re=A;if(re)for(var Z,_e=-1,je=re.length-1;_e<je;)Z=re[_e+=1],r+=" || "+v+" == "+e.util.toQuotedString(Z)+" "}if(j.length){var Ve=j;if(Ve)for(var le,Ae=-1,Me=Ve.length-1;Ae<Me;)le=Ve[Ae+=1],r+=" || "+e.usePattern(le)+".test("+v+") "}r+=" ); if (isAdditional"+a+") { "}if(W=="all")r+=" delete "+f+"["+v+"]; ";else{var He=e.errorPath,jt="' + "+v+" + '";if(e.opts._errorDataPathProperty&&(e.errorPath=e.util.getPathExpr(e.errorPath,v,e.opts.jsonPointers)),B)if(W)r+=" delete "+f+"["+v+"]; ";else{r+=" "+y+" = false; ";var At=u;u=e.errSchemaPath+"/additionalProperties";var Ie=Ie||[];Ie.push(r),r="",e.createErrors!==!1?(r+=" { keyword: 'additionalProperties' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(u)+" , params: { additionalProperty: '"+jt+"' } ",e.opts.messages!==!1&&(r+=" , message: '",e.opts._errorDataPathProperty?r+="is an invalid additional property":r+="should NOT have additional properties",r+="' "),e.opts.verbose&&(r+=" , schema: false , parentSchema: validate.schema"+e.schemaPath+" , data: "+f+" "),r+=" } "):r+=" {} ";var Ee=r;r=Ie.pop(),!e.compositeRule&&d?e.async?r+=" throw new ValidationError(["+Ee+"]); ":r+=" validate.errors = ["+Ee+"]; return false; ":r+=" var err = "+Ee+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",u=At,d&&(r+=" break; ")}else if(H)if(W=="failing"){r+=" var "+h+" = errors;  ";var rr=e.compositeRule;e.compositeRule=p.compositeRule=!0,p.schema=V,p.schemaPath=e.schemaPath+".additionalProperties",p.errSchemaPath=e.errSchemaPath+"/additionalProperties",p.errorPath=e.opts._errorDataPathProperty?e.errorPath:e.util.getPathExpr(e.errorPath,v,e.opts.jsonPointers);var qe=f+"["+v+"]";p.dataPathArr[C]=v;var de=e.validate(p);p.baseId=N,e.util.varOccurences(de,E)<2?r+=" "+e.util.varReplace(de,E,qe)+" ":r+=" var "+E+" = "+qe+"; "+de+" ",r+=" if (!"+y+") { errors = "+h+"; if (validate.errors !== null) { if (errors) validate.errors.length = errors; else validate.errors = null; } delete "+f+"["+v+"]; }  ",e.compositeRule=p.compositeRule=rr}else{p.schema=V,p.schemaPath=e.schemaPath+".additionalProperties",p.errSchemaPath=e.errSchemaPath+"/additionalProperties",p.errorPath=e.opts._errorDataPathProperty?e.errorPath:e.util.getPathExpr(e.errorPath,v,e.opts.jsonPointers);var qe=f+"["+v+"]";p.dataPathArr[C]=v;var de=e.validate(p);p.baseId=N,e.util.varOccurences(de,E)<2?r+=" "+e.util.varReplace(de,E,qe)+" ":r+=" var "+E+" = "+qe+"; "+de+" ",d&&(r+=" if (!"+y+") break; ")}e.errorPath=He}$&&(r+=" } "),r+=" }  ",d&&(r+=" if ("+y+") { ",g+="}")}var qt=e.opts.useDefaults&&!e.compositeRule;if(A.length){var It=A;if(It)for(var Z,sr=-1,nr=It.length-1;sr<nr;){Z=It[sr+=1];var Ne=i[Z];if(e.opts.strictKeywords?typeof Ne=="object"&&Object.keys(Ne).length>0||Ne===!1:e.util.schemaHasRules(Ne,e.RULES.all)){var ot=e.util.getProperty(Z),qe=f+ot,Ke=qt&&Ne.default!==void 0;p.schema=Ne,p.schemaPath=c+ot,p.errSchemaPath=u+"/"+e.util.escapeFragment(Z),p.errorPath=e.util.getPath(e.errorPath,Z,e.opts.jsonPointers),p.dataPathArr[C]=e.util.toQuotedString(Z);var de=e.validate(p);if(p.baseId=N,e.util.varOccurences(de,E)<2){de=e.util.varReplace(de,E,qe);var Be=qe}else{var Be=E;r+=" var "+E+" = "+qe+"; "}if(Ke)r+=" "+de+" ";else{if(L&&L[Z]){r+=" if ( "+Be+" === undefined ",M&&(r+=" || ! Object.prototype.hasOwnProperty.call("+f+", '"+e.util.escapeQuotes(Z)+"') "),r+=") { "+y+" = false; ";var He=e.errorPath,At=u,xt=e.util.escapeQuotes(Z);e.opts._errorDataPathProperty&&(e.errorPath=e.util.getPath(He,Z,e.opts.jsonPointers)),u=e.errSchemaPath+"/required";var Ie=Ie||[];Ie.push(r),r="",e.createErrors!==!1?(r+=" { keyword: 'required' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(u)+" , params: { missingProperty: '"+xt+"' } ",e.opts.messages!==!1&&(r+=" , message: '",e.opts._errorDataPathProperty?r+="is a required property":r+="should have required property \\'"+xt+"\\'",r+="' "),e.opts.verbose&&(r+=" , schema: validate.schema"+c+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+f+" "),r+=" } "):r+=" {} ";var Ee=r;r=Ie.pop(),!e.compositeRule&&d?e.async?r+=" throw new ValidationError(["+Ee+"]); ":r+=" validate.errors = ["+Ee+"]; return false; ":r+=" var err = "+Ee+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",u=At,e.errorPath=He,r+=" } else { "}else d?(r+=" if ( "+Be+" === undefined ",M&&(r+=" || ! Object.prototype.hasOwnProperty.call("+f+", '"+e.util.escapeQuotes(Z)+"') "),r+=") { "+y+" = true; } else { "):(r+=" if ("+Be+" !== undefined ",M&&(r+=" &&   Object.prototype.hasOwnProperty.call("+f+", '"+e.util.escapeQuotes(Z)+"') "),r+=" ) { ");r+=" "+de+" } "}}d&&(r+=" if ("+y+") { ",g+="}")}}if(j.length){var Ye=j;if(Ye)for(var le,rn=-1,Ja=Ye.length-1;rn<Ja;){le=Ye[rn+=1];var Ne=D[le];if(e.opts.strictKeywords?typeof Ne=="object"&&Object.keys(Ne).length>0||Ne===!1:e.util.schemaHasRules(Ne,e.RULES.all)){p.schema=Ne,p.schemaPath=e.schemaPath+".patternProperties"+e.util.getProperty(le),p.errSchemaPath=e.errSchemaPath+"/patternProperties/"+e.util.escapeFragment(le),M?r+=" "+R+" = "+R+" || Object.keys("+f+"); for (var "+w+"=0; "+w+"<"+R+".length; "+w+"++) { var "+v+" = "+R+"["+w+"]; ":r+=" for (var "+v+" in "+f+") { ",r+=" if ("+e.usePattern(le)+".test("+v+")) { ",p.errorPath=e.util.getPathExpr(e.errorPath,v,e.opts.jsonPointers);var qe=f+"["+v+"]";p.dataPathArr[C]=v;var de=e.validate(p);p.baseId=N,e.util.varOccurences(de,E)<2?r+=" "+e.util.varReplace(de,E,qe)+" ":r+=" var "+E+" = "+qe+"; "+de+" ",d&&(r+=" if (!"+y+") break; "),r+=" } ",d&&(r+=" else "+y+" = true; "),r+=" }  ",d&&(r+=" if ("+y+") { ",g+="}")}}}return d&&(r+=" "+g+" if ("+h+" == errors) {"),r}});var lm=_((t1,cm)=>{"use strict";cm.exports=function(e,t,n){var r=" ",a=e.level,o=e.dataLevel,i=e.schema[t],c=e.schemaPath+e.util.getProperty(t),u=e.errSchemaPath+"/"+t,d=!e.opts.allErrors,f="data"+(o||""),h="errs__"+a,p=e.util.copy(e),g="";p.level++;var y="valid"+p.level;if(r+="var "+h+" = errors;",e.opts.strictKeywords?typeof i=="object"&&Object.keys(i).length>0||i===!1:e.util.schemaHasRules(i,e.RULES.all)){p.schema=i,p.schemaPath=c,p.errSchemaPath=u;var v="key"+a,w="idx"+a,C="i"+a,E="' + "+v+" + '",R=p.dataLevel=e.dataLevel+1,A="data"+R,D="dataProperties"+a,j=e.opts.ownProperties,V=e.baseId;j&&(r+=" var "+D+" = undefined; "),j?r+=" "+D+" = "+D+" || Object.keys("+f+"); for (var "+w+"=0; "+w+"<"+D+".length; "+w+"++) { var "+v+" = "+D+"["+w+"]; ":r+=" for (var "+v+" in "+f+") { ",r+=" var startErrs"+a+" = errors; ";var $=v,B=e.compositeRule;e.compositeRule=p.compositeRule=!0;var H=e.validate(p);p.baseId=V,e.util.varOccurences(H,A)<2?r+=" "+e.util.varReplace(H,A,$)+" ":r+=" var "+A+" = "+$+"; "+H+" ",e.compositeRule=p.compositeRule=B,r+=" if (!"+y+") { for (var "+C+"=startErrs"+a+"; "+C+"<errors; "+C+"++) { vErrors["+C+"].propertyName = "+v+"; }   var err =   ",e.createErrors!==!1?(r+=" { keyword: 'propertyNames' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(u)+" , params: { propertyName: '"+E+"' } ",e.opts.messages!==!1&&(r+=" , message: 'property name \\'"+E+"\\' is invalid' "),e.opts.verbose&&(r+=" , schema: validate.schema"+c+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+f+" "),r+=" } "):r+=" {} ",r+=";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",!e.compositeRule&&d&&(e.async?r+=" throw new ValidationError(vErrors); ":r+=" validate.errors = vErrors; return false; "),d&&(r+=" break; "),r+=" } }"}return d&&(r+=" "+g+" if ("+h+" == errors) {"),r}});var dm=_((r1,um)=>{"use strict";um.exports=function(e,t,n){var r=" ",a=e.level,o=e.dataLevel,i=e.schema[t],c=e.schemaPath+e.util.getProperty(t),u=e.errSchemaPath+"/"+t,d=!e.opts.allErrors,f="data"+(o||""),h="valid"+a,p=e.opts.$data&&i&&i.$data,g;p?(r+=" var schema"+a+" = "+e.util.getData(i.$data,o,e.dataPathArr)+"; ",g="schema"+a):g=i;var y="schema"+a;if(!p)if(i.length<e.opts.loopRequired&&e.schema.properties&&Object.keys(e.schema.properties).length){var v=[],w=i;if(w)for(var C,E=-1,R=w.length-1;E<R;){C=w[E+=1];var A=e.schema.properties[C];A&&(e.opts.strictKeywords?typeof A=="object"&&Object.keys(A).length>0||A===!1:e.util.schemaHasRules(A,e.RULES.all))||(v[v.length]=C)}}else var v=i;if(p||v.length){var D=e.errorPath,j=p||v.length>=e.opts.loopRequired,V=e.opts.ownProperties;if(d)if(r+=" var missing"+a+"; ",j){p||(r+=" var "+y+" = validate.schema"+c+"; ");var $="i"+a,B="schema"+a+"["+$+"]",H="' + "+B+" + '";e.opts._errorDataPathProperty&&(e.errorPath=e.util.getPathExpr(D,B,e.opts.jsonPointers)),r+=" var "+h+" = true; ",p&&(r+=" if (schema"+a+" === undefined) "+h+" = true; else if (!Array.isArray(schema"+a+")) "+h+" = false; else {"),r+=" for (var "+$+" = 0; "+$+" < "+y+".length; "+$+"++) { "+h+" = "+f+"["+y+"["+$+"]] !== undefined ",V&&(r+=" &&   Object.prototype.hasOwnProperty.call("+f+", "+y+"["+$+"]) "),r+="; if (!"+h+") break; } ",p&&(r+="  }  "),r+="  if (!"+h+") {   ";var W=W||[];W.push(r),r="",e.createErrors!==!1?(r+=" { keyword: 'required' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(u)+" , params: { missingProperty: '"+H+"' } ",e.opts.messages!==!1&&(r+=" , message: '",e.opts._errorDataPathProperty?r+="is a required property":r+="should have required property \\'"+H+"\\'",r+="' "),e.opts.verbose&&(r+=" , schema: validate.schema"+c+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+f+" "),r+=" } "):r+=" {} ";var k=r;r=W.pop(),!e.compositeRule&&d?e.async?r+=" throw new ValidationError(["+k+"]); ":r+=" validate.errors = ["+k+"]; return false; ":r+=" var err = "+k+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",r+=" } else { "}else{r+=" if ( ";var M=v;if(M)for(var N,$=-1,K=M.length-1;$<K;){N=M[$+=1],$&&(r+=" || ");var L=e.util.getProperty(N),J=f+L;r+=" ( ( "+J+" === undefined ",V&&(r+=" || ! Object.prototype.hasOwnProperty.call("+f+", '"+e.util.escapeQuotes(N)+"') "),r+=") && (missing"+a+" = "+e.util.toQuotedString(e.opts.jsonPointers?N:L)+") ) "}r+=") {  ";var B="missing"+a,H="' + "+B+" + '";e.opts._errorDataPathProperty&&(e.errorPath=e.opts.jsonPointers?e.util.getPathExpr(D,B,!0):D+" + "+B);var W=W||[];W.push(r),r="",e.createErrors!==!1?(r+=" { keyword: 'required' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(u)+" , params: { missingProperty: '"+H+"' } ",e.opts.messages!==!1&&(r+=" , message: '",e.opts._errorDataPathProperty?r+="is a required property":r+="should have required property \\'"+H+"\\'",r+="' "),e.opts.verbose&&(r+=" , schema: validate.schema"+c+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+f+" "),r+=" } "):r+=" {} ";var k=r;r=W.pop(),!e.compositeRule&&d?e.async?r+=" throw new ValidationError(["+k+"]); ":r+=" validate.errors = ["+k+"]; return false; ":r+=" var err = "+k+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",r+=" } else { "}else if(j){p||(r+=" var "+y+" = validate.schema"+c+"; ");var $="i"+a,B="schema"+a+"["+$+"]",H="' + "+B+" + '";e.opts._errorDataPathProperty&&(e.errorPath=e.util.getPathExpr(D,B,e.opts.jsonPointers)),p&&(r+=" if ("+y+" && !Array.isArray("+y+")) {  var err =   ",e.createErrors!==!1?(r+=" { keyword: 'required' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(u)+" , params: { missingProperty: '"+H+"' } ",e.opts.messages!==!1&&(r+=" , message: '",e.opts._errorDataPathProperty?r+="is a required property":r+="should have required property \\'"+H+"\\'",r+="' "),e.opts.verbose&&(r+=" , schema: validate.schema"+c+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+f+" "),r+=" } "):r+=" {} ",r+=";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; } else if ("+y+" !== undefined) { "),r+=" for (var "+$+" = 0; "+$+" < "+y+".length; "+$+"++) { if ("+f+"["+y+"["+$+"]] === undefined ",V&&(r+=" || ! Object.prototype.hasOwnProperty.call("+f+", "+y+"["+$+"]) "),r+=") {  var err =   ",e.createErrors!==!1?(r+=" { keyword: 'required' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(u)+" , params: { missingProperty: '"+H+"' } ",e.opts.messages!==!1&&(r+=" , message: '",e.opts._errorDataPathProperty?r+="is a required property":r+="should have required property \\'"+H+"\\'",r+="' "),e.opts.verbose&&(r+=" , schema: validate.schema"+c+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+f+" "),r+=" } "):r+=" {} ",r+=";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; } } ",p&&(r+="  }  ")}else{var re=v;if(re)for(var N,Z=-1,_e=re.length-1;Z<_e;){N=re[Z+=1];var L=e.util.getProperty(N),H=e.util.escapeQuotes(N),J=f+L;e.opts._errorDataPathProperty&&(e.errorPath=e.util.getPath(D,N,e.opts.jsonPointers)),r+=" if ( "+J+" === undefined ",V&&(r+=" || ! Object.prototype.hasOwnProperty.call("+f+", '"+e.util.escapeQuotes(N)+"') "),r+=") {  var err =   ",e.createErrors!==!1?(r+=" { keyword: 'required' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(u)+" , params: { missingProperty: '"+H+"' } ",e.opts.messages!==!1&&(r+=" , message: '",e.opts._errorDataPathProperty?r+="is a required property":r+="should have required property \\'"+H+"\\'",r+="' "),e.opts.verbose&&(r+=" , schema: validate.schema"+c+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+f+" "),r+=" } "):r+=" {} ",r+=";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; } "}}e.errorPath=D}else d&&(r+=" if (true) {");return r}});var fm=_((s1,pm)=>{"use strict";pm.exports=function(e,t,n){var r=" ",a=e.level,o=e.dataLevel,i=e.schema[t],c=e.schemaPath+e.util.getProperty(t),u=e.errSchemaPath+"/"+t,d=!e.opts.allErrors,f="data"+(o||""),h="valid"+a,p=e.opts.$data&&i&&i.$data,g;if(p?(r+=" var schema"+a+" = "+e.util.getData(i.$data,o,e.dataPathArr)+"; ",g="schema"+a):g=i,(i||p)&&e.opts.uniqueItems!==!1){p&&(r+=" var "+h+"; if ("+g+" === false || "+g+" === undefined) "+h+" = true; else if (typeof "+g+" != 'boolean') "+h+" = false; else { "),r+=" var i = "+f+".length , "+h+" = true , j; if (i > 1) { ";var y=e.schema.items&&e.schema.items.type,v=Array.isArray(y);if(!y||y=="object"||y=="array"||v&&(y.indexOf("object")>=0||y.indexOf("array")>=0))r+=" outer: for (;i--;) { for (j = i; j--;) { if (equal("+f+"[i], "+f+"[j])) { "+h+" = false; break outer; } } } ";else{r+=" var itemIndices = {}, item; for (;i--;) { var item = "+f+"[i]; ";var w="checkDataType"+(v?"s":"");r+=" if ("+e.util[w](y,"item",e.opts.strictNumbers,!0)+") continue; ",v&&(r+=` if (typeof item == 'string') item = '"' + item; `),r+=" if (typeof itemIndices[item] == 'number') { "+h+" = false; j = itemIndices[item]; break; } itemIndices[item] = i; } "}r+=" } ",p&&(r+="  }  "),r+=" if (!"+h+") {   ";var C=C||[];C.push(r),r="",e.createErrors!==!1?(r+=" { keyword: 'uniqueItems' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(u)+" , params: { i: i, j: j } ",e.opts.messages!==!1&&(r+=" , message: 'should NOT have duplicate items (items ## ' + j + ' and ' + i + ' are identical)' "),e.opts.verbose&&(r+=" , schema:  ",p?r+="validate.schema"+c:r+=""+i,r+="         , parentSchema: validate.schema"+e.schemaPath+" , data: "+f+" "),r+=" } "):r+=" {} ";var E=r;r=C.pop(),!e.compositeRule&&d?e.async?r+=" throw new ValidationError(["+E+"]); ":r+=" validate.errors = ["+E+"]; return false; ":r+=" var err = "+E+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",r+=" } ",d&&(r+=" else { ")}else d&&(r+=" if (true) { ");return r}});var mm=_((n1,hm)=>{"use strict";hm.exports={$ref:Rh(),allOf:Ah(),anyOf:kh(),$comment:Dh(),const:Mh(),contains:Nh(),dependencies:jh(),enum:Uh(),format:Vh(),if:Bh(),items:Gh(),maximum:xi(),minimum:xi(),maxItems:wi(),minItems:wi(),maxLength:Pi(),minLength:Pi(),maxProperties:Si(),minProperties:Si(),multipleOf:Yh(),not:tm(),oneOf:sm(),pattern:am(),properties:im(),propertyNames:lm(),required:dm(),uniqueItems:fm(),validate:yi()}});var ym=_((a1,vm)=>{"use strict";var gm=mm(),_i=Dr().toHash;vm.exports=function(){var e=[{type:"number",rules:[{maximum:["exclusiveMaximum"]},{minimum:["exclusiveMinimum"]},"multipleOf","format"]},{type:"string",rules:["maxLength","minLength","pattern","format"]},{type:"array",rules:["maxItems","minItems","items","contains","uniqueItems"]},{type:"object",rules:["maxProperties","minProperties","required","dependencies","propertyNames",{properties:["additionalProperties","patternProperties"]}]},{rules:["$ref","const","enum","not","anyOf","oneOf","allOf","if"]}],t=["type","$comment"],n=["$schema","$id","id","$data","$async","title","description","default","definitions","examples","readOnly","writeOnly","contentMediaType","contentEncoding","additionalItems","then","else"],r=["number","integer","string","array","object","boolean","null"];return e.all=_i(t),e.types=_i(r),e.forEach(function(a){a.rules=a.rules.map(function(o){var i;if(typeof o=="object"){var c=Object.keys(o)[0];i=o[c],o=c,i.forEach(function(d){t.push(d),e.all[d]=!0})}t.push(o);var u=e.all[o]={keyword:o,code:gm[o],implements:i};return u}),e.all.$comment={keyword:"$comment",code:gm.$comment},a.type&&(e.types[a.type]=a)}),e.keywords=_i(t.concat(n)),e.custom={},e}});var wm=_((o1,xm)=>{"use strict";var bm=["multipleOf","maximum","exclusiveMaximum","minimum","exclusiveMinimum","maxLength","minLength","pattern","additionalItems","maxItems","minItems","uniqueItems","maxProperties","minProperties","required","additionalProperties","enum","format","const"];xm.exports=function(s,e){for(var t=0;t<e.length;t++){s=JSON.parse(JSON.stringify(s));var n=e[t].split("/"),r=s,a;for(a=1;a<n.length;a++)r=r[n[a]];for(a=0;a<bm.length;a++){var o=bm[a],i=r[o];i&&(r[o]={anyOf:[i,{$ref:"https://raw.githubusercontent.com/ajv-validator/ajv/master/lib/refs/data.json#"}]})}}return s}});var _m=_((i1,Sm)=>{"use strict";var PC=wa().MissingRef;Sm.exports=Pm;function Pm(s,e,t){var n=this;if(typeof this._opts.loadSchema!="function")throw new Error("options.loadSchema should be a function");typeof e=="function"&&(t=e,e=void 0);var r=a(s).then(function(){var i=n._addSchema(s,void 0,e);return i.validate||o(i)});return t&&r.then(function(i){t(null,i)},t),r;function a(i){var c=i.$schema;return c&&!n.getSchema(c)?Pm.call(n,{$ref:c},!0):Promise.resolve()}function o(i){try{return n._compile(i)}catch(u){if(u instanceof PC)return c(u);throw u}function c(u){var d=u.missingSchema;if(p(d))throw new Error("Schema "+d+" is loaded but "+u.missingRef+" cannot be resolved");var f=n._loadingSchemas[d];return f||(f=n._loadingSchemas[d]=n._opts.loadSchema(d),f.then(h,h)),f.then(function(g){if(!p(d))return a(g).then(function(){p(d)||n.addSchema(g,d,void 0,e)})}).then(function(){return o(i)});function h(){delete n._loadingSchemas[d]}function p(g){return n._refs[g]||n._schemas[g]}}}}});var Cm=_((c1,Em)=>{"use strict";Em.exports=function(e,t,n){var r=" ",a=e.level,o=e.dataLevel,i=e.schema[t],c=e.schemaPath+e.util.getProperty(t),u=e.errSchemaPath+"/"+t,d=!e.opts.allErrors,f,h="data"+(o||""),p="valid"+a,g="errs__"+a,y=e.opts.$data&&i&&i.$data,v;y?(r+=" var schema"+a+" = "+e.util.getData(i.$data,o,e.dataPathArr)+"; ",v="schema"+a):v=i;var w=this,C="definition"+a,E=w.definition,R="",A,D,j,V,$;if(y&&E.$data){$="keywordValidate"+a;var B=E.validateSchema;r+=" var "+C+" = RULES.custom['"+t+"'].definition; var "+$+" = "+C+".validate;"}else{if(V=e.useCustomRule(w,i,e.schema,e),!V)return;v="validate.schema"+c,$=V.code,A=E.compile,D=E.inline,j=E.macro}var H=$+".errors",W="i"+a,k="ruleErr"+a,M=E.async;if(M&&!e.async)throw new Error("async keyword in sync schema");if(D||j||(r+=""+H+" = null;"),r+="var "+g+" = errors;var "+p+";",y&&E.$data&&(R+="}",r+=" if ("+v+" === undefined) { "+p+" = true; } else { ",B&&(R+="}",r+=" "+p+" = "+C+".validateSchema("+v+"); if ("+p+") { ")),D)E.statements?r+=" "+V.validate+" ":r+=" "+p+" = "+V.validate+"; ";else if(j){var N=e.util.copy(e),R="";N.level++;var K="valid"+N.level;N.schema=V.validate,N.schemaPath="";var L=e.compositeRule;e.compositeRule=N.compositeRule=!0;var J=e.validate(N).replace(/validate\.schema/g,$);e.compositeRule=N.compositeRule=L,r+=" "+J}else{var re=re||[];re.push(r),r="",r+="  "+$+".call( ",e.opts.passContext?r+="this":r+="self",A||E.schema===!1?r+=" , "+h+" ":r+=" , "+v+" , "+h+" , validate.schema"+e.schemaPath+" ",r+=" , (dataPath || '')",e.errorPath!='""'&&(r+=" + "+e.errorPath);var Z=o?"data"+(o-1||""):"parentData",_e=o?e.dataPathArr[o]:"parentDataProperty";r+=" , "+Z+" , "+_e+" , rootData )  ";var je=r;r=re.pop(),E.errors===!1?(r+=" "+p+" = ",M&&(r+="await "),r+=""+je+"; "):M?(H="customErrors"+a,r+=" var "+H+" = null; try { "+p+" = await "+je+"; } catch (e) { "+p+" = false; if (e instanceof ValidationError) "+H+" = e.errors; else throw e; } "):r+=" "+H+" = null; "+p+" = "+je+"; "}if(E.modifying&&(r+=" if ("+Z+") "+h+" = "+Z+"["+_e+"];"),r+=""+R,E.valid)d&&(r+=" if (true) { ");else{r+=" if ( ",E.valid===void 0?(r+=" !",j?r+=""+K:r+=""+p):r+=" "+!E.valid+" ",r+=") { ",f=w.keyword;var re=re||[];re.push(r),r="";var re=re||[];re.push(r),r="",e.createErrors!==!1?(r+=" { keyword: '"+(f||"custom")+"' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(u)+" , params: { keyword: '"+w.keyword+"' } ",e.opts.messages!==!1&&(r+=` , message: 'should pass "`+w.keyword+`" keyword validation' `),e.opts.verbose&&(r+=" , schema: validate.schema"+c+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+h+" "),r+=" } "):r+=" {} ";var Ve=r;r=re.pop(),!e.compositeRule&&d?e.async?r+=" throw new ValidationError(["+Ve+"]); ":r+=" validate.errors = ["+Ve+"]; return false; ":r+=" var err = "+Ve+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ";var le=r;r=re.pop(),D?E.errors?E.errors!="full"&&(r+="  for (var "+W+"="+g+"; "+W+"<errors; "+W+"++) { var "+k+" = vErrors["+W+"]; if ("+k+".dataPath === undefined) "+k+".dataPath = (dataPath || '') + "+e.errorPath+"; if ("+k+".schemaPath === undefined) { "+k+'.schemaPath = "'+u+'"; } ',e.opts.verbose&&(r+=" "+k+".schema = "+v+"; "+k+".data = "+h+"; "),r+=" } "):E.errors===!1?r+=" "+le+" ":(r+=" if ("+g+" == errors) { "+le+" } else {  for (var "+W+"="+g+"; "+W+"<errors; "+W+"++) { var "+k+" = vErrors["+W+"]; if ("+k+".dataPath === undefined) "+k+".dataPath = (dataPath || '') + "+e.errorPath+"; if ("+k+".schemaPath === undefined) { "+k+'.schemaPath = "'+u+'"; } ',e.opts.verbose&&(r+=" "+k+".schema = "+v+"; "+k+".data = "+h+"; "),r+=" } } "):j?(r+="   var err =   ",e.createErrors!==!1?(r+=" { keyword: '"+(f||"custom")+"' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(u)+" , params: { keyword: '"+w.keyword+"' } ",e.opts.messages!==!1&&(r+=` , message: 'should pass "`+w.keyword+`" keyword validation' `),e.opts.verbose&&(r+=" , schema: validate.schema"+c+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+h+" "),r+=" } "):r+=" {} ",r+=";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",!e.compositeRule&&d&&(e.async?r+=" throw new ValidationError(vErrors); ":r+=" validate.errors = vErrors; return false; ")):E.errors===!1?r+=" "+le+" ":(r+=" if (Array.isArray("+H+")) { if (vErrors === null) vErrors = "+H+"; else vErrors = vErrors.concat("+H+"); errors = vErrors.length;  for (var "+W+"="+g+"; "+W+"<errors; "+W+"++) { var "+k+" = vErrors["+W+"]; if ("+k+".dataPath === undefined) "+k+".dataPath = (dataPath || '') + "+e.errorPath+";  "+k+'.schemaPath = "'+u+'";  ',e.opts.verbose&&(r+=" "+k+".schema = "+v+"; "+k+".data = "+h+"; "),r+=" } } else { "+le+" } "),r+=" } ",d&&(r+=" else { ")}return r}});var Ei=_((l1,SC)=>{SC.exports={$schema:"http://json-schema.org/draft-07/schema#",$id:"http://json-schema.org/draft-07/schema#",title:"Core schema meta-schema",definitions:{schemaArray:{type:"array",minItems:1,items:{$ref:"#"}},nonNegativeInteger:{type:"integer",minimum:0},nonNegativeIntegerDefault0:{allOf:[{$ref:"#/definitions/nonNegativeInteger"},{default:0}]},simpleTypes:{enum:["array","boolean","integer","null","number","object","string"]},stringArray:{type:"array",items:{type:"string"},uniqueItems:!0,default:[]}},type:["object","boolean"],properties:{$id:{type:"string",format:"uri-reference"},$schema:{type:"string",format:"uri"},$ref:{type:"string",format:"uri-reference"},$comment:{type:"string"},title:{type:"string"},description:{type:"string"},default:!0,readOnly:{type:"boolean",default:!1},examples:{type:"array",items:!0},multipleOf:{type:"number",exclusiveMinimum:0},maximum:{type:"number"},exclusiveMaximum:{type:"number"},minimum:{type:"number"},exclusiveMinimum:{type:"number"},maxLength:{$ref:"#/definitions/nonNegativeInteger"},minLength:{$ref:"#/definitions/nonNegativeIntegerDefault0"},pattern:{type:"string",format:"regex"},additionalItems:{$ref:"#"},items:{anyOf:[{$ref:"#"},{$ref:"#/definitions/schemaArray"}],default:!0},maxItems:{$ref:"#/definitions/nonNegativeInteger"},minItems:{$ref:"#/definitions/nonNegativeIntegerDefault0"},uniqueItems:{type:"boolean",default:!1},contains:{$ref:"#"},maxProperties:{$ref:"#/definitions/nonNegativeInteger"},minProperties:{$ref:"#/definitions/nonNegativeIntegerDefault0"},required:{$ref:"#/definitions/stringArray"},additionalProperties:{$ref:"#"},definitions:{type:"object",additionalProperties:{$ref:"#"},default:{}},properties:{type:"object",additionalProperties:{$ref:"#"},default:{}},patternProperties:{type:"object",additionalProperties:{$ref:"#"},propertyNames:{format:"regex"},default:{}},dependencies:{type:"object",additionalProperties:{anyOf:[{$ref:"#"},{$ref:"#/definitions/stringArray"}]}},propertyNames:{$ref:"#"},const:!0,enum:{type:"array",items:!0,minItems:1,uniqueItems:!0},type:{anyOf:[{$ref:"#/definitions/simpleTypes"},{type:"array",items:{$ref:"#/definitions/simpleTypes"},minItems:1,uniqueItems:!0}]},format:{type:"string"},contentMediaType:{type:"string"},contentEncoding:{type:"string"},if:{$ref:"#"},then:{$ref:"#"},else:{$ref:"#"},allOf:{$ref:"#/definitions/schemaArray"},anyOf:{$ref:"#/definitions/schemaArray"},oneOf:{$ref:"#/definitions/schemaArray"},not:{$ref:"#"}},default:!0}});var Am=_((u1,Tm)=>{"use strict";var Rm=Ei();Tm.exports={$id:"https://github.com/ajv-validator/ajv/blob/master/lib/definition_schema.js",definitions:{simpleTypes:Rm.definitions.simpleTypes},type:"object",dependencies:{schema:["validate"],$data:["validate"],statements:["inline"],valid:{not:{required:["macro"]}}},properties:{type:Rm.properties.type,schema:{type:"boolean"},statements:{type:"boolean"},dependencies:{type:"array",items:{type:"string"}},metaSchema:{type:"object"},modifying:{type:"boolean"},valid:{type:"boolean"},$data:{type:"boolean"},async:{type:"boolean"},errors:{anyOf:[{type:"boolean"},{const:"full"}]}}}});var km=_((d1,Im)=>{"use strict";var _C=/^[a-z_$][a-z0-9_$-]*$/i,EC=Cm(),CC=Am();Im.exports={add:RC,get:TC,remove:AC,validate:Ci};function RC(s,e){var t=this.RULES;if(t.keywords[s])throw new Error("Keyword "+s+" is already defined");if(!_C.test(s))throw new Error("Keyword "+s+" is not a valid identifier");if(e){this.validateKeyword(e,!0);var n=e.type;if(Array.isArray(n))for(var r=0;r<n.length;r++)o(s,n[r],e);else o(s,n,e);var a=e.metaSchema;a&&(e.$data&&this._opts.$data&&(a={anyOf:[a,{$ref:"https://raw.githubusercontent.com/ajv-validator/ajv/master/lib/refs/data.json#"}]}),e.validateSchema=this.compile(a,!0))}t.keywords[s]=t.all[s]=!0;function o(i,c,u){for(var d,f=0;f<t.length;f++){var h=t[f];if(h.type==c){d=h;break}}d||(d={type:c,rules:[]},t.push(d));var p={keyword:i,definition:u,custom:!0,code:EC,implements:u.implements};d.rules.push(p),t.custom[i]=p}return this}function TC(s){var e=this.RULES.custom[s];return e?e.definition:this.RULES.keywords[s]||!1}function AC(s){var e=this.RULES;delete e.keywords[s],delete e.all[s],delete e.custom[s];for(var t=0;t<e.length;t++)for(var n=e[t].rules,r=0;r<n.length;r++)if(n[r].keyword==s){n.splice(r,1);break}return this}function Ci(s,e){Ci.errors=null;var t=this._validateKeyword=this._validateKeyword||this.compile(CC,!0);if(t(s))return!0;if(Ci.errors=t.errors,e)throw new Error("custom keyword definition is invalid: "+this.errorsText(t.errors));return!1}});var Om=_((p1,IC)=>{IC.exports={$schema:"http://json-schema.org/draft-07/schema#",$id:"https://raw.githubusercontent.com/ajv-validator/ajv/master/lib/refs/data.json#",description:"Meta-schema for $data reference (JSON Schema extension proposal)",type:"object",required:["$data"],properties:{$data:{type:"string",anyOf:[{format:"relative-json-pointer"},{format:"json-pointer"}]}},additionalProperties:!1}});var Wm=_((f1,Um)=>{"use strict";var $m=dh(),$r=xa(),kC=fh(),Mm=di(),OC=vi(),DC=Eh(),$C=ym(),Lm=wm(),Nm=Dr();Um.exports=Ce;Ce.prototype.validate=LC;Ce.prototype.compile=NC;Ce.prototype.addSchema=FC;Ce.prototype.addMetaSchema=jC;Ce.prototype.validateSchema=qC;Ce.prototype.getSchema=WC;Ce.prototype.removeSchema=HC;Ce.prototype.addFormat=XC;Ce.prototype.errorsText=QC;Ce.prototype._addSchema=BC;Ce.prototype._compile=zC;Ce.prototype.compileAsync=_m();var Aa=km();Ce.prototype.addKeyword=Aa.add;Ce.prototype.getKeyword=Aa.get;Ce.prototype.removeKeyword=Aa.remove;Ce.prototype.validateKeyword=Aa.validate;var Fm=wa();Ce.ValidationError=Fm.Validation;Ce.MissingRefError=Fm.MissingRef;Ce.$dataMetaSchema=Lm;var Ta="http://json-schema.org/draft-07/schema",Dm=["removeAdditional","useDefaults","coerceTypes","strictDefaults"],MC=["/properties"];function Ce(s){if(!(this instanceof Ce))return new Ce(s);s=this._opts=Nm.copy(s)||{},nR(this),this._schemas={},this._refs={},this._fragments={},this._formats=DC(s.format),this._cache=s.cache||new kC,this._loadingSchemas={},this._compilations=[],this.RULES=$C(),this._getId=GC(s),s.loopRequired=s.loopRequired||1/0,s.errorDataPath=="property"&&(s._errorDataPathProperty=!0),s.serialize===void 0&&(s.serialize=OC),this._metaOpts=sR(this),s.formats&&tR(this),s.keywords&&rR(this),YC(this),typeof s.meta=="object"&&this.addMetaSchema(s.meta),s.nullable&&this.addKeyword("nullable",{metaSchema:{type:"boolean"}}),eR(this)}function LC(s,e){var t;if(typeof s=="string"){if(t=this.getSchema(s),!t)throw new Error('no schema with key or ref "'+s+'"')}else{var n=this._addSchema(s);t=n.validate||this._compile(n)}var r=t(e);return t.$async!==!0&&(this.errors=t.errors),r}function NC(s,e){var t=this._addSchema(s,void 0,e);return t.validate||this._compile(t)}function FC(s,e,t,n){if(Array.isArray(s)){for(var r=0;r<s.length;r++)this.addSchema(s[r],void 0,t,n);return this}var a=this._getId(s);if(a!==void 0&&typeof a!="string")throw new Error("schema id must be string");return e=$r.normalizeId(e||a),qm(this,e),this._schemas[e]=this._addSchema(s,t,n,!0),this}function jC(s,e,t){return this.addSchema(s,e,t,!0),this}function qC(s,e){var t=s.$schema;if(t!==void 0&&typeof t!="string")throw new Error("$schema must be a string");if(t=t||this._opts.defaultMeta||UC(this),!t)return this.logger.warn("meta-schema not available"),this.errors=null,!0;var n=this.validate(t,s);if(!n&&e){var r="schema is invalid: "+this.errorsText();if(this._opts.validateSchema=="log")this.logger.error(r);else throw new Error(r)}return n}function UC(s){var e=s._opts.meta;return s._opts.defaultMeta=typeof e=="object"?s._getId(e)||e:s.getSchema(Ta)?Ta:void 0,s._opts.defaultMeta}function WC(s){var e=jm(this,s);switch(typeof e){case"object":return e.validate||this._compile(e);case"string":return this.getSchema(e);case"undefined":return VC(this,s)}}function VC(s,e){var t=$r.schema.call(s,{schema:{}},e);if(t){var n=t.schema,r=t.root,a=t.baseId,o=$m.call(s,n,r,void 0,a);return s._fragments[e]=new Mm({ref:e,fragment:!0,schema:n,root:r,baseId:a,validate:o}),o}}function jm(s,e){return e=$r.normalizeId(e),s._schemas[e]||s._refs[e]||s._fragments[e]}function HC(s){if(s instanceof RegExp)return Ra(this,this._schemas,s),Ra(this,this._refs,s),this;switch(typeof s){case"undefined":return Ra(this,this._schemas),Ra(this,this._refs),this._cache.clear(),this;case"string":var e=jm(this,s);return e&&this._cache.del(e.cacheKey),delete this._schemas[s],delete this._refs[s],this;case"object":var t=this._opts.serialize,n=t?t(s):s;this._cache.del(n);var r=this._getId(s);r&&(r=$r.normalizeId(r),delete this._schemas[r],delete this._refs[r])}return this}function Ra(s,e,t){for(var n in e){var r=e[n];!r.meta&&(!t||t.test(n))&&(s._cache.del(r.cacheKey),delete e[n])}}function BC(s,e,t,n){if(typeof s!="object"&&typeof s!="boolean")throw new Error("schema should be object or boolean");var r=this._opts.serialize,a=r?r(s):s,o=this._cache.get(a);if(o)return o;n=n||this._opts.addUsedSchema!==!1;var i=$r.normalizeId(this._getId(s));i&&n&&qm(this,i);var c=this._opts.validateSchema!==!1&&!e,u;c&&!(u=i&&i==$r.normalizeId(s.$schema))&&this.validateSchema(s,!0);var d=$r.ids.call(this,s),f=new Mm({id:i,schema:s,localRefs:d,cacheKey:a,meta:t});return i[0]!="#"&&n&&(this._refs[i]=f),this._cache.put(a,f),c&&u&&this.validateSchema(s,!0),f}function zC(s,e){if(s.compiling)return s.validate=r,r.schema=s.schema,r.errors=null,r.root=e||r,s.schema.$async===!0&&(r.$async=!0),r;s.compiling=!0;var t;s.meta&&(t=this._opts,this._opts=this._metaOpts);var n;try{n=$m.call(this,s.schema,e,s.localRefs)}catch(a){throw delete s.validate,a}finally{s.compiling=!1,s.meta&&(this._opts=t)}return s.validate=n,s.refs=n.refs,s.refVal=n.refVal,s.root=n.root,n;function r(){var a=s.validate,o=a.apply(this,arguments);return r.errors=a.errors,o}}function GC(s){switch(s.schemaId){case"auto":return JC;case"id":return KC;default:return ZC}}function KC(s){return s.$id&&this.logger.warn("schema $id ignored",s.$id),s.id}function ZC(s){return s.id&&this.logger.warn("schema id ignored",s.id),s.$id}function JC(s){if(s.$id&&s.id&&s.$id!=s.id)throw new Error("schema $id is different from id");return s.$id||s.id}function QC(s,e){if(s=s||this.errors,!s)return"No errors";e=e||{};for(var t=e.separator===void 0?", ":e.separator,n=e.dataVar===void 0?"data":e.dataVar,r="",a=0;a<s.length;a++){var o=s[a];o&&(r+=n+o.dataPath+" "+o.message+t)}return r.slice(0,-t.length)}function XC(s,e){return typeof e=="string"&&(e=new RegExp(e)),this._formats[s]=e,this}function YC(s){var e;if(s._opts.$data&&(e=Om(),s.addMetaSchema(e,e.$id,!0)),s._opts.meta!==!1){var t=Ei();s._opts.$data&&(t=Lm(t,MC)),s.addMetaSchema(t,Ta,!0),s._refs["http://json-schema.org/schema"]=Ta}}function eR(s){var e=s._opts.schemas;if(e)if(Array.isArray(e))s.addSchema(e);else for(var t in e)s.addSchema(e[t],t)}function tR(s){for(var e in s._opts.formats){var t=s._opts.formats[e];s.addFormat(e,t)}}function rR(s){for(var e in s._opts.keywords){var t=s._opts.keywords[e];s.addKeyword(e,t)}}function qm(s,e){if(s._schemas[e]||s._refs[e])throw new Error('schema with key or id "'+e+'" already exists')}function sR(s){for(var e=Nm.copy(s._opts),t=0;t<Dm.length;t++)delete e[Dm[t]];return e}function nR(s){var e=s._opts.logger;if(e===!1)s.logger={log:Ri,warn:Ri,error:Ri};else{if(e===void 0&&(e=console),!(typeof e=="object"&&e.log&&e.warn&&e.error))throw new Error("logger must implement log, warn and error methods");s.logger=e}}function Ri(){}});function Ig(s){return Object.prototype.hasOwnProperty.call(Ba,s)?s:null}var Tg,ms,Ba,Ag,kg,Og,Xs,Dg,$g,Mg,Lg,Ng,Mr=ne(()=>{"use strict";Tg=require("crypto"),ms=G(require("vscode")),Ba={content:{category:"queryGet",version:1},ping:{category:"queryGet",version:1},selections:{category:"queryGet",version:1},reload:{category:"queryGet",version:1},markForReload:{category:"queryPost",version:1},removeHighlights:{category:"mutationPost",version:1},highlightLines:{category:"mutationPost",version:1},highlight:{category:"mutationPost",version:1},setContent:{category:"mutationPost",version:1},replaceSelection:{category:"mutationPost",version:1}},Ag=Object.fromEntries(Object.entries(Ba).map(([s,e])=>[s,e.version]));kg=`oai_pwai ${ms.env.appName}`,Og=ms.workspace.name??ms.env.appName,Xs=ms.env.appName+"-"+(0,Tg.randomUUID)(),Dg="com.microsoft.VSCode",$g="com.microsoft.VSCodeInsiders",Mg="com.vscodium",Lg="com.todesktop.230313mzl4w4u92",Ng="com.exafunction.windsurf"});function Yt(s){return Mi().find(n=>n.document.fileName===s)||null}function jg(){return Mi().map((e,t)=>{let n=e.selection.isEmpty?null:e.document.getText(e.selection),r=e.selection.isEmpty?null:e.selection.start.line;return n!=null&&r!=null?{selectedText:n,selectionLine:r}:null}).filter(e=>!!e)}function qg(){return Mi().map((e,t)=>{let n=e.document.getText(),r=e.document.fileName,a=e.selection.isEmpty?null:e.document.getText(e.selection),o=e.document.offsetAt(e.selection.start),i=e.document.offsetAt(e.selection.end),c=e.selection.isEmpty?null:e.selection.start.line,u=e.selection.isEmpty?null:{location:o,length:i-o};return a===n&&(a=null),{id:r,content:n,filename:r,selectedText:a,selectionRange:u,selectionLine:c}}).filter(e=>!!e)}function Mi(){return Fg.window.visibleTextEditors.filter(e=>e.viewColumn!==void 0)}var Fg,za=ne(()=>{"use strict";Fg=G(require("vscode"))});function er(s){throw new Error(`No editor for id ${s} found`)}var Li=ne(()=>{"use strict"});async function Ug(s,e){let t=Yt(e);t||er(e);let n=t.document,r=new gs.Range(n.positionAt(0),n.positionAt(n.getText().length));await t.edit(o=>{o.replace(r,s)});let a=t.document.positionAt(s.length);t.selection=new gs.Selection(a,a)}async function Wg(s,e){let t=Yt(e);t||er(e);let n=t.selection,r=new gs.Range(n.start,n.end);await t.edit(a=>{a.replace(r,s)}),t.selection=new gs.Selection(r.start,r.start)}var gs,Vg=ne(()=>{"use strict";za();Li();gs=G(require("vscode"))});async function Bg(s,e){let t=Yt(e);t||er(e);let n=s.map(r=>{let a=new at.Range(r,0,r,t.document.lineAt(r).range.end.character);return zg(a,e)});await Promise.all(n)}function xR(s){return new Promise(e=>setTimeout(e,s))}async function zg(s,e){let t=Yt(e);t||er(e),t.revealRange(s,at.TextEditorRevealType.InCenterIfOutsideViewport);let n=at.window.createTextEditorDecorationType({backgroundColor:`rgba(255, 255, 0, ${Hg})`,isWholeLine:!0});t.setDecorations(n,[s]);let r=at.workspace.onDidChangeTextDocument(a=>{a.document===t.document&&(n.dispose(),Lr[e]=[],r.dispose())});Lr[e]||(Lr[e]=[]),Lr[e].push({range:s,decoration:n})}async function Gg(s,e){let t=Yt(s);t||er(s),Ys[s]||(Ys[s]=1);let n=++Ys[s];if(e){let o=(Lr[s]||[]).map(async i=>{let c=i.decoration,u=10,f=500/u;try{for(let h=0;h<=u&&n===Ys[s];h++){let p=h/u,g=Hg*(1-p),y=at.window.createTextEditorDecorationType({backgroundColor:`rgba(255, 255, 0, ${g})`,isWholeLine:!0});t.setDecorations(y,[i.range]),c?.dispose(),c=y,await xR(f)}}finally{c?.dispose()}});await Promise.all(o)}let r=Lr[s];r&&n===Ys[s]&&(r.forEach(a=>a.decoration.dispose()),delete Lr[s])}async function Kg(s,e,t){let n=Yt(t);n||er(t);let r=wR(s,e,n.document);r&&await zg(r,t)}function wR(s,e,t){let n=0,r=0,a=0,o=0,i=0;for(let c=0;c<t.lineCount;c++){let d=t.lineAt(c).text.length+1;if(n<=s&&n+d>s&&(r=c,o=s-n),n<=e&&n+d>e){a=c,i=e-n;break}n+=d}if(r>=0&&a>=0){let c=new at.Position(r,o),u=new at.Position(a,i);return new at.Range(c,u)}return null}var at,Lr,Ys,Hg,Zg=ne(()=>{"use strict";za();Li();at=G(require("vscode")),Lr={},Ys={},Hg=.2});async function Xg(s,e){switch(s){case"removeHighlights":try{let{textfieldID:t,animated:n}=e;return await Gg(t,n),{status:"success",message:"Removed highlight"}}catch(t){return{status:400,error:JSON.stringify(t)}}case"highlightLines":try{let{lines:t,textfieldID:n}=e;return await Bg(t,n),{status:"success",message:"Text highlighted successfully"}}catch(t){return{status:400,error:JSON.stringify(t)}}case"highlight":try{let{startChar:t,endChar:n,textfieldID:r}=e;return await Kg(t,n,r),{status:"success",message:"Text highlighted successfully"}}catch(t){return{status:400,error:JSON.stringify(t)}}case"setContent":try{let{content:t,textfieldID:n}=e;return await Ug(t,n),{status:"success",message:"Set content successfully"}}catch(t){return{status:400,error:JSON.stringify(t)}}case"replaceSelection":try{let{content:t,textfieldID:n}=e;return await Wg(t,n),{status:"success",message:"Replaced selection successfully"}}catch(t){return{status:400,error:JSON.stringify(t)}}}}var Yg=ne(()=>{"use strict";Mr();Vg();Zg()});async function ev(s,e){let t=Buffer.alloc(0),n=null;s.on("data",async r=>{if(t=Buffer.concat([t,r]),n==null&&t.length>=4&&(n=t.readUInt32LE(0),t=t.subarray(4)),n!=null&&t.length>=n){let a=t.subarray(0,n).toString();t=t.subarray(n),n=null,await e(s,a)}}),s.on("end",()=>{Ue.debug("Desktop bridge: client disconnected")}),s.on("error",r=>{Ue.error("Desktop bridge socket error:",r)})}function en(s,e){let t=JSON.stringify(e),n=Buffer.alloc(4),r=Buffer.byteLength(t);n.writeUInt32LE(r,0);let a=Buffer.from(t,"utf-8");s.write(n),s.write(a),s.end()}var Ni=ne(()=>{"use strict";Pe()});function Fi(){return Ka.join(rv.homedir(),"Library","Application Support","com.openai.chat","app_pairing_extensions",Xs)}function SR(s){let e=Fi();if($e.existsSync(e)){let t=$e.watch(e,n=>{$e.existsSync(e)||(s(),t.close())})}else Ue.warn("Desktop bridge: session path does not exist, cannot watch file.")}var $e,tv,rv,Ka,Ga,sv=ne(()=>{"use strict";Pe();Mr();Ni();$e=G(require("fs")),tv=G(require("net")),rv=G(require("os")),Ka=G(require("path"));Ga=class{getSessionSocketPath(){return`/tmp/${Xs}.sock`}async deregister(){let e=Fi();Ue.info("Desktop bridge deregister",e),$e.existsSync(e)&&$e.unlinkSync(e),$e.existsSync(this.getSessionSocketPath())&&$e.unlinkSync(this.getSessionSocketPath())}async register(e,t){let n=Fi(),r=Ka.dirname(n);$e.existsSync(r)||$e.mkdirSync(r,{recursive:!0}),$e.writeFileSync(n,JSON.stringify(e),"utf8"),Ue.info(`Desktop bridge wrote payload to ${n}`);let a=this.getSessionSocketPath();$e.existsSync(a)?$e.chmodSync(a,384):Ue.warn("Desktop bridge: socket file does not exist"),SR(t)}startServer(e,t){let n=this.getSessionSocketPath();$e.existsSync(n)&&$e.unlinkSync(n);let r=tv.createServer(a=>{Ue.debug("Desktop bridge: client connected"),ev(a,t)});r.listen(n,()=>{Ue.info(`Desktop bridge listening on UNIX socket: ${n}`)}),e.subscriptions.push({dispose:()=>{r.close(),this.deregister()}})}}});function _R(){if(nv.platform()!=="darwin")throw new Error("Unsupported platform");return new Ga}var nv,Nr,ji=ne(()=>{"use strict";sv();nv=G(require("os"));Nr=_R()});function ov(){switch(av.env.appName){case"Visual Studio Code":return Dg;case"Visual Studio Code - Insiders":return $g;case"VSCodium":return Mg;case"Cursor":return Lg;case"Windsurf":return Ng;default:return null}}var av,iv=ne(()=>{"use strict";Mr();av=G(require("vscode"))});var ER,tn,qi=ne(()=>{"use strict";ER="0.0.1731016154",tn={name:"openai.chatgpt",version:ER,isInstalled:!0}});function lv(s){cv=s,Nr.deregister(),Za()}function Za(){let s=ov();if(!s)return;let e=Nr.getSessionSocketPath(),t={appName:tr.env.appName,bundleID:s,extensionVersion:tn.version,marketplaceID:tn.name,extensionName:kg,workspaceName:Og,id:Xs,capabilities:Ag,needsReload:cv,socketPath:e,timestamp:Date.now()};Nr.register(t,()=>{let n=tr.l10n.t("Reregister"),r=tr.l10n.t("Dismiss");tr.window.showWarningMessage(tr.l10n.t("The ChatGPT extension cannot find its registration file"),n,r).then(a=>{a===n&&Za()})})}var tr,cv,Ui=ne(()=>{"use strict";iv();Mr();ji();qi();tr=G(require("vscode")),cv=!1});function dv(s){switch(s){case"ping":{let{name:e,version:t}=tn;return{status:"success",version:t,name:e}}case"content":{let e=qg();return e!=null?{status:"success",textfields:e}:{status:400,error:"No active editor found"}}case"selections":{let e=jg();return e!=null?{status:"success",selections:e}:{status:400,error:"No active editor found"}}case"reload":return uv.commands.executeCommand("workbench.action.reloadWindow"),{status:"success"}}}async function pv(s){switch(s){case"markForReload":return lv(!0),{status:"success",message:"Marked for reload"}}}var uv,fv=ne(()=>{"use strict";Mr();za();Ui();qi();uv=G(require("vscode"))});var vv={};eo(vv,{activate:()=>RR,deactivate:()=>TR,respondToCompleteMessage:()=>gv});function RR(s){CR==="darwin"&&(Ue.info("ChatGPT desktop bridge active"),Nr.startServer(s,gv),Za(),Ue.info("Desktop bridge registered"))}function TR(){Nr.deregister()}async function gv(s,e){try{let t=JSON.parse(e),n=Ig(t.command);if(!n){en(s,{status:404,error:"Unknown endpoint"});return}if(!mv.workspace.isTrusted&&n!=="ping"){Ue.warn("Desktop bridge: untrusted workspace"),en(s,{status:405,error:"The workspace must be trusted for the extension to read content."});return}let r=await AR(n,t.payload);r.status===400&&Ue.error("Desktop bridge error for command:",t.command),en(s,r)}catch(t){Ue.error("Desktop bridge: error processing message:",t),en(s,{success:!1,error:"Error handling message"})}}async function AR(s,e){let{category:t}=Ba[s];switch(t){case"queryGet":return dv(s);case"queryPost":return pv(s);case"mutationPost":return Xg(s,e)}}var hv,mv,CR,yv=ne(()=>{"use strict";Mr();Yg();ji();fv();Ui();Ni();Pe();hv=G(require("os")),mv=G(require("vscode")),CR=hv.platform()});var MR={};eo(MR,{activate:()=>DR});module.exports=Vv(MR);var tc=G(require("path")),cn=G(require("vscode"));function rc(s){let e=cn.window.activeTextEditor;if(!e)return;let t=e.document.uri;if(t.scheme!=="file")return;let n=e.selection.start.line+1,r=e.selection.end.line+1;e.selection.end.character===0&&e.selection.end.line>e.selection.start.line&&r--;let a=t.fsPath,o=tc.basename(a),i=n!=null?`${o}:${n}`+(r!=null&&r!==n?`:${r}`:""):o;s.addContextFile({label:i,path:cn.workspace.asRelativePath(a),fsPath:a,startLine:n,endLine:r})}var sc=require("crypto"),to=class s{constructor(e){this.mcpConnection=e;let t=this.mcpConnection.registerProvider(s.providerName,{onNotification:n=>this.handleNotification(n),onResult:n=>this.handleResult(n)});this.disposables.push(t)}static providerName="auth";disposables=[];pending=new Map;async getToken({refreshToken:e}){let t=(0,sc.randomUUID)(),n=new Promise((r,a)=>{this.pending.set(t,{resolve:r,reject:a})});return this.mcpConnection.sendRequest(s.providerName,t,"getAuthStatus",{includeToken:!0,refreshToken:e}),n}resolve(e,t){let n=this.pending.get(e);n&&(this.pending.delete(e),n.resolve(t))}reject(e,t){let n=this.pending.get(e);n&&(this.pending.delete(e),n.reject(t))}handleResult(e){if(typeof e.id!="string")return;if(e.error){this.reject(e.id,e.error);return}let t=e.result??null;this.resolve(e.id,t?.authToken??null)}handleNotification(e){e.method==="codex/event/auth_status_change"&&this.getToken({refreshToken:!1})}dispose(){for(let e of this.disposables)e.dispose();this.disposables.length=0,this.pending.clear()}};function nc(s){return new to(s)}var ac=G(require("vscode")),Br="openai-codex",oc="route";function ln(s){let{scheme:e,authority:t,path:n}=s;if(e!==Br)return null;if(t!==oc)return null;let a=(n.startsWith("/")?n.slice(1):n).split("/"),o=null;return a.length>=2&&(a[0]==="local"||a[0]==="remote")&&(o=a[1]),{path:s.fsPath,conversationId:o}}function un(s){return ro(`/local/${s}`)}function ro(s){return ac.Uri.file(s).with({scheme:Br,authority:oc})}var Jd=G(Dd());Ze();var dr=G(require("vscode")),Kd="codex.chatSessionProvider",pS="codex.chatSessionObserver",So="Codex Agent",Zd=80;var vn=class{constructor(e,t,n,r){this.modelProxyManager=t;this.conversationSummaryProvider=n;this.conversationLoader=new _o(e),this.subscriptions.push(t.onDidChangeIsCopilotApiAvailable(()=>{this.onDidChangeChatSessionItemsEmitter.fire()})),this.subscriptions.push(r.onDidUpdateEntry(({key:a})=>{a===rt.USE_COPILOT_AUTH_IF_AVAILABLE&&this.onDidChangeChatSessionItemsEmitter.fire()})),this.subscriptions.push(e.registerProvider(pS,{onNotification:this.handleMcpNotification.bind(this)})),this.seedPendingConversationsFromTabs(),this.subscriptions.push(this.onDidChangeChatSessionItemsEmitter,this.onDidCommitChatSessionItemEmitter)}subscriptions=[];onDidChangeChatSessionItemsEmitter=new dr.EventEmitter;onDidChangeChatSessionItems=this.onDidChangeChatSessionItemsEmitter.event;onDidCommitChatSessionItemEmitter=new dr.EventEmitter;onDidCommitChatSessionItem=this.onDidCommitChatSessionItemEmitter.event;conversationLoader;lifecycleByConversationId=new Map;pendingConversations=new Map;modelProviderByConversationId=new Map;async provideChatSessionItems(e){let t=this.modelProxyManager.isUserUsingCopilotInference();function n(c){return t?c===ur:c!==ur}let r=await this.conversationLoader.provideChatSessionItems(t,e),a=[];for(let{item:c,summary:u}of r)this.pendingConversations.delete(c.id),this.modelProviderByConversationId.set(c.id,u.modelProvider),n(u.modelProvider)&&a.push(c);let o=a.map(c=>this.applyLifecycleToChatSessionItem(c));return Array.from(this.pendingConversations.values()).filter(c=>n(c.modelProvider)).map(c=>this.applyLifecycleToChatSessionItem(c.item)).concat(o)}registerPendingConversation(e,t){let{conversationId:n,resource:r,label:a,startedAt:o,modelProvider:i}=e;if(t?.onlyIfMissing&&this.pendingConversations.has(n))return;let c=t?.markInProgress??!0,d=Qd(a??So),f=o??(c?Date.now():void 0),h={id:n,resource:r,label:d};h.status=c?2:1,f!=null&&(h.timing={startTime:f});let g=this.pendingConversations.get(n)?.item;(!g||g.label!==h.label||g.status!==h.status||g.resource?.toString()!==h.resource?.toString()||!(0,Jd.default)(g.timing,h.timing))&&(this.pendingConversations.set(e.conversationId,{item:h,modelProvider:i}),this.modelProviderByConversationId.set(e.conversationId,i),c?this.updateConversationStatus(e.conversationId,2,{startTimeHint:f}):this.onDidChangeChatSessionItemsEmitter.fire())}clearPendingConversation(e){this.pendingConversations.delete(e)&&this.onDidChangeChatSessionItemsEmitter.fire()}handleMcpNotification(e){let t=this.extractConversationId(e.params);if(t)switch(e.method){case"codex/event/task_started":this.updateConversationStatus(t,2);break;case"codex/event/task_complete":this.updateConversationStatus(t,1);break;case"codex/event/turn_aborted":case"codex/event/error":case"codex/event/stream_error":this.updateConversationStatus(t,0);break;default:break}}extractConversationId(e){if(!e||typeof e!="object")return null;let t=e.conversationId;return typeof t=="string"?t:null}updateConversationStatus(e,t,n){let r=this.lifecycleByConversationId.get(e),a=Date.now(),o=r?.startTime??n?.startTimeHint;t===2&&(o=n?.startTimeHint??r?.startTime??a);let i;(t===1||t===0)&&(i=r?.endTime??a,o||(o=r?.startTime??n?.startTimeHint??i));let c={status:t,startTime:o,endTime:i},u=!r||r.status!==c.status||r.startTime!==c.startTime||r.endTime!==c.endTime;this.lifecycleByConversationId.set(e,c),u&&this.onDidChangeChatSessionItemsEmitter.fire()}applyLifecycleToChatSessionItem(e,t){let n=t??this.lifecycleByConversationId.get(e.id),r={...e,timing:e.timing?{...e.timing}:void 0};if(!n)return r;r.status=n.status;let a=this.mergeTiming(r.timing,n);return a?r.timing=a:delete r.timing,r}mergeTiming(e,t){let n=t.startTime??e?.startTime,a=t.status===1||t.status===0?t.endTime??e?.endTime:void 0;return n==null&&a==null?e:a!=null?{startTime:n??a,endTime:a}:{startTime:n??Date.now()}}seedPendingConversationsFromTabs(){for(let e of dr.window.tabGroups.all)for(let t of e.tabs)this.trackTabIfNeeded(t)}async trackTabIfNeeded(e){let t=e.input;if(!(t instanceof dr.TabInputCustom))return;let n=ln(t.uri);if(n){if(n.conversationId==null)return}else return;let r=await this.conversationSummaryProvider.getConversationSummary(n.conversationId),a=Date.now(),{preview:o,modelProvider:i}=r.summary,c=o??So;this.registerPendingConversation({conversationId:n.conversationId,resource:t.uri,label:c,startedAt:a,modelProvider:i},{markInProgress:!1,onlyIfMissing:!0})}dispose(){this.subscriptions.forEach(e=>e.dispose())}},_o=class{constructor(e){this.codexAppServer=e;let t={onResult:this.onAppServerResult.bind(this)};e.registerProvider(Kd,t)}nextRequestId=0;requestToCallback=new Map;onAppServerResult(e){let t=this.requestToCallback.get(e.id);t&&(this.requestToCallback.delete(e.id),t(e))}async provideChatSessionItems(e,t){return(await this.requestListConversations(e)).items.map(r=>({summary:r,item:this.toChatSessionItem(r)}))}toChatSessionItem(e){let{conversationId:t,preview:n,timestamp:r}=e,a=un(t),o=Qd(n),i=r!=null?{startTime:new Date(r).getTime()}:void 0;return{id:String(t),resource:a,label:o,timing:i}}requestListConversations(e){let t=String(this.nextRequestId++),n=new Promise((r,a)=>{this.requestToCallback.set(t,o=>{if(o.error){a(new Error(o.error.message));return}if(o.result==null){a(new Error("No result in response"));return}r(o.result)})});return this.codexAppServer.sendRequest(Kd,t,"listConversations",{pageSize:50,cursor:null,modelProviders:e?[ur]:null}),n}};function Qd(s){let e=s.replace(/\s+/g," ").trim();return e.length===0?So:e.length<=Zd?e:`${e.slice(0,Zd-1).trimEnd()}\u2026`}Ut();Ze();var hS="http://localhost:8000/api",mS="https://chatgpt.com/backend-api";function gS(){switch(ze(De.API_ENDPOINT)){case"localhost":return hS;case"production":case void 0:default:return mS}}function Eo(s){return s.startsWith("data:")||s.startsWith("http")?s:`${gS()}/${s.replace(/^\//,"")}`}Pe();function OS(s){let e=s.split(/\r?\n/),t,n=[];for(let a of e)a.startsWith("event:")?t=a.slice(6).trim():a.startsWith("data:")&&n.push(a.slice(5).trim());if(n.length===0)return null;let r=n.join(`
`);try{return{event:t,data:JSON.parse(r)}}catch{return null}}function DS(s){let e=s.indexOf(`\r
\r
`),t=s.indexOf(`

`);return e===-1&&t===-1?[-1,0]:e===-1?[t,2]:t===-1?[e,4]:e<t?[e,4]:[t,2]}function $S(s,e){return{async next(){if(e.aborted)return{done:!0,value:void 0};let{value:t,done:n}=await s.read();return n||t==null?{done:!0,value:void 0}:{done:!1,value:t}},[Symbol.asyncIterator](){return this}}}async function*xp(s,e){let t=s.getReader(),n=new TextDecoder,r="",a=$S(t,e);try{for await(let o of a){r+=n.decode(o,{stream:!0});let i,c;for(;[i,c]=DS(r),i>=0;){let u=r.slice(0,i);r=r.slice(i+c);let d=OS(u);!d||d.event==="heartbeat"||(yield d)}}}finally{t.releaseLock()}}function wp(s){return!!s&&typeof s=="object"&&s.name==="AbortError"}function Ns(s){return new Promise(e=>setTimeout(e,s))}Re();var rs="codex_vscode",Pp="vscode://codex/",ts=3,MS=300,LS=2e3,Cn=class{constructor(e,t,n){this.authProvider=e;this.extensionFetchHandler=t;this.userAgentProvider=n}abortSignals=new Map;streamControllers=new Map;shouldRetryStatus(e){return e===408||e===425||e===429||e>=500&&e<=599}backoffDelay(e){let t=Math.min(LS,MS*2**e),n=t*.2*(Math.random()-.5)*2;return Math.max(0,Math.floor(t+n))}buildHeaders(e,t,n){let r={...e??{}},a=i=>Object.keys(r).some(c=>c.toLowerCase()===i);if(n.attachAuth&&t&&!a("authorization")){r.Authorization=`Bearer ${t}`;try{let i=JSON.parse(Buffer.from(t.split(".")[1],"base64url").toString("utf8"))["https://api.openai.com/auth"]?.chatgpt_account_id;i&&(r["ChatGPT-Account-Id"]=i)}catch{}}n.method!=="GET"&&!a("content-type")&&(r["Content-Type"]="application/json"),a("originator")||(r.originator=rs);let o=this.userAgentProvider.getUserAgent();return o&&!a("user-agent")&&(r["User-Agent"]=o),r}shouldAttachAuth(e){let n=new URL(e).host.toLowerCase();return n==="localhost:8000"||n==="localhost"||n.endsWith(".openai.com")||n==="openai.com"||n==="chatgpt.com"||n.endsWith(".chatgpt.com")&&!n.startsWith("ab.")}async fetch(e){try{let t=new AbortController;if(this.abortSignals.set(e.requestId,t),t.signal.addEventListener("abort",()=>({type:"fetch-response",responseType:"error",error:"Request cancelled",requestId:e.requestId,status:499})),e.url.startsWith(Pp)){let i=await this.extensionFetchHandler.handleVSCodeRequest(e.url.slice(Pp.length),e.body?JSON.parse(e.body):void 0);return{type:"fetch-response",responseType:"success",requestId:e.requestId,status:200,headers:{},bodyJsonString:JSON.stringify(i)}}let n=Eo(e.url),r=await this.authProvider.getToken({refreshToken:!1}),a=this.shouldAttachAuth(n),o=async(i,c)=>{if(a&&!NS(c))return{type:"fetch-response",responseType:"error",requestId:e.requestId,status:401,error:`Cannot fetch ${e.url} without ChatGPT auth.`};let u=this.buildHeaders(e.headers,c,{method:e.method,attachAuth:a}),d=Object.keys(u).some(f=>f.toLowerCase()==="authorization");try{let f=e.body,h=Object.keys(u).find(v=>v.toLowerCase()==="x-codex-base64");if(h&&u[h]==="1"){if(e.body)try{f=Buffer.from(e.body,"base64")}catch{f=e.body}delete u[h]}let g=await fetch(n,{method:e.method,headers:u,body:f,signal:t.signal});if(g.status>=200&&g.status<300){let v=g.headers.get("content-type")||"",w;if(v.includes("application/json")){let E=await g.json();w=JSON.stringify(E)}else{let E=await g.arrayBuffer(),R=Buffer.from(E).toString("base64");w=JSON.stringify({base64:R,contentType:v})}this.abortSignals.delete(e.requestId);let C={};return g.headers.forEach((E,R)=>{R!=="authorization"&&(C[R]=E)}),{type:"fetch-response",responseType:"success",requestId:e.requestId,status:g.status,headers:C,bodyJsonString:w}}if(g.status===401&&d&&i<ts){let v=await this.authProvider.getToken({refreshToken:!0});if(v&&v!==c)return o(i+1,v)}if(this.shouldRetryStatus(g.status)&&i<ts){let v=this.backoffDelay(i);return await Ns(v),o(i+1,c)}let y=g.headers.get("cf-ray");return g.status===404?T().info(`Error fetching ${e.url}: ${g.status} ${g.statusText} (${y})`):T().error(`Error fetching ${e.url}: ${g.status} ${g.statusText} (${y})`),{type:"fetch-response",responseType:"error",requestId:e.requestId,status:g.status,error:g.statusText}}catch(f){if(t.signal.aborted)return{type:"fetch-response",responseType:"error",error:"Request cancelled",requestId:e.requestId,status:499};if(i<ts){let h=this.backoffDelay(i);return await Ns(h),o(i+1,c)}return T().error(`Error fetching ${e.url}: ${String(f)}`),{type:"fetch-response",responseType:"error",requestId:e.requestId,status:500,error:f instanceof Error?f.message:"Unknown error"}}};return o(0,r)}catch(t){return T().error(`Error fetching ${e.url}: ${t}`),{type:"fetch-response",responseType:"error",requestId:e.requestId,status:500,error:t instanceof Error?t.message:"Unknown error"}}finally{this.abortSignals.delete(e.requestId)}}async stream(e,t){let n=new AbortController;this.streamControllers.set(e.requestId,n);let r=Eo(e.url),a=await this.authProvider.getToken({refreshToken:!1}),o=this.shouldAttachAuth(r),i=async(c,u)=>{let d=this.buildHeaders(e.headers,u,{method:e.method,attachAuth:o}),f=Object.keys(d).some(h=>h.toLowerCase()==="authorization");try{let h=await fetch(r,{method:e.method,headers:d,body:e.body,signal:n.signal});if(h.status===200&&h.body!=null){for await(let p of xp(h.body,n.signal))t({type:"fetch-stream-event",requestId:e.requestId,event:p.event,data:p.data});t({type:"fetch-stream-complete",requestId:e.requestId});return}if(h.status===401&&f&&c<ts){let p=await this.authProvider.getToken({refreshToken:!0});if(p&&p!==u){await i(c+1,p);return}}if(this.shouldRetryStatus(h.status)&&c<ts){let p=this.backoffDelay(c);await Ns(p),await i(c+1,u);return}t({type:"fetch-stream-error",requestId:e.requestId,error:`${h.status} ${h.statusText}`})}catch(h){if(n.signal.aborted||wp(h)){t({type:"fetch-stream-complete",requestId:e.requestId});return}if(c<ts){let p=this.backoffDelay(c);await Ns(p),await i(c+1,u);return}t({type:"fetch-stream-error",requestId:e.requestId,error:h instanceof Error?h.message:"Unknown error"})}};try{await i(0,a)}finally{this.streamControllers.delete(e.requestId)}}cancel(e){let t=this.abortSignals.get(e);t&&(t.abort(),this.abortSignals.delete(e))}cancelStream(e){let t=this.streamControllers.get(e);t&&(t.abort(),this.streamControllers.delete(e))}};function NS(s){return s?/^[A-Za-z0-9-_]+\.[A-Za-z0-9-_]+\.[A-Za-z0-9-_]+$/.test(s):!1}Pe();Ut();bn();function ss(s){if(!0){let e,t,{arch:n}=process,{platform:r}=process;switch(s&&(r=s),r){case"win32":e="windows";break;case"darwin":e="macos";break;case"aix":case"android":case"freebsd":case"haiku":case"linux":case"openbsd":case"sunos":case"cygwin":case"netbsd":e="linux";break}switch(n){case"x64":t="x86_64";break;case"arm64":t="aarch64";break;case"arm":case"ia32":case"loong64":case"mips":case"mipsel":case"ppc":case"ppc64":case"riscv64":case"s390":case"s390x":throw new Error(`unrecognized architecture: ${n}`)}return`bin/${`${e}-${t}`}`}return"bin"}Pe();Ut();Pe();var _p=require("child_process");Ze();Re();var Ep=G(require("vscode")),FS=[{name:"PATHEXT",type:"list"},{name:"COMSPEC",type:"path"},{name:"SYSTEMROOT",type:"path"},"SYSTEMDRIVE","USERNAME","USERDOMAIN",{name:"USERPROFILE",type:"path"},{name:"PROGRAMFILES",type:"path"},{name:"PROGRAMFILES(X86)",type:"path"},{name:"PROGRAMW6432",type:"path"},{name:"PROGRAMDATA",type:"path"},{name:"LOCALAPPDATA",type:"path"},{name:"APPDATA",type:"path"},{name:"TEMP",type:"path"},{name:"TMP",type:"path"},"POWERSHELL","PWSH","HTTP_PROXY","HTTPS_PROXY","NO_PROXY","NODE_TLS_REJECT_UNAUTHORIZED"];function st(){return ze(De.RUN_CODEX_IN_WSL,!1)?Wt()!=null&&!Rn():!1}function Rn(){return Ep.env.remoteName==="wsl"}var Fs;function Wt(s){return process.platform!=="win32"?null:!s&&Fs!==void 0?(T().debug(`[detectHasWsl] cachedEligibleWslDistro: ${Fs}`),Fs):(Fs=jS(),Fs)}function jS(){try{Sp("wsl.exe",["--status"]);let s=Sp("wsl.exe",["--list","--quiet"]);return T().info(`[wsl] eligible distro list: ${s}`),s.split(`
`).find(t=>t.trim().toLowerCase().startsWith("ubuntu"))??null}catch(s){return T().error(`[wsl] error retrieving eligible distro: ${String(s)}`),null}}function Sp(s,e){try{T().debug(`[execWindowsCommand] executing ${s} ${e.join(" ")}`);let t=(0,_p.execFileSync)(s,e,{timeout:3e3,windowsHide:!0,encoding:"buffer",maxBuffer:1024*10});return qS(t)}catch(t){throw T().error(`[execWindowsCommand] command exception for ${s} ${e.join(" ")}: ${t}`),t}}function qS(s){let e;if(Buffer.isBuffer(s)){let t=s;if(t.length===0)return"";if(t.length>=2&&t[0]===255&&t[1]===254)e=t.slice(2).toString("utf16le");else if(t.length>=3&&t[0]===239&&t[1]===187&&t[2]===191)e=t.slice(3).toString("utf8");else{let n=Math.min(t.length-t.length%2,256),r=!1;if(n>0){let a=0,o=0;for(let i=0;i<n;i+=2)o++,t[i+1]===0&&a++;r=o>0&&a/o>.6}e=r?t.toString("utf16le"):t.toString("utf8")}}else e=s;return e.replace(/^\uFEFF/,"").replace(/\r\n/g,`
`).trim()}function _t(s){if(/^(\\\\|\/\/)(wsl\$|wsl\.localhost)/i.test(s)){let n=s.replace(/^((\\\\|\/\/)(wsl\$|wsl\.localhost)[\\/]+)/i,"").split(/[\\/]/);n.shift();let r=n.join("/").replace(/\\/g,"/");return r.length===0?"/":r.startsWith("/")?r:`/${r}`}if(s.startsWith("/"))return s;let e=s.match(/^([a-zA-Z]):[\\/](.*)$/);if(e){let t=e[1].toLowerCase(),n=e[2].replace(/\\/g,"/");return`/mnt/${t}/${n}`}return s.replace(/\\/g,"/")}function Cp(s){return To(s)}function Rp(s=FS){return s.map(e=>{if(typeof e=="string")return e;switch(e.type){case"path":return`${e.name}/p`;case"list":return`${e.name}/l`;case"unix-only":return`${e.name}/u`;case"windows-only":return`${e.name}/w`}}).filter(Boolean).join(":")}var Oo=require("child_process");Ze();Re();function US(s){return s===""?"''":/[^\w@%\-+=:,./]/.test(s)?("'"+s.replace(/('+)/g,`'"$1"'`)+"'").replace(/^''|''$/g,""):s}function Tp(s){if(!Array.isArray(s))throw new TypeError("args should be an array");return s.map(US).join(" ")}var hr=G(require("vscode")),mt=class extends Error{signal;exitCode;constructor(e,{signal:t,exitCode:n}={signal:null,exitCode:null},{cause:r}={}){super(`Codex process errored: ${e}`,{cause:r}),this.name="CodexProcessError",this.signal=t,this.exitCode=n}};function Ap(s,e,t){let n=process.platform==="win32",r=VS();if(st())return T().info("[spawnCodexProcess] spawning codex process inside WSL"),WS(s,e,r);let a=ss(),o=Tn(s),i=n?";":":",c=process.env.PATH+i+hr.Uri.joinPath(s,a).fsPath,u=[e];n&&t&&(T().info("[spawnCodexProcess] enabling experimental Windows sandbox"),u.push("--enable","enable_experimental_windows_sandbox"));let d=(0,Oo.spawn)(o,u,{stdio:["pipe","pipe","pipe"],env:{...process.env,...r,PATH:c,RUST_LOG:"warn",CODEX_INTERNAL_ORIGINATOR_OVERRIDE:rs}});if(d.pid==null)throw new mt(`Failed to spawn codex mcp process at ${o}`,{signal:null,exitCode:null});return d}function Tn(s,e){let t=ze(De.CLI_EXECUTABLE);if(t&&t.trim().length>0)return t;{let n=ss(e),r=(e??process.platform)==="win32"?"codex.exe":"codex";return hr.Uri.joinPath(s,`${n}/${r}`).fsPath}}function WS(s,e,t){let n=Wt();if(n==null)throw new Error("No eligible WSL distro found. Please install an Ubuntu-based WSL distribution and try again.");let r=ss("linux"),a=_t(Tn(s,"linux")),o=hr.Uri.joinPath(s,r).fsPath,i=_t(o),c=hr.workspace.workspaceFolders?.[0]?.uri.fsPath,u=c?_t(c):void 0,d=[`PATH=${i}:$PATH`,"RUST_LOG=warn",`CODEX_INTERNAL_ORIGINATOR_OVERRIDE=${rs}`],f=["-d",n];u&&f.push("--cd",u),f.push("--","/usr/bin/bash","-lc");let h=["/usr/bin/env",...d,a,e],p=Tp(h);f.push(p),T().info(`[codex app-server process] wsl command: wsl.exe ${f.join(" ")}`);let g=(0,Oo.spawn)("wsl.exe",f,{stdio:["pipe","pipe","pipe"],env:{...process.env,...t,WSLENV:Rp()}});if(g.pid==null)throw new Error(`Failed to spawn codex mcp process inside WSL: wsl ${f.join(" ")}`);return g}function VS(){let s=hr.workspace.getConfiguration("http"),e=s.get("proxy"),t=s.get("proxyStrictSSL"),n={};return e&&e.trim().length>0&&(n.HTTP_PROXY=e,n.HTTPS_PROXY=e),t===!1&&(n.NODE_TLS_REJECT_UNAUTHORIZED="0"),n}var kp=G(require("readline"));Re();var ns=G(require("vscode")),Ip="1",An=class{constructor(e,t,n){this.extensionUri=e;this.userAgentProvider=t;this.windowsSandboxEnabled=n;this.extensionUri=e}providers=new Map;initialized=!1;proc=null;rl=null;mostRecentErrorMessage=null;fatalError=null;startCodexProcess(){this.fatalError=null,this.proc&&this.isProcessAlive(this.proc)&&(T().info("[startCodexProcess] tearing down existing codex mcp process"),this.teardownProcess());let e;try{if(T().info("[startCodexProcess] spawning codex app-server"),e=Ap(this.extensionUri,"app-server",this.windowsSandboxEnabled),e.pid==null)return this.broadcastFatalError(new mt("Failed to start Codex process")),{success:!1,errorMessage:"Failed to spawn Codex process"}}catch(n){if(n instanceof mt)return this.broadcastFatalError(n),{success:!1,errorMessage:n.message};let r=n instanceof Error?n.message:String(n);return this.broadcastFatalError(new mt(`Failed to start Codex process: ${r}`)),{success:!1,errorMessage:r}}this.proc=e,this.initialized=!1,e.on("error",n=>{T().error(`Codex process error: ${n}`)}),e.on("exit",(n,r)=>{n!==0?this.broadcastFatalError(new mt(`Codex app-server process exited unexpectedly (code=${n}, signal=${r})`,{signal:r,exitCode:n})):T().info("codex app-server process exited successfully."),this.teardownProcess()}),e.stderr&&e.stderr.on("data",n=>{let r=HS(n.toString().trim());if(r){let{level:a,message:o}=BS(r),i="CLI:";switch(a){case"trace":case"debug":case"info":T().info(`${i} ${o}`);break;case"warn":T().warn(`${i} ${o}`);break;case"error":T().error(`${i} ${o}`),this.mostRecentErrorMessage=o;break}}});let t=kp.createInterface({input:e.stdout});this.rl=t,t.on("line",n=>{let r=n.trim(),a;try{a=JSON.parse(r)}catch(o){T().error(`unable to parse stdout from codex app-server: ${o}`);return}if(!this.initialized){if(T().info(`[CodexMcpConnection] initialize received: ${JSON.stringify(a)}`),"id"in a&&("result"in a||"error"in a)&&a.id===Ip){if("error"in a&&a.error){let o=new mt(`Failed to initialize local agent: ${JSON.stringify(a.error)}`);this.broadcastFatalError(o)}else{let o=a.result;this.userAgentProvider.setUserAgent(o.userAgent??rs),this.initialized=!0}return}T().warn(`Dropping MCP message received before initialization: ${r}`);return}this.routeIncomingMessage(a)});{let n={id:Ip,method:"initialize",params:{clientInfo:{name:zS(),title:"Codex Extension",version:Do()}}};e.stdin.destroyed?this.broadcastFatalError(new mt(`Attempted to send app-server initialize request but stdin is destroyed: ${JSON.stringify(n)}`)):e.stdin.write(JSON.stringify(n)+`
`)}return{success:!0}}teardownProcess(){this.rl&&(this.rl.removeAllListeners(),this.rl.close(),this.rl=null),this.proc&&(this.proc.removeAllListeners(),!this.proc.killed&&this.proc.exitCode==null&&this.proc.kill(),this.proc=null),this.initialized=!1}isProcessAlive(e){return e.killed||e.exitCode!=null||e.signalCode!=null?!1:!e.stdin.destroyed}registerProvider(e,t){if(this.providers.has(e))throw new Error(`Provider already registered: ${e}`);return this.providers.set(e,t),this.fatalError&&t.onFatalError?.(this.fatalError,this.mostRecentErrorMessage),new ns.Disposable(()=>{this.providers.delete(e)})}sendRequest(e,t,n,r){let o={id:`${e}:${t}`,method:n,params:r};this.sendMessage(o)}sendNotification(e,t){let n={method:e,params:t};this.sendMessage(n)}sendResponse(e,t){let n={id:e,result:t};this.sendMessage(n)}sendMessage(e){this.proc&&!this.proc.stdin.destroyed?this.proc.stdin.write(JSON.stringify(e)+`
`):(T().warn(`Attempted to send app-server message but stdin is destroyed: ${JSON.stringify(e)}`),this.broadcastFatalError(new mt("Codex process is not available")))}routeIncomingMessage(e){if(this.isMcpResponseMessage(e)){let t=e.id;if(typeof t=="string"&&t.includes(":")){let[n,...r]=t.split(":"),a=r.join(":"),o=this.providers.get(n);if(o?.onResult){let i={...e,id:a};o.onResult(i)}return}T().warn(`Received MCP response with id=${JSON.stringify(t)} but no provider namespace`);return}if(this.isMcpRequestMessage(e)){for(let[,t]of this.providers)t.onRequest?.(e);return}if(typeof e.method=="string"){let{method:t,params:n}=e;for(let[,r]of this.providers)r.onNotification?.({method:t,params:n});return}T().error(`Received unknown MCP message: ${JSON.stringify(e)}`)}isMcpResponseMessage(e){return"id"in e&&("result"in e||"error"in e)}isMcpRequestMessage(e){return typeof e.method=="string"&&"id"in e&&e.id!=null}broadcastFatalError(e){T().error(`[CodexMcpConnection] Codex process fatal error: ${e.message}, signal=${e.signal}, exitCode=${e.exitCode}`),this.fatalError=e;for(let[,t]of this.providers)t.onFatalError?.(e,this.mostRecentErrorMessage)}dispose(){this.teardownProcess()}};function HS(s){return s.replace(/\x1b\[[0-9;]*m/g,"")}function BS(s){let e=s.match(/^\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}\.\d+Z\s+(\w+)\s+(.+)$/);if(e){let t=e[1].toLowerCase();return t==="trace"||t==="debug"||t==="info"||t==="warn"||t==="error"?{level:t,message:e[2]}:{level:"error",message:e[2]}}return{level:"error",message:s}}function zS(){let s=ns.env.appName??"",e=s.toLowerCase();return e.includes("cursor")?"Cursor":e.includes("windsurf")?"Windsurf":e.includes("visual studio code")||e==="code"||e.startsWith("code ")||e.endsWith(" code")||e.includes("vscode")?"VS Code":s||"VS Code"}function Do(){let e=ns.extensions.getExtension("openai.chatgpt")?.packageJSON?.version;return typeof e=="string"&&e.trim().length>0?e:"0.0.0"}var Op="ConversationPreviewLoader",In=class{constructor(e){this.codexMcpConnection=e;e.registerProvider(Op,{onResult:t=>this.handleResult(t)})}nextRequestId=1;callbacks=new Map;async fetchConversationPreviews(){let e=await this.requestListConversations(),t=new Map;for(let n of e)t.set(String(n.conversationId),n.preview);return t}handleResult(e){let t=this.callbacks.get(e.id);t&&(this.callbacks.delete(e.id),t(e))}requestListConversations(e=50){let t=String(this.nextRequestId++),n=new Promise((a,o)=>{this.callbacks.set(t,i=>{if(i.error){o(new Error(i.error.message));return}if(!i.result){a([]);return}let c=i.result;a(c.items??[])})}),r={pageSize:e,cursor:null,modelProviders:[]};return this.codexMcpConnection.sendRequest(Op,t,"listConversations",r),n}};Pe();Re();var $o=G(require("vscode"));async function Vt(){try{await $o.commands.executeCommand("workbench.view.extension.codexViewContainer"),await $o.commands.executeCommand(`${Ht.viewType}.focus`)}catch(s){T().error(`Failed to focus Codex view: ${s instanceof Error?s.message:String(s)}`)}}Ut();Pe();Ze();Re();var nt=G(require("vscode")),GS=6e5,KS=5e3;function Dp(){if(process.platform!=="win32"){T().warn(`[installWslInTerminal] Ignoring request on non-Windows platform: ${process.platform}`);return}let s="Install WSL (Ubuntu)",e=new nt.ShellExecution("wsl.exe",["--install","-d","Ubuntu","--no-launch"]),t=new nt.Task({type:"shell",id:"codex-install-wsl"},nt.TaskScope.Global,s,"Codex",e),n,r=!1,a=nt.tasks.onDidEndTaskProcess(async o=>{try{if(!n||o.execution!==n)return;a.dispose(),r=!0;let i=o.exitCode;i!==0&&T().warn(`[installWslInTerminal] WSL install task exited with code ${String(i)}`)}catch(i){T().error(`[installWslInTerminal] unexpected error: ${String(i)}`)}});nt.tasks.executeTask(t).then(o=>{n=o,ZS({onReady:async()=>{try{await yn(De.RUN_CODEX_IN_WSL,!0),T().info("[installWslInTerminal] WSL ready; RUN_CODEX_IN_WSL enabled"),nt.window.showInformationMessage("WSL is ready. Codex will now run inside WSL. The window may reload.")}catch(i){T().error(`[installWslInTerminal] failed to set RUN_CODEX_IN_WSL: ${String(i)}`)}if(!r&&n)try{n.terminate(),T().info("[installWslInTerminal] Terminated install task after readiness detected")}catch(i){T().warn(`[installWslInTerminal] Failed to terminate task: ${String(i)}`)}},onTimeout:()=>{Wt(!0)!=null?nt.window.showInformationMessage("WSL detected but not ready to run commands yet. A system reboot may be required."):nt.window.showInformationMessage("WSL installation not yet detected. If you just installed WSL, a system reboot may be required.")}})})}function ZS(s){let e=Date.now(),t=()=>{if(Wt(!0)!=null){Promise.resolve(s.onReady());return}if(Date.now()-e>=GS){s.onTimeout&&Promise.resolve(s.onTimeout());return}setTimeout(t,KS)};setTimeout(t,0)}Pe();bn();var $p=G(require("vscode"));function js(){let s=$p.workspace.workspaceFolders?.map(t=>t.uri.fsPath)??[];return st()?s.map(_t):s}Pe();Ze();Re();var Mp="NewConversationFactory",kn=class{constructor(e,t,n){this.codexMcpConnection=e;this.modelProxyManager=t;this.fetchCodexConfig=n;this.subscriptions.push(this.codexMcpConnection.registerProvider(Mp,{onResult:r=>{this.handleInternalAppServerResponse(r)}}))}nextRequestId=1;subscriptions=[];pendingAppServerRequests=new Map;async createNewConversation(){let e=String(this.nextRequestId++),t=gn();this.pendingAppServerRequests.set(e,t);let n=js(),r=await Ud(null,()=>{let o=this.modelProxyManager.getProxy();return o?o.then(i=>({baseUrl:i.uri.toString(),secret:i.key})):Promise.resolve(null)},n,Vd(n),this.fetchCodexConfig);this.codexMcpConnection.sendRequest(Mp,e,"newConversation",r);let a=r.modelProvider??null;return t.promise.then(o=>({response:o,modelProvider:a}))}handleInternalAppServerResponse(e){let{id:t,result:n,error:r}=e,a=String(t),o=this.pendingAppServerRequests.get(a);if(!o){T().warn(`Received internal app server response for unknown request id: ${a}`);return}this.pendingAppServerRequests.delete(a),r?o.reject(r):o.resolve(n)}dispose(){this.subscriptions.forEach(e=>e.dispose())}};var On=require("fs"),jp=G(require("path"));Re();var Y=G(require("vscode")),JS=5173,QS=`http://localhost:${JS}`,XS="/src/main.tsx",Lp=30,qp="Codex",Np="CodexWebviewProvider.webview",Ht=class s{constructor(e,t,n,r,a,o,i,c,u){this.extensionUri=e;this.codexMcpConnection=t;this.fetchWrapper=n;this.ideContextConnection=r;this.modelProxyManager=a;this.conversationSummaryProvider=o;this.chatSessionItemProvider=i;this.fetchCodexConfig=c;this.sharedObjectRepository=u;this.subscriptions.push(Y.commands.registerCommand("chatgpt.implementTodo",async({line:f,fileName:h,comment:p})=>{await Vt();let g={fileName:h,line:f,comment:p};this.sidebarView&&this.sidebarWebviewReady?this.postMessageToWebview(this.sidebarView.webview,{type:"implement-todo",...g}):this.pendingImplementTodo=g})),this.subscriptions.push(Y.workspace.onDidChangeWorkspaceFolders(()=>{this.broadcastToAllViews({type:"active-workspace-roots-updated"})})),this.subscriptions.push(this.ideContextConnection.onIdeContextChange(()=>{this.broadcastToAllViews({type:"ide-context-updated"})})),this.subscriptions.push(this.modelProxyManager.onDidChangeIsCopilotApiAvailable(()=>{this.broadcastToAllViews({type:"is-copilot-api-available-updated"})})),this.subscriptions.push(this.codexMcpConnection.registerProvider(Np,{onResult:f=>{this.deliverMcpResponseToOrigin(f)},onRequest:f=>{this.broadcastToAllViews({type:"mcp-request",request:f})},onNotification:f=>{let{method:h,params:p}=f;this.broadcastToAllViews({type:"mcp-notification",method:h,params:p})},onFatalError:(f,h)=>{T().error(`[CodexWebviewProvider] fatal error: ${f.message}`),this.fatalError=f,this.mostRecentErrorLog=h??null,this.broadcastToAllViews({type:"codex-app-server-fatal-error",errorMessage:f.message,cliErrorMessage:h})}}));let d=this.sharedObjectRepository.addSubscriber((f,h)=>{this.broadcastToAllViews({type:"shared-object-updated",key:f,value:h})});this.subscriptions.push(Y.Disposable.from({dispose:d})),this.newConversationFactory=new kn(this.codexMcpConnection,this.modelProxyManager,this.fetchCodexConfig),this.subscriptions.push(this.newConversationFactory),this.previewLoader=new In(this.codexMcpConnection),this.ensureRestoredConversationTabsResolved()}static viewType="chatgpt.sidebarView";static panelViewType="chatgpt.panelView";static customEditorViewType="chatgpt.conversationEditor";sidebarView;sidebarWebviewReady=!1;editorPanels=new Map;subscriptions=[];pendingImplementTodo=null;pendingContextFiles=[];pendingNavigationRoutes=[];pendingMcpRequests=new Map;focusedView;diffPanel;diffPanelOwnerWebview;diffPanelPromise;newConversationFactory;previewLoader;fatalError=null;mostRecentErrorLog=null;async resolveWebviewView(e,t,n){this.sidebarView=e;let{webview:r}=e;await this.initializeWebview(r,"sidebar"),this.subscriptions.push(e.onDidDispose(()=>{this.clearPendingMcpRequestsForWebview(r),this.sidebarView=void 0,this.sidebarWebviewReady=!1,this.focusedView?.kind==="sidebar"&&(this.focusedView=this.getActivePanelFocusedView()??void 0)})),this.subscriptions.push(e.onDidChangeVisibility(()=>{Y.commands.executeCommand("setContext","chatgpt.sidebarView.visible",e.visible),!e.visible&&this.focusedView?.kind==="sidebar"&&(this.focusedView=this.getActivePanelFocusedView()??void 0)}))}triggerNewChatViaWebview(){this.sidebarView&&this.sidebarWebviewReady&&this.postMessageToWebview(this.sidebarView.webview,{type:"new-chat"})}postMessageToWebview(e,t){let n=JSON.stringify(t);e.postMessage(n)}openCustomDocument(e,t,n){return new Lo(e)}async resolveCustomEditor(e,t,n){let r=ln(e.uri);if(r==null)throw new Error(`Invalid Codex conversation URI: ${e.uri.toString()}`);let{conversationId:a}=r;if(a==null)throw new Error(`Invalid Codex conversation URI: ${e.uri.toString()}`);let o={path:r.path,conversationId:a,history:null,overrides:null},i=null,c=null;try{let{summary:u}=await this.conversationSummaryProvider.getConversationSummary(a);i=u.preview,c=u.modelProvider}catch(u){T().error(`Error fetching conversation summary: ${u}`)}t.title=Fp(i),t.iconPath={light:Y.Uri.joinPath(this.extensionUri,"resources","blossom-black.svg"),dark:Y.Uri.joinPath(this.extensionUri,"resources","blossom-white.svg")},this.chatSessionItemProvider?.registerPendingConversation({conversationId:a,resource:e.uri,label:i??void 0,modelProvider:c},{markInProgress:!1,onlyIfMissing:!0}),this.editorPanels.set(t,{ready:!1,pendingMessages:[],resumeParams:o,initialRoute:`/local/${a}`}),this.registerOnDidDisposeForWebviewPanel(t,a),await this.initializeWebview(t.webview,"panel",()=>{this.onPanelReady(t)}),this.previewLoader.fetchConversationPreviews().then(u=>{let d=u.get(a);this.isPanelAlive(t)&&(t.title=Fp(d))})}registerOnDidDisposeForWebviewPanel(e,t=null){this.subscriptions.push(e.onDidDispose(()=>{let n=this.getWebviewForPanel(e);this.clearPendingRequestsForWebview(n),this.removePanel(e),t&&this.chatSessionItemProvider?.clearPendingConversation(t),this.focusedView?.kind==="panel"&&this.focusedView.panel===e&&(this.focusedView=this.getActivePanelFocusedView()??(this.sidebarView?.visible?{kind:"sidebar"}:void 0))}))}addContextFile(e){let t={type:"add-context-file",file:e},n=this.focusedView;if(n?.kind==="panel"&&this.isPanelAlive(n.panel)){this.sendMessageToPanel(n.panel,t);return}this.sidebarView&&this.sidebarWebviewReady?this.postMessageToWebview(this.sidebarView.webview,t):this.pendingContextFiles.push(e)}navigateToRoute(e,t){let n={type:"navigate-to-route",path:e,state:t};this.sidebarView&&this.sidebarWebviewReady?this.postMessageToWebview(this.sidebarView.webview,n):this.pendingNavigationRoutes.push({path:e,state:t})}postMessageToSidebar(e){this.sidebarView&&this.postMessageToWebview(this.sidebarView.webview,e)}broadcastToAllViews(e){this.postMessageToSidebar(e),this.broadcastToPanels(e)}sendSharedObjectUpdate(e,t){if(!e)return;let n=this.sharedObjectRepository.get(t);this.postMessageToWebview(e,{type:"shared-object-updated",key:t,value:n})}removePanel(e){this.editorPanels.delete(e),this.diffPanel===e&&(this.diffPanel=void 0,this.diffPanelOwnerWebview=void 0)}clearPendingRequestsForWebview(e){if(e)for(let[t,n]of this.pendingMcpRequests.entries())n===e&&this.pendingMcpRequests.delete(t)}getWebviewForPanel(e){if(e)try{return e.webview}catch{this.removePanel(e);return}}getPanelViewColumn(e){if(e)try{return e.viewColumn}catch{this.removePanel(e);return}}isPanelAlive(e){return!e||!this.editorPanels.has(e)?!1:this.getWebviewForPanel(e)!=null}setFocusedViewForWebview(e){if(this.sidebarView?.webview===e){this.focusedView={kind:"sidebar"};return}let t=this.findPanelByWebview(e);if(t){if(t===this.diffPanel)return;this.focusedView={kind:"panel",panel:t}}}findPanelByWebview(e){for(let t of Array.from(this.editorPanels.keys())){let n=this.getWebviewForPanel(t);if(n&&n===e)return t}}async initializeWebview(e,t,n){let r=Y.Uri.joinPath(this.extensionUri,"webview");e.options={enableScripts:!0,enableCommandUris:!1,localResourceRoots:[r]};let a=e.onDidReceiveMessage(o=>{if(o.type==="ready"){if(t==="sidebar"){if(this.sidebarWebviewReady=!0,this.pendingImplementTodo&&(this.postMessageToWebview(e,{type:"implement-todo",...this.pendingImplementTodo}),this.pendingImplementTodo=null),this.pendingContextFiles.length>0){for(let i of this.pendingContextFiles)this.postMessageToWebview(e,{type:"add-context-file",file:i});this.pendingContextFiles=[]}if(this.pendingNavigationRoutes.length>0){for(let{path:i,state:c}of this.pendingNavigationRoutes)this.postMessageToWebview(e,{type:"navigate-to-route",path:i,state:c});this.pendingNavigationRoutes=[]}}n?.(),this.fatalError&&this.postMessageToWebview(e,{type:"codex-app-server-fatal-error",errorMessage:this.fatalError.message,cliErrorMessage:this.mostRecentErrorLog})}this.handleMessage(e,o)});this.subscriptions.push(a),e.html=await this.getWebviewContent(e)}onPanelReady(e){let t=this.editorPanels.get(e);if(!t)return;t.ready=!0;let n=this.getWebviewForPanel(e);if(!n)return;let r=t.pendingMessages;t.pendingMessages=[];for(let a of r)this.postMessageToWebview(n,a);t.resumeParams=null}sendMessageToPanel(e,t){let n=this.editorPanels.get(e);if(!n)return;let r=this.getWebviewForPanel(e);r&&(n.ready?this.postMessageToWebview(r,t):n.pendingMessages.push(t))}broadcastToPanels(e){for(let[t,n]of Array.from(this.editorPanels.entries())){let r=this.getWebviewForPanel(t);if(r){if(!n.ready){n.pendingMessages.push(e);continue}this.postMessageToWebview(r,e)}}}getActivePanelFocusedView(){for(let e of Array.from(this.editorPanels.keys()))if(this.isPanelAlive(e)&&e.active)return{kind:"panel",panel:e}}async createEditorPanel(e){let t=Y.Uri.joinPath(this.extensionUri,"webview"),n=Y.window.createWebviewPanel(s.panelViewType,e?.title??qp,{viewColumn:e?.viewColumn??Y.window.activeTextEditor?.viewColumn??Y.ViewColumn.Active,preserveFocus:e?.preserveFocus??!1},{enableScripts:!0,retainContextWhenHidden:!0,localResourceRoots:[t]});return this.editorPanels.set(n,{ready:!1,pendingMessages:[],initialRoute:e?.initialRoute}),this.registerOnDidDisposeForWebviewPanel(n),await this.initializeWebview(n.webview,"panel",()=>{this.onPanelReady(n)}),n}async ensurePrimaryEditorPanel(){return Array.from(this.editorPanels.keys()).find(t=>this.isPanelAlive(t))??this.createEditorPanel()}async ensureDiffPanel(e){return this.isPanelAlive(this.diffPanel)?this.diffPanel:this.diffPanelPromise?this.diffPanelPromise:(this.diffPanelOwnerWebview=void 0,this.diffPanelPromise=(async()=>{try{let t=await this.createEditorPanel({viewColumn:e,title:"Codex Diff",initialRoute:"/diff"});return this.diffPanel=t,t}finally{this.diffPanelPromise=void 0}})(),this.diffPanelPromise)}async handleMessage(e,t){switch(t.type){case"ready":break;case"codex-app-server-restart":{Y.commands.executeCommand("workbench.action.reloadWindow");break}case"view-focused":{this.setFocusedViewForWebview(e);break}case"mcp-request":{let{id:n,method:r,params:a}=t.request;this.pendingMcpRequests.set(String(n),e),this.codexMcpConnection.sendRequest(Np,String(n),r,a);break}case"mcp-notification":{let{method:n,params:r}=t.request;this.codexMcpConnection.sendNotification(n,r);break}case"mcp-response":{let{id:n,result:r}=t.response;this.codexMcpConnection.sendResponse(n,r);break}case"open-in-browser":{Y.env.openExternal(Y.Uri.parse(t.url));break}case"navigate-in-new-editor-tab":{let n=ro(t.path);Y.commands.executeCommand("vscode.open",n);break}case"open-vscode-command":{Y.commands.executeCommand(t.command,...t.args??[]);break}case"open-extension-settings":{Y.commands.executeCommand("workbench.action.openSettings","@ext:openai.chatgpt");break}case"open-keyboard-shortcuts":{Y.commands.executeCommand("workbench.action.openGlobalKeybindings","chatgpt");break}case"open-config-toml":{let n=fr({preferWsl:st()}),r=jp.join(n,"config.toml");await On.promises.mkdir(n,{recursive:!0});try{await On.promises.access(r)}catch(a){let o=a;if("code"in o&&o.code==="ENOENT")await On.promises.writeFile(r,"");else throw a}await Y.commands.executeCommand("vscode.open",Y.Uri.file(r));break}case"install-wsl":{try{Dp()}catch(n){let r=n instanceof Error?n.message:JSON.stringify(n);T().error(`[CodexWebviewProvider] Failed to run admin PowerShell command: ${r}`),Y.window.showErrorMessage("Failed to launch elevated PowerShell. Check the Codex output log for details.")}break}case"show-diff":{this.showDiff({unifiedDiff:t.unifiedDiff,conversationId:t.conversationId},e);break}case"update-diff-if-open":{this.isPanelAlive(this.diffPanel)&&this.diffPanelOwnerWebview===e&&this.sendMessageToPanel(this.diffPanel,{type:"navigate-to-route",path:"/diff",state:{unifiedDiff:t.unifiedDiff,conversationId:t.conversationId??null}});break}case"fetch":{let n=await this.fetchWrapper.fetch(t);this.postMessageToWebview(e,n);break}case"cancel-fetch":{this.fetchWrapper.cancel(t.requestId);break}case"fetch-stream":{this.fetchWrapper.stream(t,n=>{this.postMessageToWebview(e,n)});break}case"cancel-fetch-stream":{this.fetchWrapper.cancelStream(t.requestId);break}case"log-message":{let{level:n,message:r}=t;switch(n){case"trace":T().trace(r);break;case"debug":T().debug(r);break;case"info":T().info(r);break;case"warning":T().warn(r);break;case"error":T().error(r);break}break}case"shared-object-subscribe":{this.sendSharedObjectUpdate(e,t.key);break}case"shared-object-unsubscribe":break;case"shared-object-set":{this.sharedObjectRepository.set(t.key,t.value);break}case"electron-add-new-workspace-root-option":throw Error("electron-add-new-workspace-root-option is not supported by the extension");case"electron-update-workspace-root-options":throw Error("electron-update-workspace-root-options is not supported by the extension");case"electron-set-active-workspace-root":throw Error("electron-set-active-workspace-root is not supported by the extension");case"electron-set-badge-count":break;case"electron-worktree-retry-init":case"electron-worktree-delete":throw Error(`${t.type} is not supported by the extension`);case"get-open-in-targets":case"open-in-target":break}}async getWebviewContent(e){return this.getWebviewContentProduction(e)}async getWebviewContentProduction(e){let t=Y.Uri.joinPath(this.extensionUri,"webview"),n=Y.Uri.joinPath(t,"index.html"),r=await Y.workspace.fs.readFile(n),a=new TextDecoder("utf-8").decode(r),o=e.asWebviewUri(t).toString()+"/",i=Mo(o),c=["default-src 'none'",`img-src ${e.cspSource} https: data: blob:`,`script-src ${e.cspSource}`,`style-src ${e.cspSource} 'unsafe-inline'`,`font-src ${e.cspSource}`,`connect-src ${e.cspSource}`].join("; ")+";",u=Mo(c),d=a.replace("<!-- PROD_BASE_TAG_HERE -->",`<base href="${i}">`).replace("<!-- PROD_CSP_TAG_HERE -->",`<meta http-equiv="Content-Security-Policy" content="${u}">`),f=this.findPanelByWebview(e);if(f){let h=this.initialRouteMetaTag(f);h&&(d=d.replace("</head>",`${h}
</head>`))}return d}getWebviewContentDevelopment(e){let t=Y.Uri.parse(QS).toString(),n="",r=this.findPanelByWebview(e);return r&&(n=this.initialRouteMetaTag(r)??""),`<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <base href="${t}">
    ${n}

    <!-- Hot reloading code from Vite -->
    <script type="module">
        import RefreshRuntime from "/@react-refresh"
        RefreshRuntime.injectIntoGlobalHook(window)
        window.$RefreshReg$ = () => {}
        window.$RefreshSig$ = () => (type) => type
        window.__vite_plugin_react_preamble_installed__ = true
    </script>
    <script type="module" src="/@vite/client"></script>
    <script type="module" src="${XS}"></script>
    <script src="http://localhost:8097"></script>
</head>
<body tabindex="0" style="outline: none">
    <div id="root"></div>
</body>
</html>`}initialRouteMetaTag(e){let n=this.editorPanels.get(e)?.initialRoute??null;return n?`<meta name="initial-route" content="${Mo(n)}">`:null}dispose(){this.subscriptions.forEach(e=>e.dispose()),this.isPanelAlive(this.diffPanel)&&this.diffPanel.dispose(),this.diffPanel=void 0,this.diffPanelOwnerWebview=void 0,this.editorPanels.clear(),this.focusedView=void 0}async showDiff(e,t){let n=t??this.sidebarView?.webview;if(!n){let c=await this.ensurePrimaryEditorPanel(),u=this.getPanelViewColumn(c)??Y.ViewColumn.Active,d=this.getWebviewForPanel(c),f=await this.ensureDiffPanel(u),h=this.getPanelViewColumn(f)??this.getPanelViewColumn(c)??Y.ViewColumn.Active;f.reveal(h),this.diffPanelOwnerWebview=d,this.sendMessageToPanel(f,{type:"navigate-to-route",path:"/diff",state:{unifiedDiff:e.unifiedDiff,conversationId:e.conversationId??null}});return}let r=this.findPanelByWebview(n),a=this.getPanelViewColumn(r)??Y.ViewColumn.Active,o=await this.ensureDiffPanel(a),i=this.getPanelViewColumn(o)??this.getPanelViewColumn(r)??Y.ViewColumn.Active;o.reveal(i),this.diffPanelOwnerWebview=n,this.sendMessageToPanel(o,{type:"navigate-to-route",path:"/diff",state:{unifiedDiff:e.unifiedDiff,conversationId:e.conversationId??null}})}async createNewPanel(){let{response:e,modelProvider:t}=await this.newConversationFactory.createNewConversation(),n=e.conversationId,r=un(n),a=Date.now();this.chatSessionItemProvider?.registerPendingConversation({conversationId:n,resource:r,startedAt:a,modelProvider:t},{markInProgress:!1});let o=Y.window.activeTextEditor?.viewColumn??Y.ViewColumn.Active;try{await Y.commands.executeCommand("vscode.openWith",r,s.customEditorViewType,{viewColumn:o,preserveFocus:!1,preview:!1})}catch(i){throw this.chatSessionItemProvider?.clearPendingConversation(n),i}}deliverMcpResponseToOrigin(e){let t=String(e.id),n=this.pendingMcpRequests.get(t);if(!n){T().warn(`Received MCP response for unknown request id: ${t}`);return}this.pendingMcpRequests.delete(t),this.postMessageToWebview(n,{type:"mcp-response",message:e})}clearPendingMcpRequestsForWebview(e){for(let[t,n]of this.pendingMcpRequests.entries())n===e&&this.pendingMcpRequests.delete(t)}async ensureRestoredConversationTabsResolved(){for(let e of Y.window.tabGroups.all)for(let t of e.tabs){let n=t.input,r=null;n instanceof Y.TabInputCustom||n instanceof Y.TabInputText?r=n.uri:r=null,r&&r.scheme===Br&&Y.commands.executeCommand("vscode.openWith",r,s.customEditorViewType,{preserveFocus:!0,preview:t.isPreview})}}},Lo=class{constructor(e){this.uri=e}dispose(){}};function Mo(s){return s.replace(/["<&]/g,e=>{switch(e){case'"':return"&quot;";case"<":return"&lt;";case"&":return"&amp;";default:return e}})}function Fp(s){return s?s.length>Lp?s.substring(0,Lp)+"\u2026":s:qp}Ut();Pe();Ze();Re();var Up="ConversationSummaryProvider",Dn=class{constructor(e){this.codexMcpConnection=e;this.subscriptions.push(this.codexMcpConnection.registerProvider(Up,{onResult:t=>{this.handleAppServerResponse(t)}}))}nextRequestId=1;subscriptions=[];pendingAppServerRequests=new Map;async getConversationSummary(e){let t=String(this.nextRequestId++),n=gn();this.pendingAppServerRequests.set(t,n);let r={conversationId:e};return this.codexMcpConnection.sendRequest(Up,t,"getConversationSummary",r),n.promise}handleAppServerResponse(e){let{id:t,result:n,error:r}=e,a=String(t),o=this.pendingAppServerRequests.get(a);if(!o){T().warn(`Received app server response for unknown request id: ${a}`);return}this.pendingAppServerRequests.delete(a),r?o.reject(r):o.resolve(n)}dispose(){this.subscriptions.forEach(e=>e.dispose())}};Pe();Ze();Re();var mr=G(require("vscode")),YS="gpt-5.1",$n=class{constructor(e){this.context=e;try{this.isCopilotModelProxyAvailable=mr.lm.isModelProxyAvailable,mr.lm.onDidChangeModelProxyAvailability(()=>{let t=mr.lm.isModelProxyAvailable;t||(this.pendingProxy=null,this.proxy&&(this.proxy.dispose(),this.proxy=null)),this.isCopilotModelProxyAvailable!==t&&(this.isCopilotModelProxyAvailable=t,this.onDidChangeModelProxyAvailability.fire())})}catch{}}proxyAvailableSubscription=null;isCopilotModelProxyAvailable=!1;pendingProxy=null;proxy=null;onDidChangeModelProxyAvailability=new mr.EventEmitter;onDidChangeIsCopilotApiAvailable=this.onDidChangeModelProxyAvailability.event;isProxyAvailable(){return this.isCopilotModelProxyAvailable}isUserUsingCopilotInference(){return this.isCopilotModelProxyAvailable&&this.context.globalState.get(rt.USE_COPILOT_AUTH_IF_AVAILABLE,!1)}getProxy(){if(!this.isUserUsingCopilotInference())return null;if(this.pendingProxy)return this.pendingProxy;try{T().info("Requesting Language Model Proxy from VS Code API");let e=mr.lm.getModelProxy().then(t=>{if(T().info(`Language Model Proxy running on ${t.uri}`),e!==this.pendingProxy){if(t.dispose(),this.proxy)return this.proxy;throw new Error("Model proxy was disposed before it could be used.")}else return this.proxy=t,t},t=>{throw T().error(`Failed to get Language Model Proxy from VS Code API: ${t}`),this.pendingProxy=null,t});return this.pendingProxy=e,this.pendingProxy}catch{return null}}getModel(){return this.context.globalState.get(rt.COPILOT_DEFAULT_MODEL)??YS}dispose(){this.proxyAvailableSubscription?.dispose(),this.proxy?.dispose(),this.onDidChangeModelProxyAvailability.dispose()}};Ut();Pe();var qs=class{constructor(e,t=[],n=[],r){this.child=e;this.stdoutChunks=t;this.stderrChunks=n;this.promise=r.then(({code:a,signal:o})=>({type:"resolve",code:a,signal:o}),a=>({type:"reject",error:a}))}result=null;promise;check(){return this.wait().then(({stdout:e,stderr:t,code:n,signal:r})=>{if(n===0)return{stdout:e,stderr:t};throw new Error(`process exited with code ${n}, signal ${r}`)})}wait(){return this.promise.then(e=>{switch(e.type){case"resolve":{let{code:t,signal:n}=e;return{stdout:Buffer.concat(this.stdoutChunks).toString("utf8"),stderr:Buffer.concat(this.stderrChunks).toString("utf8"),code:t,signal:n}}case"reject":throw e.error}})}getStdout(){return Buffer.concat(this.stdoutChunks)}getStderr(){return Buffer.concat(this.stderrChunks)}getExitCode(){return this.result?.type==="resolve"?this.result.code:null}isDone(){return this.result!=null}kill(){this.child.kill()}};var No=require("child_process");Re();function gt({args:s,cwd:e}){if(st())return T().info("[spawnCodexProcess] spawning codex process inside WSL"),e_(s,e);let t=s[0],n=s.slice(1),r={cwd:e,env:{...process.env},stdio:["ignore","pipe","pipe"]},a=(0,No.spawn)(t,n,r);if(!a.pid)throw new Error(`failed to start process from ${e}: \`${s.join(" ")}\``);let o=[],i=[],c=new Promise((u,d)=>{a.stdout?.on("data",f=>{o.push(f)}),a.stderr?.on("data",f=>{i.push(f)}),a.on("exit",(f,h)=>{u({code:f,signal:h})}),a.on("error",f=>{d(f)})});return new qs(a,o,i,c)}function e_(s,e){let t=e?_t(e):".",n=["RUST_LOG=warn"],r=["-d","Ubuntu"];r.push("--cd",t),r.push("--exec","/usr/bin/env",...n,...s);let a={env:{...process.env},stdio:["ignore","pipe","pipe"]};T().info(`[spawnAsyncInsideWsl] spawning process inside WSL: wsl.exe ${r.join(" ")}`);let o=(0,No.spawn)("wsl.exe",r,a);if(!o.pid)throw new Error(`failed to start process from ${e}: \`${s.join(" ")}\``);let i=[],c=[],u=new Promise((d,f)=>{o.stdout?.on("data",h=>{i.push(h)}),o.stderr?.on("data",h=>{c.push(h)}),o.on("exit",(h,p)=>{d({code:h,signal:p})}),o.on("error",h=>{f(h)})});return new qs(o,i,c,u)}Pe();Re();async function Fo(s){try{let e=gt({args:["git","rev-parse","--show-toplevel"],cwd:s}),{stdout:t,code:n}=await e.wait();if(n===0)return t.trim()}catch(e){T().warn("git rev-parse --show-toplevel failed: ",e),T().error(`getGitRoot: ${s} is not a git repository`)}return null}Pe();Pe();var Wp=G(require("fs"));Re();var gr=G(require("vscode"));async function Vp(s,e=10){let t=gr.workspace.workspaceFolders??[];if(s.trim().length===0||t.length===0)return[];let n=t_(),r=t.map(o=>o.uri.fsPath);return(await ap(s,r,e,{rgPath:n,runCommand:r_})??[]).map(o=>({...o,path:gr.workspace.asRelativePath(o.fsPath).replace(/\\/g,"/")}))}function t_(){try{let s=gr.extensions.getExtension("openai.chatgpt");if(!s)return null;let e=process.platform==="win32"?"rg.exe":"rg",t=ss(),n=gr.Uri.joinPath(s.extensionUri,t,e).fsPath;return Wp.existsSync(n)?n:null}catch{return null}}async function r_(s,e){let t=gt({args:s,cwd:e}),{stdout:n,code:r}=await t.wait();return{stdout:n,code:r}}var Bp=require("child_process"),Ln=G(require("fs")),Nn=G(require("fs/promises")),zp=G(require("os")),as=G(require("path")),s_=200*1024*1024;async function Gp(s,e){let t=n_(s),n=as.basename(t)||"repo";await l_(t,s_);let r=await Mn(t,["rev-parse","HEAD"]),a=await Mn(t,["rev-parse","--abbrev-ref","HEAD"]),o=a&&a!=="HEAD"?a:null,i=await Mn(t,["remote","-v"]),c=c_(i),u=`${n}-snapshot-${Date.now()}.tar.gz`,d=as.join(zp.tmpdir(),u);if(e)await o_(t,d,e);else{let h=await a_(t);await i_(t,d,h)}let f=await Nn.stat(d);return{tarballPath:d,tarballFilename:u,tarballSize:f.size,repoName:n,branch:o,snapshotBranch:e??o??r,commitSha:r,remotes:c,contentType:"application/gzip"}}async function Kp({tarballPath:s,uploadUrl:e,contentLength:t,contentType:n}){let r=Ln.createReadStream(s);try{let a=await fetch(e,{method:"PUT",headers:{"Content-Type":n,"Content-Length":t.toString(),"x-ms-blob-type":"BlockBlob"},body:r,duplex:"half"});if(!a.ok){let o=await a.text().catch(()=>"");throw new Error(`Snapshot upload failed with status ${a.status} ${a.statusText}${o?`: ${o}`:""}`)}}finally{r.destroy(),await Nn.unlink(s).catch(()=>{})}}function n_(s){let e=as.resolve(s);if(!Ln.existsSync(e))throw new Error(`Git root does not exist: ${e}`);return e}async function jo(s,e){let t=gt({args:["git",...e],cwd:s}),{stdout:n,stderr:r,code:a}=await t.wait();return{stdout:n,stderr:r,code:a}}async function Mn(s,e){let{stdout:t,stderr:n,code:r}=await jo(s,e);if(r!==0){let a=n.trim()||t.trim();throw new Error(`git ${e.join(" ")} failed${a?`: ${a}`:""}`)}return t.trim()}async function a_(s){let{stdout:e,stderr:t,code:n}=await jo(s,["ls-files","--cached","--others","--exclude-standard","-z"]);if(n!==0){let r=t.trim();throw new Error(`git ls-files failed${r?`: ${r}`:""}`)}return e?e.split("\0").map(r=>r.trim()).filter(r=>r.length>0):[]}async function o_(s,e,t){await jo(s,["archive","--format=tar.gz","-o",e,t])}async function i_(s,e,t){await new Promise((n,r)=>{let o=(0,Bp.spawn)("tar",["--null","-czf",e,"-C",s,"--files-from","-"],{stdio:["pipe","ignore","pipe"]}),i="";if(o.stderr?.setEncoding("utf8"),o.stderr?.on("data",c=>{i+=c}),o.on("error",c=>r(c)),o.on("close",c=>{c===0?n():r(new Error(`tar exited with code ${c}${i?`: ${i.trim()}`:""}`))}),o.stdin){if(t.length>0){let c=`${t.join("\0")}\0`;o.stdin.write(c,"utf8",u=>{u&&r(u)})}o.stdin.end()}})}function c_(s){let e={};for(let t of s.split(/\r?\n/)){let n=t.trim();if(!n)continue;let r=n.split(/\s+/);if(r.length<3)continue;let[a,o,i]=r;i==="(push)"&&e[a]==null&&(e[a]=o)}return e}async function l_(s,e){let t=await Mn(s,["count-objects","-v"]),n=u_(t),a=((n.get("size")??0)+(n.get("size-pack")??0))*1024;if(a>e)throw new Error(`Repository is too large (${Hp(a)}). Maximum allowed size is ${Hp(e)}.`)}function u_(s){let e=new Map;for(let t of s.split(/\r?\n/)){let n=t.trim();if(!n)continue;let[r,a]=n.split(":");if(!r||a==null)continue;let o=Number.parseInt(a.trim(),10);Number.isFinite(o)&&e.set(r,o)}return e}function Hp(s){if(s<1024)return`${s} B`;let e=["KB","MB","GB","TB"],t=s/1024,n=0;for(;t>=1024&&n<e.length-1;)t/=1024,n+=1;return`${t.toFixed(1)} ${e[n]}`}var Zp=G(require("os")),Jp=require("os"),jn=G(require("path"));Ze();Re();var Se=G(require("vscode")),d_=5,p_=20,Fn=class{constructor(e,t,n,r,a){this.authProvider=e;this.ideContextConnection=t;this.globalState=n;this.modelProxyManager=r;this.fetchCodexConfig=a}handlers={"active-workspace-roots":async()=>({roots:js()}),"workspace-root-options":async()=>({roots:js()}),"codex-home":async()=>{let e=fr({preferWsl:st()&&!Rn()});return{codexHome:e,worktreesSegment:jn.join(e,"worktrees")}},"has-custom-cli-executable":async()=>({hasCustomCliExecutable:(ze(De.CLI_EXECUTABLE)??"").trim().length>0}),worktrees:async()=>({worktrees:[]}),"create-worktree":async()=>{throw new Error("create-worktree not supported in extension")},"account-info":async()=>{let e=await this.authProvider.getToken({refreshToken:!1});if(!e)return{accountId:null,userId:null,plan:null,email:null};try{let t=JSON.parse(Buffer.from(e.split(".")[1],"base64url").toString("utf8")),n=t["https://api.openai.com/auth"]??{},r=t["https://api.openai.com/profile"]??{},a=n?.chatgpt_account_id??null,o=n?.chatgpt_user_id??null,i=n?.chatgpt_plan_type??null,c=r.email??null;if(a&&o&&i)return{accountId:a,userId:o,plan:i,email:c}}catch{T().error("Unable to extract account id and plan from auth token.")}return{accountId:null,userId:null,plan:null,email:null}},"extension-info":async()=>({version:Do()}),"os-info":async()=>({platform:process.platform,hasWsl:Wt()!=null,isVsCodeRunningInsideWsl:Rn()}),"openai-api-key":async()=>({value:process.env.OPENAI_API_KEY??null}),"find-files":async({query:e})=>({files:await Vp(e,10)??[]}),"ide-context":async()=>({ideContext:this.ideContextConnection.getIdeContext()}),"mcp-codex-config":async()=>({config:await this.fetchCodexConfig?.()??null}),"apply-patch":async e=>{let t=st();return hp(e,{resolveRoot:Fo,runProcess:async(n,r)=>{let a=gt({args:n,cwd:r}),{code:o,stdout:i,stderr:c}=await a.wait();return{code:o??1,stdout:i,stderr:c}},preferWslPaths:t,convertWindowsPathToWslPath:_t,convertWslPathToWindowsPath:Cp})},"open-file":async({path:e,line:t,column:n})=>{let r=typeof t=="number"?t:void 0,a=typeof n=="number"?n:1,o=e.replace(/^([ab])[\\/]/,""),i=Se.workspace.workspaceFolders??[],c=async f=>{try{let h=await Se.workspace.openTextDocument(f),p=r!=null?new Se.Range(new Se.Position(Math.max(0,r-1),Math.max(0,a-1)),new Se.Position(Math.max(0,r-1),Math.max(0,a-1))):void 0;return await Se.window.showTextDocument(h,p?{preview:!1,selection:p}:void 0),!0}catch{return!1}};if(jn.isAbsolute(o)){let f=await c(Se.Uri.file(o));return f||T().error(`Failed to open absolute path: ${o}`),{success:f}}let u=o.split(/[\\/]+/).filter(Boolean),d=!1;for(let f of i){if(d)break;let h=Se.Uri.joinPath(f.uri,...u);if(await c(h)){d=!0;break}let p=u.indexOf(f.name);if(p!==-1){let g=Se.Uri.joinPath(f.uri,...u.slice(p+1));if(await c(g)){d=!0;break}}}if(!d&&o.length>0)try{let f=`**/${o.replace(/\\/g,"/")}`,h=await Se.workspace.findFiles(f,void 0,1);h.length>0&&(d=await c(h[0]))}catch{}if(!d){let f=i.map(h=>h.uri.fsPath).join(", ");T().error(`Failed to resolve and open file from path "${e}" (normalized: "${o}") in workspaces: [${f}]`)}return{success:d}},"git-origins":async({dirs:e}={})=>{let t=(0,Jp.homedir)();return{origins:await up(e||(Se.workspace.workspaceFolders?.map(r=>r.uri.fsPath)??[])),homeDir:t}},"git-roots":async()=>{let e=Se.workspace.workspaceFolders??[],t=Zp.homedir();return{roots:(await Promise.all(e.map(r=>Fo(r.uri.fsPath)))).filter(r=>r!=null),homeDir:t}},"git-current-branch":async({gitRoot:e})=>{let t=Se.workspace.workspaceFolders??[],n=e??t[0]?.uri.fsPath;if(!n)return{branch:null};try{let r=gt({args:["git","rev-parse","--abbrev-ref","HEAD"],cwd:n}),{stdout:a,code:o}=await r.wait();if(o===0){let i=a.trim();return{branch:i&&i!=="HEAD"?i:null}}}catch{}return{branch:null}},"git-branch-overview":async({gitRoot:e,recentBranchesLimit:t})=>{let n=Se.workspace.workspaceFolders??[],r=e??n[0]?.uri.fsPath;if(!r)return{currentBranch:null,defaultBranch:null,recentBranches:[]};let a=Math.min(t??d_,p_),o=async y=>{try{let v=gt({args:["git",...y],cwd:r}),{stdout:w,code:C}=await v.wait();return{stdout:w,code:C??-1}}catch{return{stdout:"",code:-1}}},{stdout:i,code:c}=await o(["rev-parse","--abbrev-ref","HEAD"]),u=c===0&&i.trim()!=="HEAD"?i.trim():null,d=null,f=await o(["symbolic-ref","--quiet","refs/remotes/origin/HEAD"]);if(f.code===0&&(d=f.stdout.trim().split("/").pop()??null),!d){let y=await o(["remote","show","origin"]);if(y.code===0){let v=/HEAD branch:\s*(.+)/.exec(y.stdout);v&&(d=v[1].trim())}}let{stdout:h,code:p}=await o(["for-each-ref","--format=%(refname:short)","--sort=-committerdate","refs/heads"]),g=p===0?h.split(/\r?\n/).map(y=>y.trim()).filter(y=>y.length>0&&y!==u).slice(0,a):[];return d||(d=g.find(v=>v==="main"||v==="master")??null),{currentBranch:u,defaultBranch:d,recentBranches:g}},"git-uncommitted-changes":async({cwd:e})=>{let t=Se.workspace.workspaceFolders??[],n=e?.trim(),r=n&&n.length>0?n:t[0]?.uri.fsPath;return r?cp(r):{uncommittedChanges:{type:"error"}}},"git-merge-base":async({gitRoot:e,baseBranch:t})=>{let n=Se.workspace.workspaceFolders??[],r=e??n[0]?.uri.fsPath,a=t?.trim();if(!r||!a)return{mergeBaseSha:null};let o=async h=>{try{let p=gt({args:["git",...h],cwd:r}),{stdout:g,code:y}=await p.wait();return{stdout:g,code:y??-1}}catch{return{stdout:"",code:-1}}},i=async h=>(await o(["rev-parse","--verify","--quiet",h])).code===0,u=await(async()=>{let h=new Set,p=[],g=async w=>{let C=w?.trim();!C||h.has(C)||await i(C)&&(p.push(C),h.add(C))},y=await o(["for-each-ref","--format=%(upstream:short)",`refs/heads/${a}`]),v=y.code===0?y.stdout.trim():void 0;return await g(v),await g(a),a.includes("/")||await g(`origin/${a}`),p[0]??null})();if(!u)return{mergeBaseSha:null,comparisonRef:null};let d=await o(["merge-base","HEAD",u]);return d.code!==0?{mergeBaseSha:null}:{mergeBaseSha:d.stdout.trim()||null}},"prepare-worktree-snapshot":async({gitRoot:e,snapshotBranch:t})=>Gp(e,t),"upload-worktree-snapshot":async({tarballPath:e,uploadUrl:t,contentLength:n,contentType:r})=>{try{await Kp({tarballPath:e,uploadUrl:t,contentLength:n,contentType:r})}catch(a){return T().error(`Failed to upload worktree snapshot: ${a}`),{success:!1}}return{success:!0}},"get-configuration":async({key:e})=>({value:ze(e)}),"set-configuration":async({key:e,value:t})=>{try{await yn(e,t)}catch{return T().error(`Failed to set configuration ${e}: ${t}`),{success:!1}}return{success:!0}},"get-global-state":async({key:e})=>({value:await this.globalState.get(e)}),"set-global-state":async({key:e,value:t})=>{try{return await this.globalState.update(e,t),{success:!0}}catch{return{success:!1}}},"set-vs-context":async({key:e,value:t})=>(await Se.commands.executeCommand("setContext",e,t),{success:!0}),"is-copilot-api-available":()=>Promise.resolve({available:this.modelProxyManager.isProxyAvailable()}),"get-copilot-api-proxy-info":()=>{let e=this.modelProxyManager.getProxy();return e==null?Promise.resolve(null):e.then(t=>({baseUrl:t.uri.toString(),secret:t.key}))}};handleVSCodeRequest(e,t){return this.handlers[e](t)}};Pe();var Qp=G(require("fs/promises")),Xp=G(require("path"));Ze();Re();var Yp=G(require("vscode")),qn=class{constructor(e){this.context=e}onDidUpdateEntryEmitter=new Yp.EventEmitter;onDidUpdateEntry=this.onDidUpdateEntryEmitter.event;async get(e){let t=this.context.globalState.get(e);if(e===rt.HAS_PROBABLY_SEEN_2025_08_27_NUX&&t==null){let n=fr({preferWsl:st()}),r=Xp.join(n,"sessions"),a;try{a=(await Qp.stat(r)).isDirectory(),a&&this.update(rt.HAS_PROBABLY_SEEN_2025_08_27_NUX,!0)}catch{a=!1}return a}return t}async update(e,t){await this.context.globalState.update(e,t),this.onDidUpdateEntryEmitter.fire({key:e,value:t})}async dumpNuxState(){let e=Object.entries(rt);for(let[t,n]of e){let r=this.context.globalState.get(n);T().info(`Global state ${t} (${n}): ${r}`)}}async resetNuxState(){T().info("Resetting NUX state"),await Promise.all(Object.values(rt).map(e=>this.context.globalState.update(e,void 0)))}dispose(){this.onDidUpdateEntryEmitter.dispose()}};var $t=G(require("vscode")),f_=5;function ef(s){return s.path.split("/").pop()??""}function h_(s){return{label:ef(s),path:$t.workspace.asRelativePath(s.fsPath),fsPath:s.fsPath}}function qo(s){return{label:ef(s.document.uri),path:$t.workspace.asRelativePath(s.document.uri.fsPath),fsPath:s.document.uri.fsPath,selection:s.selection,activeSelectionContent:s.document.getText(s.selection),selections:s.selections.map(e=>({start:e.start,end:e.end}))}}var Un=class{onIdeContextChangeEmitter=new $t.EventEmitter;listeners=[];recentOpenTabs=[];ideContext={activeFile:void 0,openTabs:[]};constructor(){this.listeners.push($t.window.onDidChangeActiveTextEditor(e=>this.onChangeActiveTextEditor(e))),this.listeners.push($t.window.onDidChangeTextEditorSelection(e=>{this.onChangeTextEditorSelection(e)})),this.initIdeContext()}get onIdeContextChange(){return this.onIdeContextChangeEmitter.event}getIdeContext(){return this.ideContext}initIdeContext(){let e=$t.window.activeTextEditor;e&&this.updateRecentOpenTabs(e),this.ideContext={activeFile:e?qo(e):void 0,openTabs:[...this.recentOpenTabs]},this.onIdeContextChangeEmitter.fire(this.ideContext)}onChangeActiveTextEditor(e){e&&this.updateRecentOpenTabs(e),this.ideContext={...this.ideContext,activeFile:e?qo(e):void 0,openTabs:[...this.recentOpenTabs]},this.onIdeContextChangeEmitter.fire(this.ideContext)}onChangeTextEditorSelection(e){e.textEditor.document.uri.scheme==="file"&&(this.ideContext={...this.ideContext,activeFile:qo(e.textEditor),openTabs:[...this.recentOpenTabs]},this.onIdeContextChangeEmitter.fire(this.ideContext))}dispose(){this.listeners.forEach(e=>e.dispose())}updateRecentOpenTabs(e){if(e.document.uri.scheme!=="file")return;let t=h_(e.document.uri);this.recentOpenTabs=[t,...this.recentOpenTabs.filter(n=>n.fsPath!==t.fsPath)].slice(0,f_)}};Pe();Pe();var Zt=G(require("path")),Te=G(require("vscode"));var l={};eo(l,{BRAND:()=>q_,DIRTY:()=>vr,EMPTY_PATH:()=>y_,INVALID:()=>Q,NEVER:()=>_E,OK:()=>We,ParseStatus:()=>Fe,Schema:()=>te,ZodAny:()=>Gt,ZodArray:()=>Ft,ZodBigInt:()=>br,ZodBoolean:()=>xr,ZodBranded:()=>Ws,ZodCatch:()=>kr,ZodDate:()=>wr,ZodDefault:()=>Ir,ZodDiscriminatedUnion:()=>Hn,ZodEffects:()=>dt,ZodEnum:()=>Tr,ZodError:()=>Je,ZodFirstPartyTypeKind:()=>O,ZodFunction:()=>zn,ZodIntersection:()=>Er,ZodIssueCode:()=>I,ZodLazy:()=>Cr,ZodLiteral:()=>Rr,ZodMap:()=>ds,ZodNaN:()=>fs,ZodNativeEnum:()=>Ar,ZodNever:()=>vt,ZodNull:()=>Sr,ZodNullable:()=>Rt,ZodNumber:()=>yr,ZodObject:()=>Qe,ZodOptional:()=>lt,ZodParsedType:()=>q,ZodPipeline:()=>Vs,ZodPromise:()=>Kt,ZodReadonly:()=>Or,ZodRecord:()=>Bn,ZodSchema:()=>te,ZodSet:()=>ps,ZodString:()=>zt,ZodSymbol:()=>ls,ZodTransformer:()=>dt,ZodTuple:()=>Ct,ZodType:()=>te,ZodUndefined:()=>Pr,ZodUnion:()=>_r,ZodUnknown:()=>Nt,ZodVoid:()=>us,addIssueToContext:()=>F,any:()=>Z_,array:()=>Y_,bigint:()=>H_,boolean:()=>pf,coerce:()=>SE,custom:()=>lf,date:()=>B_,datetimeRegex:()=>of,defaultErrorMap:()=>Mt,discriminatedUnion:()=>sE,effect:()=>mE,enum:()=>pE,function:()=>lE,getErrorMap:()=>os,getParsedType:()=>Et,instanceof:()=>W_,intersection:()=>nE,isAborted:()=>Wn,isAsync:()=>is,isDirty:()=>Vn,isValid:()=>Bt,late:()=>U_,lazy:()=>uE,literal:()=>dE,makeIssue:()=>Us,map:()=>iE,nan:()=>V_,nativeEnum:()=>fE,never:()=>Q_,null:()=>K_,nullable:()=>vE,number:()=>df,object:()=>eE,objectUtil:()=>Uo,oboolean:()=>PE,onumber:()=>wE,optional:()=>gE,ostring:()=>xE,pipeline:()=>bE,preprocess:()=>yE,promise:()=>hE,quotelessJson:()=>m_,record:()=>oE,set:()=>cE,setErrorMap:()=>v_,strictObject:()=>tE,string:()=>uf,symbol:()=>z_,transformer:()=>mE,tuple:()=>aE,undefined:()=>G_,union:()=>rE,unknown:()=>J_,util:()=>ae,void:()=>X_});var ae;(function(s){s.assertEqual=r=>{};function e(r){}s.assertIs=e;function t(r){throw new Error}s.assertNever=t,s.arrayToEnum=r=>{let a={};for(let o of r)a[o]=o;return a},s.getValidEnumValues=r=>{let a=s.objectKeys(r).filter(i=>typeof r[r[i]]!="number"),o={};for(let i of a)o[i]=r[i];return s.objectValues(o)},s.objectValues=r=>s.objectKeys(r).map(function(a){return r[a]}),s.objectKeys=typeof Object.keys=="function"?r=>Object.keys(r):r=>{let a=[];for(let o in r)Object.prototype.hasOwnProperty.call(r,o)&&a.push(o);return a},s.find=(r,a)=>{for(let o of r)if(a(o))return o},s.isInteger=typeof Number.isInteger=="function"?r=>Number.isInteger(r):r=>typeof r=="number"&&Number.isFinite(r)&&Math.floor(r)===r;function n(r,a=" | "){return r.map(o=>typeof o=="string"?`'${o}'`:o).join(a)}s.joinValues=n,s.jsonStringifyReplacer=(r,a)=>typeof a=="bigint"?a.toString():a})(ae||(ae={}));var Uo;(function(s){s.mergeShapes=(e,t)=>({...e,...t})})(Uo||(Uo={}));var q=ae.arrayToEnum(["string","nan","number","integer","float","boolean","date","bigint","symbol","function","undefined","null","array","object","unknown","promise","void","never","map","set"]),Et=s=>{switch(typeof s){case"undefined":return q.undefined;case"string":return q.string;case"number":return Number.isNaN(s)?q.nan:q.number;case"boolean":return q.boolean;case"function":return q.function;case"bigint":return q.bigint;case"symbol":return q.symbol;case"object":return Array.isArray(s)?q.array:s===null?q.null:s.then&&typeof s.then=="function"&&s.catch&&typeof s.catch=="function"?q.promise:typeof Map<"u"&&s instanceof Map?q.map:typeof Set<"u"&&s instanceof Set?q.set:typeof Date<"u"&&s instanceof Date?q.date:q.object;default:return q.unknown}};var I=ae.arrayToEnum(["invalid_type","invalid_literal","custom","invalid_union","invalid_union_discriminator","invalid_enum_value","unrecognized_keys","invalid_arguments","invalid_return_type","invalid_date","invalid_string","too_small","too_big","invalid_intersection_types","not_multiple_of","not_finite"]),m_=s=>JSON.stringify(s,null,2).replace(/"([^"]+)":/g,"$1:"),Je=class s extends Error{get errors(){return this.issues}constructor(e){super(),this.issues=[],this.addIssue=n=>{this.issues=[...this.issues,n]},this.addIssues=(n=[])=>{this.issues=[...this.issues,...n]};let t=new.target.prototype;Object.setPrototypeOf?Object.setPrototypeOf(this,t):this.__proto__=t,this.name="ZodError",this.issues=e}format(e){let t=e||function(a){return a.message},n={_errors:[]},r=a=>{for(let o of a.issues)if(o.code==="invalid_union")o.unionErrors.map(r);else if(o.code==="invalid_return_type")r(o.returnTypeError);else if(o.code==="invalid_arguments")r(o.argumentsError);else if(o.path.length===0)n._errors.push(t(o));else{let i=n,c=0;for(;c<o.path.length;){let u=o.path[c];c===o.path.length-1?(i[u]=i[u]||{_errors:[]},i[u]._errors.push(t(o))):i[u]=i[u]||{_errors:[]},i=i[u],c++}}};return r(this),n}static assert(e){if(!(e instanceof s))throw new Error(`Not a ZodError: ${e}`)}toString(){return this.message}get message(){return JSON.stringify(this.issues,ae.jsonStringifyReplacer,2)}get isEmpty(){return this.issues.length===0}flatten(e=t=>t.message){let t={},n=[];for(let r of this.issues)if(r.path.length>0){let a=r.path[0];t[a]=t[a]||[],t[a].push(e(r))}else n.push(e(r));return{formErrors:n,fieldErrors:t}}get formErrors(){return this.flatten()}};Je.create=s=>new Je(s);var g_=(s,e)=>{let t;switch(s.code){case I.invalid_type:s.received===q.undefined?t="Required":t=`Expected ${s.expected}, received ${s.received}`;break;case I.invalid_literal:t=`Invalid literal value, expected ${JSON.stringify(s.expected,ae.jsonStringifyReplacer)}`;break;case I.unrecognized_keys:t=`Unrecognized key(s) in object: ${ae.joinValues(s.keys,", ")}`;break;case I.invalid_union:t="Invalid input";break;case I.invalid_union_discriminator:t=`Invalid discriminator value. Expected ${ae.joinValues(s.options)}`;break;case I.invalid_enum_value:t=`Invalid enum value. Expected ${ae.joinValues(s.options)}, received '${s.received}'`;break;case I.invalid_arguments:t="Invalid function arguments";break;case I.invalid_return_type:t="Invalid function return type";break;case I.invalid_date:t="Invalid date";break;case I.invalid_string:typeof s.validation=="object"?"includes"in s.validation?(t=`Invalid input: must include "${s.validation.includes}"`,typeof s.validation.position=="number"&&(t=`${t} at one or more positions greater than or equal to ${s.validation.position}`)):"startsWith"in s.validation?t=`Invalid input: must start with "${s.validation.startsWith}"`:"endsWith"in s.validation?t=`Invalid input: must end with "${s.validation.endsWith}"`:ae.assertNever(s.validation):s.validation!=="regex"?t=`Invalid ${s.validation}`:t="Invalid";break;case I.too_small:s.type==="array"?t=`Array must contain ${s.exact?"exactly":s.inclusive?"at least":"more than"} ${s.minimum} element(s)`:s.type==="string"?t=`String must contain ${s.exact?"exactly":s.inclusive?"at least":"over"} ${s.minimum} character(s)`:s.type==="number"?t=`Number must be ${s.exact?"exactly equal to ":s.inclusive?"greater than or equal to ":"greater than "}${s.minimum}`:s.type==="bigint"?t=`Number must be ${s.exact?"exactly equal to ":s.inclusive?"greater than or equal to ":"greater than "}${s.minimum}`:s.type==="date"?t=`Date must be ${s.exact?"exactly equal to ":s.inclusive?"greater than or equal to ":"greater than "}${new Date(Number(s.minimum))}`:t="Invalid input";break;case I.too_big:s.type==="array"?t=`Array must contain ${s.exact?"exactly":s.inclusive?"at most":"less than"} ${s.maximum} element(s)`:s.type==="string"?t=`String must contain ${s.exact?"exactly":s.inclusive?"at most":"under"} ${s.maximum} character(s)`:s.type==="number"?t=`Number must be ${s.exact?"exactly":s.inclusive?"less than or equal to":"less than"} ${s.maximum}`:s.type==="bigint"?t=`BigInt must be ${s.exact?"exactly":s.inclusive?"less than or equal to":"less than"} ${s.maximum}`:s.type==="date"?t=`Date must be ${s.exact?"exactly":s.inclusive?"smaller than or equal to":"smaller than"} ${new Date(Number(s.maximum))}`:t="Invalid input";break;case I.custom:t="Invalid input";break;case I.invalid_intersection_types:t="Intersection results could not be merged";break;case I.not_multiple_of:t=`Number must be a multiple of ${s.multipleOf}`;break;case I.not_finite:t="Number must be finite";break;default:t=e.defaultError,ae.assertNever(s)}return{message:t}},Mt=g_;var tf=Mt;function v_(s){tf=s}function os(){return tf}var Us=s=>{let{data:e,path:t,errorMaps:n,issueData:r}=s,a=[...t,...r.path||[]],o={...r,path:a};if(r.message!==void 0)return{...r,path:a,message:r.message};let i="",c=n.filter(u=>!!u).slice().reverse();for(let u of c)i=u(o,{data:e,defaultError:i}).message;return{...r,path:a,message:i}},y_=[];function F(s,e){let t=os(),n=Us({issueData:e,data:s.data,path:s.path,errorMaps:[s.common.contextualErrorMap,s.schemaErrorMap,t,t===Mt?void 0:Mt].filter(r=>!!r)});s.common.issues.push(n)}var Fe=class s{constructor(){this.value="valid"}dirty(){this.value==="valid"&&(this.value="dirty")}abort(){this.value!=="aborted"&&(this.value="aborted")}static mergeArray(e,t){let n=[];for(let r of t){if(r.status==="aborted")return Q;r.status==="dirty"&&e.dirty(),n.push(r.value)}return{status:e.value,value:n}}static async mergeObjectAsync(e,t){let n=[];for(let r of t){let a=await r.key,o=await r.value;n.push({key:a,value:o})}return s.mergeObjectSync(e,n)}static mergeObjectSync(e,t){let n={};for(let r of t){let{key:a,value:o}=r;if(a.status==="aborted"||o.status==="aborted")return Q;a.status==="dirty"&&e.dirty(),o.status==="dirty"&&e.dirty(),a.value!=="__proto__"&&(typeof o.value<"u"||r.alwaysSet)&&(n[a.value]=o.value)}return{status:e.value,value:n}}},Q=Object.freeze({status:"aborted"}),vr=s=>({status:"dirty",value:s}),We=s=>({status:"valid",value:s}),Wn=s=>s.status==="aborted",Vn=s=>s.status==="dirty",Bt=s=>s.status==="valid",is=s=>typeof Promise<"u"&&s instanceof Promise;var z;(function(s){s.errToObj=e=>typeof e=="string"?{message:e}:e||{},s.toString=e=>typeof e=="string"?e:e?.message})(z||(z={}));var ut=class{constructor(e,t,n,r){this._cachedPath=[],this.parent=e,this.data=t,this._path=n,this._key=r}get path(){return this._cachedPath.length||(Array.isArray(this._key)?this._cachedPath.push(...this._path,...this._key):this._cachedPath.push(...this._path,this._key)),this._cachedPath}},rf=(s,e)=>{if(Bt(e))return{success:!0,data:e.value};if(!s.common.issues.length)throw new Error("Validation failed but no issues detected.");return{success:!1,get error(){if(this._error)return this._error;let t=new Je(s.common.issues);return this._error=t,this._error}}};function ee(s){if(!s)return{};let{errorMap:e,invalid_type_error:t,required_error:n,description:r}=s;if(e&&(t||n))throw new Error(`Can't use "invalid_type_error" or "required_error" in conjunction with custom error map.`);return e?{errorMap:e,description:r}:{errorMap:(o,i)=>{let{message:c}=s;return o.code==="invalid_enum_value"?{message:c??i.defaultError}:typeof i.data>"u"?{message:c??n??i.defaultError}:o.code!=="invalid_type"?{message:i.defaultError}:{message:c??t??i.defaultError}},description:r}}var te=class{get description(){return this._def.description}_getType(e){return Et(e.data)}_getOrReturnCtx(e,t){return t||{common:e.parent.common,data:e.data,parsedType:Et(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}_processInputParams(e){return{status:new Fe,ctx:{common:e.parent.common,data:e.data,parsedType:Et(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}}_parseSync(e){let t=this._parse(e);if(is(t))throw new Error("Synchronous parse encountered promise.");return t}_parseAsync(e){let t=this._parse(e);return Promise.resolve(t)}parse(e,t){let n=this.safeParse(e,t);if(n.success)return n.data;throw n.error}safeParse(e,t){let n={common:{issues:[],async:t?.async??!1,contextualErrorMap:t?.errorMap},path:t?.path||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:Et(e)},r=this._parseSync({data:e,path:n.path,parent:n});return rf(n,r)}"~validate"(e){let t={common:{issues:[],async:!!this["~standard"].async},path:[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:Et(e)};if(!this["~standard"].async)try{let n=this._parseSync({data:e,path:[],parent:t});return Bt(n)?{value:n.value}:{issues:t.common.issues}}catch(n){n?.message?.toLowerCase()?.includes("encountered")&&(this["~standard"].async=!0),t.common={issues:[],async:!0}}return this._parseAsync({data:e,path:[],parent:t}).then(n=>Bt(n)?{value:n.value}:{issues:t.common.issues})}async parseAsync(e,t){let n=await this.safeParseAsync(e,t);if(n.success)return n.data;throw n.error}async safeParseAsync(e,t){let n={common:{issues:[],contextualErrorMap:t?.errorMap,async:!0},path:t?.path||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:Et(e)},r=this._parse({data:e,path:n.path,parent:n}),a=await(is(r)?r:Promise.resolve(r));return rf(n,a)}refine(e,t){let n=r=>typeof t=="string"||typeof t>"u"?{message:t}:typeof t=="function"?t(r):t;return this._refinement((r,a)=>{let o=e(r),i=()=>a.addIssue({code:I.custom,...n(r)});return typeof Promise<"u"&&o instanceof Promise?o.then(c=>c?!0:(i(),!1)):o?!0:(i(),!1)})}refinement(e,t){return this._refinement((n,r)=>e(n)?!0:(r.addIssue(typeof t=="function"?t(n,r):t),!1))}_refinement(e){return new dt({schema:this,typeName:O.ZodEffects,effect:{type:"refinement",refinement:e}})}superRefine(e){return this._refinement(e)}constructor(e){this.spa=this.safeParseAsync,this._def=e,this.parse=this.parse.bind(this),this.safeParse=this.safeParse.bind(this),this.parseAsync=this.parseAsync.bind(this),this.safeParseAsync=this.safeParseAsync.bind(this),this.spa=this.spa.bind(this),this.refine=this.refine.bind(this),this.refinement=this.refinement.bind(this),this.superRefine=this.superRefine.bind(this),this.optional=this.optional.bind(this),this.nullable=this.nullable.bind(this),this.nullish=this.nullish.bind(this),this.array=this.array.bind(this),this.promise=this.promise.bind(this),this.or=this.or.bind(this),this.and=this.and.bind(this),this.transform=this.transform.bind(this),this.brand=this.brand.bind(this),this.default=this.default.bind(this),this.catch=this.catch.bind(this),this.describe=this.describe.bind(this),this.pipe=this.pipe.bind(this),this.readonly=this.readonly.bind(this),this.isNullable=this.isNullable.bind(this),this.isOptional=this.isOptional.bind(this),this["~standard"]={version:1,vendor:"zod",validate:t=>this["~validate"](t)}}optional(){return lt.create(this,this._def)}nullable(){return Rt.create(this,this._def)}nullish(){return this.nullable().optional()}array(){return Ft.create(this)}promise(){return Kt.create(this,this._def)}or(e){return _r.create([this,e],this._def)}and(e){return Er.create(this,e,this._def)}transform(e){return new dt({...ee(this._def),schema:this,typeName:O.ZodEffects,effect:{type:"transform",transform:e}})}default(e){let t=typeof e=="function"?e:()=>e;return new Ir({...ee(this._def),innerType:this,defaultValue:t,typeName:O.ZodDefault})}brand(){return new Ws({typeName:O.ZodBranded,type:this,...ee(this._def)})}catch(e){let t=typeof e=="function"?e:()=>e;return new kr({...ee(this._def),innerType:this,catchValue:t,typeName:O.ZodCatch})}describe(e){let t=this.constructor;return new t({...this._def,description:e})}pipe(e){return Vs.create(this,e)}readonly(){return Or.create(this)}isOptional(){return this.safeParse(void 0).success}isNullable(){return this.safeParse(null).success}},b_=/^c[^\s-]{8,}$/i,x_=/^[0-9a-z]+$/,w_=/^[0-9A-HJKMNP-TV-Z]{26}$/i,P_=/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/i,S_=/^[a-z0-9_-]{21}$/i,__=/^[A-Za-z0-9-_]+\.[A-Za-z0-9-_]+\.[A-Za-z0-9-_]*$/,E_=/^[-+]?P(?!$)(?:(?:[-+]?\d+Y)|(?:[-+]?\d+[.,]\d+Y$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:(?:[-+]?\d+W)|(?:[-+]?\d+[.,]\d+W$))?(?:(?:[-+]?\d+D)|(?:[-+]?\d+[.,]\d+D$))?(?:T(?=[\d+-])(?:(?:[-+]?\d+H)|(?:[-+]?\d+[.,]\d+H$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:[-+]?\d+(?:[.,]\d+)?S)?)??$/,C_=/^(?!\.)(?!.*\.\.)([A-Z0-9_'+\-\.]*)[A-Z0-9_+-]@([A-Z0-9][A-Z0-9\-]*\.)+[A-Z]{2,}$/i,R_="^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$",Wo,T_=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,A_=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/(3[0-2]|[12]?[0-9])$/,I_=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))$/,k_=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,O_=/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,D_=/^([0-9a-zA-Z-_]{4})*(([0-9a-zA-Z-_]{2}(==)?)|([0-9a-zA-Z-_]{3}(=)?))?$/,nf="((\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-((0[13578]|1[02])-(0[1-9]|[12]\\d|3[01])|(0[469]|11)-(0[1-9]|[12]\\d|30)|(02)-(0[1-9]|1\\d|2[0-8])))",$_=new RegExp(`^${nf}$`);function af(s){let e="[0-5]\\d";s.precision?e=`${e}\\.\\d{${s.precision}}`:s.precision==null&&(e=`${e}(\\.\\d+)?`);let t=s.precision?"+":"?";return`([01]\\d|2[0-3]):[0-5]\\d(:${e})${t}`}function M_(s){return new RegExp(`^${af(s)}$`)}function of(s){let e=`${nf}T${af(s)}`,t=[];return t.push(s.local?"Z?":"Z"),s.offset&&t.push("([+-]\\d{2}:?\\d{2})"),e=`${e}(${t.join("|")})`,new RegExp(`^${e}$`)}function L_(s,e){return!!((e==="v4"||!e)&&T_.test(s)||(e==="v6"||!e)&&I_.test(s))}function N_(s,e){if(!__.test(s))return!1;try{let[t]=s.split(".");if(!t)return!1;let n=t.replace(/-/g,"+").replace(/_/g,"/").padEnd(t.length+(4-t.length%4)%4,"="),r=JSON.parse(atob(n));return!(typeof r!="object"||r===null||"typ"in r&&r?.typ!=="JWT"||!r.alg||e&&r.alg!==e)}catch{return!1}}function F_(s,e){return!!((e==="v4"||!e)&&A_.test(s)||(e==="v6"||!e)&&k_.test(s))}var zt=class s extends te{_parse(e){if(this._def.coerce&&(e.data=String(e.data)),this._getType(e)!==q.string){let a=this._getOrReturnCtx(e);return F(a,{code:I.invalid_type,expected:q.string,received:a.parsedType}),Q}let n=new Fe,r;for(let a of this._def.checks)if(a.kind==="min")e.data.length<a.value&&(r=this._getOrReturnCtx(e,r),F(r,{code:I.too_small,minimum:a.value,type:"string",inclusive:!0,exact:!1,message:a.message}),n.dirty());else if(a.kind==="max")e.data.length>a.value&&(r=this._getOrReturnCtx(e,r),F(r,{code:I.too_big,maximum:a.value,type:"string",inclusive:!0,exact:!1,message:a.message}),n.dirty());else if(a.kind==="length"){let o=e.data.length>a.value,i=e.data.length<a.value;(o||i)&&(r=this._getOrReturnCtx(e,r),o?F(r,{code:I.too_big,maximum:a.value,type:"string",inclusive:!0,exact:!0,message:a.message}):i&&F(r,{code:I.too_small,minimum:a.value,type:"string",inclusive:!0,exact:!0,message:a.message}),n.dirty())}else if(a.kind==="email")C_.test(e.data)||(r=this._getOrReturnCtx(e,r),F(r,{validation:"email",code:I.invalid_string,message:a.message}),n.dirty());else if(a.kind==="emoji")Wo||(Wo=new RegExp(R_,"u")),Wo.test(e.data)||(r=this._getOrReturnCtx(e,r),F(r,{validation:"emoji",code:I.invalid_string,message:a.message}),n.dirty());else if(a.kind==="uuid")P_.test(e.data)||(r=this._getOrReturnCtx(e,r),F(r,{validation:"uuid",code:I.invalid_string,message:a.message}),n.dirty());else if(a.kind==="nanoid")S_.test(e.data)||(r=this._getOrReturnCtx(e,r),F(r,{validation:"nanoid",code:I.invalid_string,message:a.message}),n.dirty());else if(a.kind==="cuid")b_.test(e.data)||(r=this._getOrReturnCtx(e,r),F(r,{validation:"cuid",code:I.invalid_string,message:a.message}),n.dirty());else if(a.kind==="cuid2")x_.test(e.data)||(r=this._getOrReturnCtx(e,r),F(r,{validation:"cuid2",code:I.invalid_string,message:a.message}),n.dirty());else if(a.kind==="ulid")w_.test(e.data)||(r=this._getOrReturnCtx(e,r),F(r,{validation:"ulid",code:I.invalid_string,message:a.message}),n.dirty());else if(a.kind==="url")try{new URL(e.data)}catch{r=this._getOrReturnCtx(e,r),F(r,{validation:"url",code:I.invalid_string,message:a.message}),n.dirty()}else a.kind==="regex"?(a.regex.lastIndex=0,a.regex.test(e.data)||(r=this._getOrReturnCtx(e,r),F(r,{validation:"regex",code:I.invalid_string,message:a.message}),n.dirty())):a.kind==="trim"?e.data=e.data.trim():a.kind==="includes"?e.data.includes(a.value,a.position)||(r=this._getOrReturnCtx(e,r),F(r,{code:I.invalid_string,validation:{includes:a.value,position:a.position},message:a.message}),n.dirty()):a.kind==="toLowerCase"?e.data=e.data.toLowerCase():a.kind==="toUpperCase"?e.data=e.data.toUpperCase():a.kind==="startsWith"?e.data.startsWith(a.value)||(r=this._getOrReturnCtx(e,r),F(r,{code:I.invalid_string,validation:{startsWith:a.value},message:a.message}),n.dirty()):a.kind==="endsWith"?e.data.endsWith(a.value)||(r=this._getOrReturnCtx(e,r),F(r,{code:I.invalid_string,validation:{endsWith:a.value},message:a.message}),n.dirty()):a.kind==="datetime"?of(a).test(e.data)||(r=this._getOrReturnCtx(e,r),F(r,{code:I.invalid_string,validation:"datetime",message:a.message}),n.dirty()):a.kind==="date"?$_.test(e.data)||(r=this._getOrReturnCtx(e,r),F(r,{code:I.invalid_string,validation:"date",message:a.message}),n.dirty()):a.kind==="time"?M_(a).test(e.data)||(r=this._getOrReturnCtx(e,r),F(r,{code:I.invalid_string,validation:"time",message:a.message}),n.dirty()):a.kind==="duration"?E_.test(e.data)||(r=this._getOrReturnCtx(e,r),F(r,{validation:"duration",code:I.invalid_string,message:a.message}),n.dirty()):a.kind==="ip"?L_(e.data,a.version)||(r=this._getOrReturnCtx(e,r),F(r,{validation:"ip",code:I.invalid_string,message:a.message}),n.dirty()):a.kind==="jwt"?N_(e.data,a.alg)||(r=this._getOrReturnCtx(e,r),F(r,{validation:"jwt",code:I.invalid_string,message:a.message}),n.dirty()):a.kind==="cidr"?F_(e.data,a.version)||(r=this._getOrReturnCtx(e,r),F(r,{validation:"cidr",code:I.invalid_string,message:a.message}),n.dirty()):a.kind==="base64"?O_.test(e.data)||(r=this._getOrReturnCtx(e,r),F(r,{validation:"base64",code:I.invalid_string,message:a.message}),n.dirty()):a.kind==="base64url"?D_.test(e.data)||(r=this._getOrReturnCtx(e,r),F(r,{validation:"base64url",code:I.invalid_string,message:a.message}),n.dirty()):ae.assertNever(a);return{status:n.value,value:e.data}}_regex(e,t,n){return this.refinement(r=>e.test(r),{validation:t,code:I.invalid_string,...z.errToObj(n)})}_addCheck(e){return new s({...this._def,checks:[...this._def.checks,e]})}email(e){return this._addCheck({kind:"email",...z.errToObj(e)})}url(e){return this._addCheck({kind:"url",...z.errToObj(e)})}emoji(e){return this._addCheck({kind:"emoji",...z.errToObj(e)})}uuid(e){return this._addCheck({kind:"uuid",...z.errToObj(e)})}nanoid(e){return this._addCheck({kind:"nanoid",...z.errToObj(e)})}cuid(e){return this._addCheck({kind:"cuid",...z.errToObj(e)})}cuid2(e){return this._addCheck({kind:"cuid2",...z.errToObj(e)})}ulid(e){return this._addCheck({kind:"ulid",...z.errToObj(e)})}base64(e){return this._addCheck({kind:"base64",...z.errToObj(e)})}base64url(e){return this._addCheck({kind:"base64url",...z.errToObj(e)})}jwt(e){return this._addCheck({kind:"jwt",...z.errToObj(e)})}ip(e){return this._addCheck({kind:"ip",...z.errToObj(e)})}cidr(e){return this._addCheck({kind:"cidr",...z.errToObj(e)})}datetime(e){return typeof e=="string"?this._addCheck({kind:"datetime",precision:null,offset:!1,local:!1,message:e}):this._addCheck({kind:"datetime",precision:typeof e?.precision>"u"?null:e?.precision,offset:e?.offset??!1,local:e?.local??!1,...z.errToObj(e?.message)})}date(e){return this._addCheck({kind:"date",message:e})}time(e){return typeof e=="string"?this._addCheck({kind:"time",precision:null,message:e}):this._addCheck({kind:"time",precision:typeof e?.precision>"u"?null:e?.precision,...z.errToObj(e?.message)})}duration(e){return this._addCheck({kind:"duration",...z.errToObj(e)})}regex(e,t){return this._addCheck({kind:"regex",regex:e,...z.errToObj(t)})}includes(e,t){return this._addCheck({kind:"includes",value:e,position:t?.position,...z.errToObj(t?.message)})}startsWith(e,t){return this._addCheck({kind:"startsWith",value:e,...z.errToObj(t)})}endsWith(e,t){return this._addCheck({kind:"endsWith",value:e,...z.errToObj(t)})}min(e,t){return this._addCheck({kind:"min",value:e,...z.errToObj(t)})}max(e,t){return this._addCheck({kind:"max",value:e,...z.errToObj(t)})}length(e,t){return this._addCheck({kind:"length",value:e,...z.errToObj(t)})}nonempty(e){return this.min(1,z.errToObj(e))}trim(){return new s({...this._def,checks:[...this._def.checks,{kind:"trim"}]})}toLowerCase(){return new s({...this._def,checks:[...this._def.checks,{kind:"toLowerCase"}]})}toUpperCase(){return new s({...this._def,checks:[...this._def.checks,{kind:"toUpperCase"}]})}get isDatetime(){return!!this._def.checks.find(e=>e.kind==="datetime")}get isDate(){return!!this._def.checks.find(e=>e.kind==="date")}get isTime(){return!!this._def.checks.find(e=>e.kind==="time")}get isDuration(){return!!this._def.checks.find(e=>e.kind==="duration")}get isEmail(){return!!this._def.checks.find(e=>e.kind==="email")}get isURL(){return!!this._def.checks.find(e=>e.kind==="url")}get isEmoji(){return!!this._def.checks.find(e=>e.kind==="emoji")}get isUUID(){return!!this._def.checks.find(e=>e.kind==="uuid")}get isNANOID(){return!!this._def.checks.find(e=>e.kind==="nanoid")}get isCUID(){return!!this._def.checks.find(e=>e.kind==="cuid")}get isCUID2(){return!!this._def.checks.find(e=>e.kind==="cuid2")}get isULID(){return!!this._def.checks.find(e=>e.kind==="ulid")}get isIP(){return!!this._def.checks.find(e=>e.kind==="ip")}get isCIDR(){return!!this._def.checks.find(e=>e.kind==="cidr")}get isBase64(){return!!this._def.checks.find(e=>e.kind==="base64")}get isBase64url(){return!!this._def.checks.find(e=>e.kind==="base64url")}get minLength(){let e=null;for(let t of this._def.checks)t.kind==="min"&&(e===null||t.value>e)&&(e=t.value);return e}get maxLength(){let e=null;for(let t of this._def.checks)t.kind==="max"&&(e===null||t.value<e)&&(e=t.value);return e}};zt.create=s=>new zt({checks:[],typeName:O.ZodString,coerce:s?.coerce??!1,...ee(s)});function j_(s,e){let t=(s.toString().split(".")[1]||"").length,n=(e.toString().split(".")[1]||"").length,r=t>n?t:n,a=Number.parseInt(s.toFixed(r).replace(".","")),o=Number.parseInt(e.toFixed(r).replace(".",""));return a%o/10**r}var yr=class s extends te{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte,this.step=this.multipleOf}_parse(e){if(this._def.coerce&&(e.data=Number(e.data)),this._getType(e)!==q.number){let a=this._getOrReturnCtx(e);return F(a,{code:I.invalid_type,expected:q.number,received:a.parsedType}),Q}let n,r=new Fe;for(let a of this._def.checks)a.kind==="int"?ae.isInteger(e.data)||(n=this._getOrReturnCtx(e,n),F(n,{code:I.invalid_type,expected:"integer",received:"float",message:a.message}),r.dirty()):a.kind==="min"?(a.inclusive?e.data<a.value:e.data<=a.value)&&(n=this._getOrReturnCtx(e,n),F(n,{code:I.too_small,minimum:a.value,type:"number",inclusive:a.inclusive,exact:!1,message:a.message}),r.dirty()):a.kind==="max"?(a.inclusive?e.data>a.value:e.data>=a.value)&&(n=this._getOrReturnCtx(e,n),F(n,{code:I.too_big,maximum:a.value,type:"number",inclusive:a.inclusive,exact:!1,message:a.message}),r.dirty()):a.kind==="multipleOf"?j_(e.data,a.value)!==0&&(n=this._getOrReturnCtx(e,n),F(n,{code:I.not_multiple_of,multipleOf:a.value,message:a.message}),r.dirty()):a.kind==="finite"?Number.isFinite(e.data)||(n=this._getOrReturnCtx(e,n),F(n,{code:I.not_finite,message:a.message}),r.dirty()):ae.assertNever(a);return{status:r.value,value:e.data}}gte(e,t){return this.setLimit("min",e,!0,z.toString(t))}gt(e,t){return this.setLimit("min",e,!1,z.toString(t))}lte(e,t){return this.setLimit("max",e,!0,z.toString(t))}lt(e,t){return this.setLimit("max",e,!1,z.toString(t))}setLimit(e,t,n,r){return new s({...this._def,checks:[...this._def.checks,{kind:e,value:t,inclusive:n,message:z.toString(r)}]})}_addCheck(e){return new s({...this._def,checks:[...this._def.checks,e]})}int(e){return this._addCheck({kind:"int",message:z.toString(e)})}positive(e){return this._addCheck({kind:"min",value:0,inclusive:!1,message:z.toString(e)})}negative(e){return this._addCheck({kind:"max",value:0,inclusive:!1,message:z.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:0,inclusive:!0,message:z.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:0,inclusive:!0,message:z.toString(e)})}multipleOf(e,t){return this._addCheck({kind:"multipleOf",value:e,message:z.toString(t)})}finite(e){return this._addCheck({kind:"finite",message:z.toString(e)})}safe(e){return this._addCheck({kind:"min",inclusive:!0,value:Number.MIN_SAFE_INTEGER,message:z.toString(e)})._addCheck({kind:"max",inclusive:!0,value:Number.MAX_SAFE_INTEGER,message:z.toString(e)})}get minValue(){let e=null;for(let t of this._def.checks)t.kind==="min"&&(e===null||t.value>e)&&(e=t.value);return e}get maxValue(){let e=null;for(let t of this._def.checks)t.kind==="max"&&(e===null||t.value<e)&&(e=t.value);return e}get isInt(){return!!this._def.checks.find(e=>e.kind==="int"||e.kind==="multipleOf"&&ae.isInteger(e.value))}get isFinite(){let e=null,t=null;for(let n of this._def.checks){if(n.kind==="finite"||n.kind==="int"||n.kind==="multipleOf")return!0;n.kind==="min"?(t===null||n.value>t)&&(t=n.value):n.kind==="max"&&(e===null||n.value<e)&&(e=n.value)}return Number.isFinite(t)&&Number.isFinite(e)}};yr.create=s=>new yr({checks:[],typeName:O.ZodNumber,coerce:s?.coerce||!1,...ee(s)});var br=class s extends te{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte}_parse(e){if(this._def.coerce)try{e.data=BigInt(e.data)}catch{return this._getInvalidInput(e)}if(this._getType(e)!==q.bigint)return this._getInvalidInput(e);let n,r=new Fe;for(let a of this._def.checks)a.kind==="min"?(a.inclusive?e.data<a.value:e.data<=a.value)&&(n=this._getOrReturnCtx(e,n),F(n,{code:I.too_small,type:"bigint",minimum:a.value,inclusive:a.inclusive,message:a.message}),r.dirty()):a.kind==="max"?(a.inclusive?e.data>a.value:e.data>=a.value)&&(n=this._getOrReturnCtx(e,n),F(n,{code:I.too_big,type:"bigint",maximum:a.value,inclusive:a.inclusive,message:a.message}),r.dirty()):a.kind==="multipleOf"?e.data%a.value!==BigInt(0)&&(n=this._getOrReturnCtx(e,n),F(n,{code:I.not_multiple_of,multipleOf:a.value,message:a.message}),r.dirty()):ae.assertNever(a);return{status:r.value,value:e.data}}_getInvalidInput(e){let t=this._getOrReturnCtx(e);return F(t,{code:I.invalid_type,expected:q.bigint,received:t.parsedType}),Q}gte(e,t){return this.setLimit("min",e,!0,z.toString(t))}gt(e,t){return this.setLimit("min",e,!1,z.toString(t))}lte(e,t){return this.setLimit("max",e,!0,z.toString(t))}lt(e,t){return this.setLimit("max",e,!1,z.toString(t))}setLimit(e,t,n,r){return new s({...this._def,checks:[...this._def.checks,{kind:e,value:t,inclusive:n,message:z.toString(r)}]})}_addCheck(e){return new s({...this._def,checks:[...this._def.checks,e]})}positive(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!1,message:z.toString(e)})}negative(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!1,message:z.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!0,message:z.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!0,message:z.toString(e)})}multipleOf(e,t){return this._addCheck({kind:"multipleOf",value:e,message:z.toString(t)})}get minValue(){let e=null;for(let t of this._def.checks)t.kind==="min"&&(e===null||t.value>e)&&(e=t.value);return e}get maxValue(){let e=null;for(let t of this._def.checks)t.kind==="max"&&(e===null||t.value<e)&&(e=t.value);return e}};br.create=s=>new br({checks:[],typeName:O.ZodBigInt,coerce:s?.coerce??!1,...ee(s)});var xr=class extends te{_parse(e){if(this._def.coerce&&(e.data=!!e.data),this._getType(e)!==q.boolean){let n=this._getOrReturnCtx(e);return F(n,{code:I.invalid_type,expected:q.boolean,received:n.parsedType}),Q}return We(e.data)}};xr.create=s=>new xr({typeName:O.ZodBoolean,coerce:s?.coerce||!1,...ee(s)});var wr=class s extends te{_parse(e){if(this._def.coerce&&(e.data=new Date(e.data)),this._getType(e)!==q.date){let a=this._getOrReturnCtx(e);return F(a,{code:I.invalid_type,expected:q.date,received:a.parsedType}),Q}if(Number.isNaN(e.data.getTime())){let a=this._getOrReturnCtx(e);return F(a,{code:I.invalid_date}),Q}let n=new Fe,r;for(let a of this._def.checks)a.kind==="min"?e.data.getTime()<a.value&&(r=this._getOrReturnCtx(e,r),F(r,{code:I.too_small,message:a.message,inclusive:!0,exact:!1,minimum:a.value,type:"date"}),n.dirty()):a.kind==="max"?e.data.getTime()>a.value&&(r=this._getOrReturnCtx(e,r),F(r,{code:I.too_big,message:a.message,inclusive:!0,exact:!1,maximum:a.value,type:"date"}),n.dirty()):ae.assertNever(a);return{status:n.value,value:new Date(e.data.getTime())}}_addCheck(e){return new s({...this._def,checks:[...this._def.checks,e]})}min(e,t){return this._addCheck({kind:"min",value:e.getTime(),message:z.toString(t)})}max(e,t){return this._addCheck({kind:"max",value:e.getTime(),message:z.toString(t)})}get minDate(){let e=null;for(let t of this._def.checks)t.kind==="min"&&(e===null||t.value>e)&&(e=t.value);return e!=null?new Date(e):null}get maxDate(){let e=null;for(let t of this._def.checks)t.kind==="max"&&(e===null||t.value<e)&&(e=t.value);return e!=null?new Date(e):null}};wr.create=s=>new wr({checks:[],coerce:s?.coerce||!1,typeName:O.ZodDate,...ee(s)});var ls=class extends te{_parse(e){if(this._getType(e)!==q.symbol){let n=this._getOrReturnCtx(e);return F(n,{code:I.invalid_type,expected:q.symbol,received:n.parsedType}),Q}return We(e.data)}};ls.create=s=>new ls({typeName:O.ZodSymbol,...ee(s)});var Pr=class extends te{_parse(e){if(this._getType(e)!==q.undefined){let n=this._getOrReturnCtx(e);return F(n,{code:I.invalid_type,expected:q.undefined,received:n.parsedType}),Q}return We(e.data)}};Pr.create=s=>new Pr({typeName:O.ZodUndefined,...ee(s)});var Sr=class extends te{_parse(e){if(this._getType(e)!==q.null){let n=this._getOrReturnCtx(e);return F(n,{code:I.invalid_type,expected:q.null,received:n.parsedType}),Q}return We(e.data)}};Sr.create=s=>new Sr({typeName:O.ZodNull,...ee(s)});var Gt=class extends te{constructor(){super(...arguments),this._any=!0}_parse(e){return We(e.data)}};Gt.create=s=>new Gt({typeName:O.ZodAny,...ee(s)});var Nt=class extends te{constructor(){super(...arguments),this._unknown=!0}_parse(e){return We(e.data)}};Nt.create=s=>new Nt({typeName:O.ZodUnknown,...ee(s)});var vt=class extends te{_parse(e){let t=this._getOrReturnCtx(e);return F(t,{code:I.invalid_type,expected:q.never,received:t.parsedType}),Q}};vt.create=s=>new vt({typeName:O.ZodNever,...ee(s)});var us=class extends te{_parse(e){if(this._getType(e)!==q.undefined){let n=this._getOrReturnCtx(e);return F(n,{code:I.invalid_type,expected:q.void,received:n.parsedType}),Q}return We(e.data)}};us.create=s=>new us({typeName:O.ZodVoid,...ee(s)});var Ft=class s extends te{_parse(e){let{ctx:t,status:n}=this._processInputParams(e),r=this._def;if(t.parsedType!==q.array)return F(t,{code:I.invalid_type,expected:q.array,received:t.parsedType}),Q;if(r.exactLength!==null){let o=t.data.length>r.exactLength.value,i=t.data.length<r.exactLength.value;(o||i)&&(F(t,{code:o?I.too_big:I.too_small,minimum:i?r.exactLength.value:void 0,maximum:o?r.exactLength.value:void 0,type:"array",inclusive:!0,exact:!0,message:r.exactLength.message}),n.dirty())}if(r.minLength!==null&&t.data.length<r.minLength.value&&(F(t,{code:I.too_small,minimum:r.minLength.value,type:"array",inclusive:!0,exact:!1,message:r.minLength.message}),n.dirty()),r.maxLength!==null&&t.data.length>r.maxLength.value&&(F(t,{code:I.too_big,maximum:r.maxLength.value,type:"array",inclusive:!0,exact:!1,message:r.maxLength.message}),n.dirty()),t.common.async)return Promise.all([...t.data].map((o,i)=>r.type._parseAsync(new ut(t,o,t.path,i)))).then(o=>Fe.mergeArray(n,o));let a=[...t.data].map((o,i)=>r.type._parseSync(new ut(t,o,t.path,i)));return Fe.mergeArray(n,a)}get element(){return this._def.type}min(e,t){return new s({...this._def,minLength:{value:e,message:z.toString(t)}})}max(e,t){return new s({...this._def,maxLength:{value:e,message:z.toString(t)}})}length(e,t){return new s({...this._def,exactLength:{value:e,message:z.toString(t)}})}nonempty(e){return this.min(1,e)}};Ft.create=(s,e)=>new Ft({type:s,minLength:null,maxLength:null,exactLength:null,typeName:O.ZodArray,...ee(e)});function cs(s){if(s instanceof Qe){let e={};for(let t in s.shape){let n=s.shape[t];e[t]=lt.create(cs(n))}return new Qe({...s._def,shape:()=>e})}else return s instanceof Ft?new Ft({...s._def,type:cs(s.element)}):s instanceof lt?lt.create(cs(s.unwrap())):s instanceof Rt?Rt.create(cs(s.unwrap())):s instanceof Ct?Ct.create(s.items.map(e=>cs(e))):s}var Qe=class s extends te{constructor(){super(...arguments),this._cached=null,this.nonstrict=this.passthrough,this.augment=this.extend}_getCached(){if(this._cached!==null)return this._cached;let e=this._def.shape(),t=ae.objectKeys(e);return this._cached={shape:e,keys:t},this._cached}_parse(e){if(this._getType(e)!==q.object){let u=this._getOrReturnCtx(e);return F(u,{code:I.invalid_type,expected:q.object,received:u.parsedType}),Q}let{status:n,ctx:r}=this._processInputParams(e),{shape:a,keys:o}=this._getCached(),i=[];if(!(this._def.catchall instanceof vt&&this._def.unknownKeys==="strip"))for(let u in r.data)o.includes(u)||i.push(u);let c=[];for(let u of o){let d=a[u],f=r.data[u];c.push({key:{status:"valid",value:u},value:d._parse(new ut(r,f,r.path,u)),alwaysSet:u in r.data})}if(this._def.catchall instanceof vt){let u=this._def.unknownKeys;if(u==="passthrough")for(let d of i)c.push({key:{status:"valid",value:d},value:{status:"valid",value:r.data[d]}});else if(u==="strict")i.length>0&&(F(r,{code:I.unrecognized_keys,keys:i}),n.dirty());else if(u!=="strip")throw new Error("Internal ZodObject error: invalid unknownKeys value.")}else{let u=this._def.catchall;for(let d of i){let f=r.data[d];c.push({key:{status:"valid",value:d},value:u._parse(new ut(r,f,r.path,d)),alwaysSet:d in r.data})}}return r.common.async?Promise.resolve().then(async()=>{let u=[];for(let d of c){let f=await d.key,h=await d.value;u.push({key:f,value:h,alwaysSet:d.alwaysSet})}return u}).then(u=>Fe.mergeObjectSync(n,u)):Fe.mergeObjectSync(n,c)}get shape(){return this._def.shape()}strict(e){return z.errToObj,new s({...this._def,unknownKeys:"strict",...e!==void 0?{errorMap:(t,n)=>{let r=this._def.errorMap?.(t,n).message??n.defaultError;return t.code==="unrecognized_keys"?{message:z.errToObj(e).message??r}:{message:r}}}:{}})}strip(){return new s({...this._def,unknownKeys:"strip"})}passthrough(){return new s({...this._def,unknownKeys:"passthrough"})}extend(e){return new s({...this._def,shape:()=>({...this._def.shape(),...e})})}merge(e){return new s({unknownKeys:e._def.unknownKeys,catchall:e._def.catchall,shape:()=>({...this._def.shape(),...e._def.shape()}),typeName:O.ZodObject})}setKey(e,t){return this.augment({[e]:t})}catchall(e){return new s({...this._def,catchall:e})}pick(e){let t={};for(let n of ae.objectKeys(e))e[n]&&this.shape[n]&&(t[n]=this.shape[n]);return new s({...this._def,shape:()=>t})}omit(e){let t={};for(let n of ae.objectKeys(this.shape))e[n]||(t[n]=this.shape[n]);return new s({...this._def,shape:()=>t})}deepPartial(){return cs(this)}partial(e){let t={};for(let n of ae.objectKeys(this.shape)){let r=this.shape[n];e&&!e[n]?t[n]=r:t[n]=r.optional()}return new s({...this._def,shape:()=>t})}required(e){let t={};for(let n of ae.objectKeys(this.shape))if(e&&!e[n])t[n]=this.shape[n];else{let a=this.shape[n];for(;a instanceof lt;)a=a._def.innerType;t[n]=a}return new s({...this._def,shape:()=>t})}keyof(){return cf(ae.objectKeys(this.shape))}};Qe.create=(s,e)=>new Qe({shape:()=>s,unknownKeys:"strip",catchall:vt.create(),typeName:O.ZodObject,...ee(e)});Qe.strictCreate=(s,e)=>new Qe({shape:()=>s,unknownKeys:"strict",catchall:vt.create(),typeName:O.ZodObject,...ee(e)});Qe.lazycreate=(s,e)=>new Qe({shape:s,unknownKeys:"strip",catchall:vt.create(),typeName:O.ZodObject,...ee(e)});var _r=class extends te{_parse(e){let{ctx:t}=this._processInputParams(e),n=this._def.options;function r(a){for(let i of a)if(i.result.status==="valid")return i.result;for(let i of a)if(i.result.status==="dirty")return t.common.issues.push(...i.ctx.common.issues),i.result;let o=a.map(i=>new Je(i.ctx.common.issues));return F(t,{code:I.invalid_union,unionErrors:o}),Q}if(t.common.async)return Promise.all(n.map(async a=>{let o={...t,common:{...t.common,issues:[]},parent:null};return{result:await a._parseAsync({data:t.data,path:t.path,parent:o}),ctx:o}})).then(r);{let a,o=[];for(let c of n){let u={...t,common:{...t.common,issues:[]},parent:null},d=c._parseSync({data:t.data,path:t.path,parent:u});if(d.status==="valid")return d;d.status==="dirty"&&!a&&(a={result:d,ctx:u}),u.common.issues.length&&o.push(u.common.issues)}if(a)return t.common.issues.push(...a.ctx.common.issues),a.result;let i=o.map(c=>new Je(c));return F(t,{code:I.invalid_union,unionErrors:i}),Q}}get options(){return this._def.options}};_r.create=(s,e)=>new _r({options:s,typeName:O.ZodUnion,...ee(e)});var Lt=s=>s instanceof Cr?Lt(s.schema):s instanceof dt?Lt(s.innerType()):s instanceof Rr?[s.value]:s instanceof Tr?s.options:s instanceof Ar?ae.objectValues(s.enum):s instanceof Ir?Lt(s._def.innerType):s instanceof Pr?[void 0]:s instanceof Sr?[null]:s instanceof lt?[void 0,...Lt(s.unwrap())]:s instanceof Rt?[null,...Lt(s.unwrap())]:s instanceof Ws||s instanceof Or?Lt(s.unwrap()):s instanceof kr?Lt(s._def.innerType):[],Hn=class s extends te{_parse(e){let{ctx:t}=this._processInputParams(e);if(t.parsedType!==q.object)return F(t,{code:I.invalid_type,expected:q.object,received:t.parsedType}),Q;let n=this.discriminator,r=t.data[n],a=this.optionsMap.get(r);return a?t.common.async?a._parseAsync({data:t.data,path:t.path,parent:t}):a._parseSync({data:t.data,path:t.path,parent:t}):(F(t,{code:I.invalid_union_discriminator,options:Array.from(this.optionsMap.keys()),path:[n]}),Q)}get discriminator(){return this._def.discriminator}get options(){return this._def.options}get optionsMap(){return this._def.optionsMap}static create(e,t,n){let r=new Map;for(let a of t){let o=Lt(a.shape[e]);if(!o.length)throw new Error(`A discriminator value for key \`${e}\` could not be extracted from all schema options`);for(let i of o){if(r.has(i))throw new Error(`Discriminator property ${String(e)} has duplicate value ${String(i)}`);r.set(i,a)}}return new s({typeName:O.ZodDiscriminatedUnion,discriminator:e,options:t,optionsMap:r,...ee(n)})}};function Vo(s,e){let t=Et(s),n=Et(e);if(s===e)return{valid:!0,data:s};if(t===q.object&&n===q.object){let r=ae.objectKeys(e),a=ae.objectKeys(s).filter(i=>r.indexOf(i)!==-1),o={...s,...e};for(let i of a){let c=Vo(s[i],e[i]);if(!c.valid)return{valid:!1};o[i]=c.data}return{valid:!0,data:o}}else if(t===q.array&&n===q.array){if(s.length!==e.length)return{valid:!1};let r=[];for(let a=0;a<s.length;a++){let o=s[a],i=e[a],c=Vo(o,i);if(!c.valid)return{valid:!1};r.push(c.data)}return{valid:!0,data:r}}else return t===q.date&&n===q.date&&+s==+e?{valid:!0,data:s}:{valid:!1}}var Er=class extends te{_parse(e){let{status:t,ctx:n}=this._processInputParams(e),r=(a,o)=>{if(Wn(a)||Wn(o))return Q;let i=Vo(a.value,o.value);return i.valid?((Vn(a)||Vn(o))&&t.dirty(),{status:t.value,value:i.data}):(F(n,{code:I.invalid_intersection_types}),Q)};return n.common.async?Promise.all([this._def.left._parseAsync({data:n.data,path:n.path,parent:n}),this._def.right._parseAsync({data:n.data,path:n.path,parent:n})]).then(([a,o])=>r(a,o)):r(this._def.left._parseSync({data:n.data,path:n.path,parent:n}),this._def.right._parseSync({data:n.data,path:n.path,parent:n}))}};Er.create=(s,e,t)=>new Er({left:s,right:e,typeName:O.ZodIntersection,...ee(t)});var Ct=class s extends te{_parse(e){let{status:t,ctx:n}=this._processInputParams(e);if(n.parsedType!==q.array)return F(n,{code:I.invalid_type,expected:q.array,received:n.parsedType}),Q;if(n.data.length<this._def.items.length)return F(n,{code:I.too_small,minimum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),Q;!this._def.rest&&n.data.length>this._def.items.length&&(F(n,{code:I.too_big,maximum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),t.dirty());let a=[...n.data].map((o,i)=>{let c=this._def.items[i]||this._def.rest;return c?c._parse(new ut(n,o,n.path,i)):null}).filter(o=>!!o);return n.common.async?Promise.all(a).then(o=>Fe.mergeArray(t,o)):Fe.mergeArray(t,a)}get items(){return this._def.items}rest(e){return new s({...this._def,rest:e})}};Ct.create=(s,e)=>{if(!Array.isArray(s))throw new Error("You must pass an array of schemas to z.tuple([ ... ])");return new Ct({items:s,typeName:O.ZodTuple,rest:null,...ee(e)})};var Bn=class s extends te{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){let{status:t,ctx:n}=this._processInputParams(e);if(n.parsedType!==q.object)return F(n,{code:I.invalid_type,expected:q.object,received:n.parsedType}),Q;let r=[],a=this._def.keyType,o=this._def.valueType;for(let i in n.data)r.push({key:a._parse(new ut(n,i,n.path,i)),value:o._parse(new ut(n,n.data[i],n.path,i)),alwaysSet:i in n.data});return n.common.async?Fe.mergeObjectAsync(t,r):Fe.mergeObjectSync(t,r)}get element(){return this._def.valueType}static create(e,t,n){return t instanceof te?new s({keyType:e,valueType:t,typeName:O.ZodRecord,...ee(n)}):new s({keyType:zt.create(),valueType:e,typeName:O.ZodRecord,...ee(t)})}},ds=class extends te{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){let{status:t,ctx:n}=this._processInputParams(e);if(n.parsedType!==q.map)return F(n,{code:I.invalid_type,expected:q.map,received:n.parsedType}),Q;let r=this._def.keyType,a=this._def.valueType,o=[...n.data.entries()].map(([i,c],u)=>({key:r._parse(new ut(n,i,n.path,[u,"key"])),value:a._parse(new ut(n,c,n.path,[u,"value"]))}));if(n.common.async){let i=new Map;return Promise.resolve().then(async()=>{for(let c of o){let u=await c.key,d=await c.value;if(u.status==="aborted"||d.status==="aborted")return Q;(u.status==="dirty"||d.status==="dirty")&&t.dirty(),i.set(u.value,d.value)}return{status:t.value,value:i}})}else{let i=new Map;for(let c of o){let u=c.key,d=c.value;if(u.status==="aborted"||d.status==="aborted")return Q;(u.status==="dirty"||d.status==="dirty")&&t.dirty(),i.set(u.value,d.value)}return{status:t.value,value:i}}}};ds.create=(s,e,t)=>new ds({valueType:e,keyType:s,typeName:O.ZodMap,...ee(t)});var ps=class s extends te{_parse(e){let{status:t,ctx:n}=this._processInputParams(e);if(n.parsedType!==q.set)return F(n,{code:I.invalid_type,expected:q.set,received:n.parsedType}),Q;let r=this._def;r.minSize!==null&&n.data.size<r.minSize.value&&(F(n,{code:I.too_small,minimum:r.minSize.value,type:"set",inclusive:!0,exact:!1,message:r.minSize.message}),t.dirty()),r.maxSize!==null&&n.data.size>r.maxSize.value&&(F(n,{code:I.too_big,maximum:r.maxSize.value,type:"set",inclusive:!0,exact:!1,message:r.maxSize.message}),t.dirty());let a=this._def.valueType;function o(c){let u=new Set;for(let d of c){if(d.status==="aborted")return Q;d.status==="dirty"&&t.dirty(),u.add(d.value)}return{status:t.value,value:u}}let i=[...n.data.values()].map((c,u)=>a._parse(new ut(n,c,n.path,u)));return n.common.async?Promise.all(i).then(c=>o(c)):o(i)}min(e,t){return new s({...this._def,minSize:{value:e,message:z.toString(t)}})}max(e,t){return new s({...this._def,maxSize:{value:e,message:z.toString(t)}})}size(e,t){return this.min(e,t).max(e,t)}nonempty(e){return this.min(1,e)}};ps.create=(s,e)=>new ps({valueType:s,minSize:null,maxSize:null,typeName:O.ZodSet,...ee(e)});var zn=class s extends te{constructor(){super(...arguments),this.validate=this.implement}_parse(e){let{ctx:t}=this._processInputParams(e);if(t.parsedType!==q.function)return F(t,{code:I.invalid_type,expected:q.function,received:t.parsedType}),Q;function n(i,c){return Us({data:i,path:t.path,errorMaps:[t.common.contextualErrorMap,t.schemaErrorMap,os(),Mt].filter(u=>!!u),issueData:{code:I.invalid_arguments,argumentsError:c}})}function r(i,c){return Us({data:i,path:t.path,errorMaps:[t.common.contextualErrorMap,t.schemaErrorMap,os(),Mt].filter(u=>!!u),issueData:{code:I.invalid_return_type,returnTypeError:c}})}let a={errorMap:t.common.contextualErrorMap},o=t.data;if(this._def.returns instanceof Kt){let i=this;return We(async function(...c){let u=new Je([]),d=await i._def.args.parseAsync(c,a).catch(p=>{throw u.addIssue(n(c,p)),u}),f=await Reflect.apply(o,this,d);return await i._def.returns._def.type.parseAsync(f,a).catch(p=>{throw u.addIssue(r(f,p)),u})})}else{let i=this;return We(function(...c){let u=i._def.args.safeParse(c,a);if(!u.success)throw new Je([n(c,u.error)]);let d=Reflect.apply(o,this,u.data),f=i._def.returns.safeParse(d,a);if(!f.success)throw new Je([r(d,f.error)]);return f.data})}}parameters(){return this._def.args}returnType(){return this._def.returns}args(...e){return new s({...this._def,args:Ct.create(e).rest(Nt.create())})}returns(e){return new s({...this._def,returns:e})}implement(e){return this.parse(e)}strictImplement(e){return this.parse(e)}static create(e,t,n){return new s({args:e||Ct.create([]).rest(Nt.create()),returns:t||Nt.create(),typeName:O.ZodFunction,...ee(n)})}},Cr=class extends te{get schema(){return this._def.getter()}_parse(e){let{ctx:t}=this._processInputParams(e);return this._def.getter()._parse({data:t.data,path:t.path,parent:t})}};Cr.create=(s,e)=>new Cr({getter:s,typeName:O.ZodLazy,...ee(e)});var Rr=class extends te{_parse(e){if(e.data!==this._def.value){let t=this._getOrReturnCtx(e);return F(t,{received:t.data,code:I.invalid_literal,expected:this._def.value}),Q}return{status:"valid",value:e.data}}get value(){return this._def.value}};Rr.create=(s,e)=>new Rr({value:s,typeName:O.ZodLiteral,...ee(e)});function cf(s,e){return new Tr({values:s,typeName:O.ZodEnum,...ee(e)})}var Tr=class s extends te{_parse(e){if(typeof e.data!="string"){let t=this._getOrReturnCtx(e),n=this._def.values;return F(t,{expected:ae.joinValues(n),received:t.parsedType,code:I.invalid_type}),Q}if(this._cache||(this._cache=new Set(this._def.values)),!this._cache.has(e.data)){let t=this._getOrReturnCtx(e),n=this._def.values;return F(t,{received:t.data,code:I.invalid_enum_value,options:n}),Q}return We(e.data)}get options(){return this._def.values}get enum(){let e={};for(let t of this._def.values)e[t]=t;return e}get Values(){let e={};for(let t of this._def.values)e[t]=t;return e}get Enum(){let e={};for(let t of this._def.values)e[t]=t;return e}extract(e,t=this._def){return s.create(e,{...this._def,...t})}exclude(e,t=this._def){return s.create(this.options.filter(n=>!e.includes(n)),{...this._def,...t})}};Tr.create=cf;var Ar=class extends te{_parse(e){let t=ae.getValidEnumValues(this._def.values),n=this._getOrReturnCtx(e);if(n.parsedType!==q.string&&n.parsedType!==q.number){let r=ae.objectValues(t);return F(n,{expected:ae.joinValues(r),received:n.parsedType,code:I.invalid_type}),Q}if(this._cache||(this._cache=new Set(ae.getValidEnumValues(this._def.values))),!this._cache.has(e.data)){let r=ae.objectValues(t);return F(n,{received:n.data,code:I.invalid_enum_value,options:r}),Q}return We(e.data)}get enum(){return this._def.values}};Ar.create=(s,e)=>new Ar({values:s,typeName:O.ZodNativeEnum,...ee(e)});var Kt=class extends te{unwrap(){return this._def.type}_parse(e){let{ctx:t}=this._processInputParams(e);if(t.parsedType!==q.promise&&t.common.async===!1)return F(t,{code:I.invalid_type,expected:q.promise,received:t.parsedType}),Q;let n=t.parsedType===q.promise?t.data:Promise.resolve(t.data);return We(n.then(r=>this._def.type.parseAsync(r,{path:t.path,errorMap:t.common.contextualErrorMap})))}};Kt.create=(s,e)=>new Kt({type:s,typeName:O.ZodPromise,...ee(e)});var dt=class extends te{innerType(){return this._def.schema}sourceType(){return this._def.schema._def.typeName===O.ZodEffects?this._def.schema.sourceType():this._def.schema}_parse(e){let{status:t,ctx:n}=this._processInputParams(e),r=this._def.effect||null,a={addIssue:o=>{F(n,o),o.fatal?t.abort():t.dirty()},get path(){return n.path}};if(a.addIssue=a.addIssue.bind(a),r.type==="preprocess"){let o=r.transform(n.data,a);if(n.common.async)return Promise.resolve(o).then(async i=>{if(t.value==="aborted")return Q;let c=await this._def.schema._parseAsync({data:i,path:n.path,parent:n});return c.status==="aborted"?Q:c.status==="dirty"?vr(c.value):t.value==="dirty"?vr(c.value):c});{if(t.value==="aborted")return Q;let i=this._def.schema._parseSync({data:o,path:n.path,parent:n});return i.status==="aborted"?Q:i.status==="dirty"?vr(i.value):t.value==="dirty"?vr(i.value):i}}if(r.type==="refinement"){let o=i=>{let c=r.refinement(i,a);if(n.common.async)return Promise.resolve(c);if(c instanceof Promise)throw new Error("Async refinement encountered during synchronous parse operation. Use .parseAsync instead.");return i};if(n.common.async===!1){let i=this._def.schema._parseSync({data:n.data,path:n.path,parent:n});return i.status==="aborted"?Q:(i.status==="dirty"&&t.dirty(),o(i.value),{status:t.value,value:i.value})}else return this._def.schema._parseAsync({data:n.data,path:n.path,parent:n}).then(i=>i.status==="aborted"?Q:(i.status==="dirty"&&t.dirty(),o(i.value).then(()=>({status:t.value,value:i.value}))))}if(r.type==="transform")if(n.common.async===!1){let o=this._def.schema._parseSync({data:n.data,path:n.path,parent:n});if(!Bt(o))return Q;let i=r.transform(o.value,a);if(i instanceof Promise)throw new Error("Asynchronous transform encountered during synchronous parse operation. Use .parseAsync instead.");return{status:t.value,value:i}}else return this._def.schema._parseAsync({data:n.data,path:n.path,parent:n}).then(o=>Bt(o)?Promise.resolve(r.transform(o.value,a)).then(i=>({status:t.value,value:i})):Q);ae.assertNever(r)}};dt.create=(s,e,t)=>new dt({schema:s,typeName:O.ZodEffects,effect:e,...ee(t)});dt.createWithPreprocess=(s,e,t)=>new dt({schema:e,effect:{type:"preprocess",transform:s},typeName:O.ZodEffects,...ee(t)});var lt=class extends te{_parse(e){return this._getType(e)===q.undefined?We(void 0):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}};lt.create=(s,e)=>new lt({innerType:s,typeName:O.ZodOptional,...ee(e)});var Rt=class extends te{_parse(e){return this._getType(e)===q.null?We(null):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}};Rt.create=(s,e)=>new Rt({innerType:s,typeName:O.ZodNullable,...ee(e)});var Ir=class extends te{_parse(e){let{ctx:t}=this._processInputParams(e),n=t.data;return t.parsedType===q.undefined&&(n=this._def.defaultValue()),this._def.innerType._parse({data:n,path:t.path,parent:t})}removeDefault(){return this._def.innerType}};Ir.create=(s,e)=>new Ir({innerType:s,typeName:O.ZodDefault,defaultValue:typeof e.default=="function"?e.default:()=>e.default,...ee(e)});var kr=class extends te{_parse(e){let{ctx:t}=this._processInputParams(e),n={...t,common:{...t.common,issues:[]}},r=this._def.innerType._parse({data:n.data,path:n.path,parent:{...n}});return is(r)?r.then(a=>({status:"valid",value:a.status==="valid"?a.value:this._def.catchValue({get error(){return new Je(n.common.issues)},input:n.data})})):{status:"valid",value:r.status==="valid"?r.value:this._def.catchValue({get error(){return new Je(n.common.issues)},input:n.data})}}removeCatch(){return this._def.innerType}};kr.create=(s,e)=>new kr({innerType:s,typeName:O.ZodCatch,catchValue:typeof e.catch=="function"?e.catch:()=>e.catch,...ee(e)});var fs=class extends te{_parse(e){if(this._getType(e)!==q.nan){let n=this._getOrReturnCtx(e);return F(n,{code:I.invalid_type,expected:q.nan,received:n.parsedType}),Q}return{status:"valid",value:e.data}}};fs.create=s=>new fs({typeName:O.ZodNaN,...ee(s)});var q_=Symbol("zod_brand"),Ws=class extends te{_parse(e){let{ctx:t}=this._processInputParams(e),n=t.data;return this._def.type._parse({data:n,path:t.path,parent:t})}unwrap(){return this._def.type}},Vs=class s extends te{_parse(e){let{status:t,ctx:n}=this._processInputParams(e);if(n.common.async)return(async()=>{let a=await this._def.in._parseAsync({data:n.data,path:n.path,parent:n});return a.status==="aborted"?Q:a.status==="dirty"?(t.dirty(),vr(a.value)):this._def.out._parseAsync({data:a.value,path:n.path,parent:n})})();{let r=this._def.in._parseSync({data:n.data,path:n.path,parent:n});return r.status==="aborted"?Q:r.status==="dirty"?(t.dirty(),{status:"dirty",value:r.value}):this._def.out._parseSync({data:r.value,path:n.path,parent:n})}}static create(e,t){return new s({in:e,out:t,typeName:O.ZodPipeline})}},Or=class extends te{_parse(e){let t=this._def.innerType._parse(e),n=r=>(Bt(r)&&(r.value=Object.freeze(r.value)),r);return is(t)?t.then(r=>n(r)):n(t)}unwrap(){return this._def.innerType}};Or.create=(s,e)=>new Or({innerType:s,typeName:O.ZodReadonly,...ee(e)});function sf(s,e){let t=typeof s=="function"?s(e):typeof s=="string"?{message:s}:s;return typeof t=="string"?{message:t}:t}function lf(s,e={},t){return s?Gt.create().superRefine((n,r)=>{let a=s(n);if(a instanceof Promise)return a.then(o=>{if(!o){let i=sf(e,n),c=i.fatal??t??!0;r.addIssue({code:"custom",...i,fatal:c})}});if(!a){let o=sf(e,n),i=o.fatal??t??!0;r.addIssue({code:"custom",...o,fatal:i})}}):Gt.create()}var U_={object:Qe.lazycreate},O;(function(s){s.ZodString="ZodString",s.ZodNumber="ZodNumber",s.ZodNaN="ZodNaN",s.ZodBigInt="ZodBigInt",s.ZodBoolean="ZodBoolean",s.ZodDate="ZodDate",s.ZodSymbol="ZodSymbol",s.ZodUndefined="ZodUndefined",s.ZodNull="ZodNull",s.ZodAny="ZodAny",s.ZodUnknown="ZodUnknown",s.ZodNever="ZodNever",s.ZodVoid="ZodVoid",s.ZodArray="ZodArray",s.ZodObject="ZodObject",s.ZodUnion="ZodUnion",s.ZodDiscriminatedUnion="ZodDiscriminatedUnion",s.ZodIntersection="ZodIntersection",s.ZodTuple="ZodTuple",s.ZodRecord="ZodRecord",s.ZodMap="ZodMap",s.ZodSet="ZodSet",s.ZodFunction="ZodFunction",s.ZodLazy="ZodLazy",s.ZodLiteral="ZodLiteral",s.ZodEnum="ZodEnum",s.ZodEffects="ZodEffects",s.ZodNativeEnum="ZodNativeEnum",s.ZodOptional="ZodOptional",s.ZodNullable="ZodNullable",s.ZodDefault="ZodDefault",s.ZodCatch="ZodCatch",s.ZodPromise="ZodPromise",s.ZodBranded="ZodBranded",s.ZodPipeline="ZodPipeline",s.ZodReadonly="ZodReadonly"})(O||(O={}));var W_=(s,e={message:`Input not instance of ${s.name}`})=>lf(t=>t instanceof s,e),uf=zt.create,df=yr.create,V_=fs.create,H_=br.create,pf=xr.create,B_=wr.create,z_=ls.create,G_=Pr.create,K_=Sr.create,Z_=Gt.create,J_=Nt.create,Q_=vt.create,X_=us.create,Y_=Ft.create,eE=Qe.create,tE=Qe.strictCreate,rE=_r.create,sE=Hn.create,nE=Er.create,aE=Ct.create,oE=Bn.create,iE=ds.create,cE=ps.create,lE=zn.create,uE=Cr.create,dE=Rr.create,pE=Tr.create,fE=Ar.create,hE=Kt.create,mE=dt.create,gE=lt.create,vE=Rt.create,yE=dt.createWithPreprocess,bE=Vs.create,xE=()=>uf().optional(),wE=()=>df().optional(),PE=()=>pf().optional(),SE={string:s=>zt.create({...s,coerce:!0}),number:s=>yr.create({...s,coerce:!0}),boolean:s=>xr.create({...s,coerce:!0}),bigint:s=>br.create({...s,coerce:!0}),date:s=>wr.create({...s,coerce:!0})};var _E=Q;var EE=["error","warning","information","hint"],CE={error:Te.DiagnosticSeverity.Error,warning:Te.DiagnosticSeverity.Warning,information:Te.DiagnosticSeverity.Information,hint:Te.DiagnosticSeverity.Hint},ff=l.object({maxDiagnostics:l.number().int().positive().max(1e3).default(50),file:l.string().optional(),source:l.union([l.string(),l.array(l.string())]).optional(),code:l.union([l.string(),l.array(l.string())]).optional(),includeNonWorkspaceDiagnostics:l.boolean().default(!1),minSeverity:l.enum(EE).default("information")}),hf=l.object({diagnostics:l.array(l.object({filePath:l.string(),relativePath:l.string().nullable(),range:l.object({start:l.object({line:l.number().int().nonnegative(),character:l.number().int().nonnegative()}),end:l.object({line:l.number().int().nonnegative(),character:l.number().int().nonnegative()})}),severity:l.string(),source:l.string().nullable(),code:l.string().nullable(),message:l.string()})),returnedDiagnostics:l.number().int().nonnegative(),totalDiagnosticsAfterFiltering:l.number().int().nonnegative(),limit:l.number().int().positive(),truncated:l.boolean(),summary:l.array(l.string())});function mf(s){s.registerTool("vscodeDiagnostics",{title:"VS Code Diagnostics",description:"Retrieve diagnostics from vscode.languages.getDiagnostics() with optional filters.",inputSchema:ff.shape,outputSchema:hf.shape},async e=>{let{maxDiagnostics:t,file:n,source:r,code:a,minSeverity:o,includeNonWorkspaceDiagnostics:i}=ff.parse(e),c=r?new Set(Array.isArray(r)?r:[r]):void 0,u=a?new Set(Array.isArray(a)?a:[a]):void 0,d=n?AE(n):void 0,f=RE(d),h=TE(f,n,CE[o],i,c,u),p=h.slice(0,t),g=hf.parse($E(p,t,h.length));return{content:[{type:"text",text:g.summary.join(`
`)}],structuredContent:g}})}function RE(s){if(s)return Te.languages.getDiagnostics(s).map(t=>({uri:s,diagnostic:t}));let e=[];for(let[t,n]of Te.languages.getDiagnostics())for(let r of n)e.push({uri:t,diagnostic:r});return e}function TE(s,e,t,n,r,a){let o=[];for(let i of s)e&&!kE(i.uri,e)||(i.diagnostic.severity??Te.DiagnosticSeverity.Error)>t||!n&&!e&&!IE(i.uri)||r&&!OE(i.diagnostic,r)||a&&!DE(i.diagnostic,a)||o.push(i);return o}function AE(s){let e=gf(s);if(e)return e;let t=Te.workspace.workspaceFolders;if(!t||t.length===0)return;let n=Hs(s);for(let r of t){let a=Zt.join(r.uri.fsPath,s);if(Hs(a).endsWith(n))return Te.Uri.file(a)}}function IE(s){return Te.workspace.getWorkspaceFolder(s)!==void 0}function kE(s,e){let t=gf(e);if(t)return Ho(s)===Ho(t);let n=Hs(e),r=vf(s);return r&&Hs(r)===n?!0:Ho(s).endsWith(n)}function gf(s){if(s.startsWith("file:"))try{let e=Te.Uri.parse(s);if(e.scheme==="file")return e}catch{return}if(Zt.isAbsolute(s))return Te.Uri.file(s)}function Ho(s){return Hs(s.fsPath)}function Hs(s){let e=Zt.normalize(s).replace(/\\/g,"/");return typeof process<"u"&&process.platform==="win32"?e.toLowerCase():e}function OE(s,e){let t=s.source;return t?e.has(t):!1}function DE(s,e){let t=s.code;if(t===void 0)return!1;let n=typeof t=="object"&&"value"in t?String(t.value):String(t);return e.has(n)}function $E(s,e,t){let n=[],r=[],a=1;for(let{uri:c,diagnostic:u}of s){let d=vf(c),f=u.range,h=f.start.line+1,p=f.start.character+1,g=ME(u.severity),y=u.source??null,v=LE(u.code),w=[`${a}. ${d??c.fsPath}:${h}:${p}`,`[${g}]`];y?w.push(`(${y}${v?`:${v}`:""})`):v&&w.push(`(${v})`),n.push(`${w.join(" ")}
${u.message}`),r.push({filePath:c.fsPath,relativePath:d??null,range:{start:{line:f.start.line,character:f.start.character},end:{line:f.end.line,character:f.end.character}},severity:g,source:y,code:v,message:u.message}),a=a+1}let o=t>s.length,i=n.length>0?[`Returned ${s.length} diagnostics (limit ${e}, total after filtering ${t}, truncated: ${o?"yes":"no"}).`,"",...n]:[`Returned 0 diagnostics (limit ${e}, total after filtering ${t}, truncated: no).`];return{diagnostics:r,returnedDiagnostics:s.length,totalDiagnosticsAfterFiltering:t,limit:e,truncated:o,summary:i}}function vf(s){let e=Te.workspace.getWorkspaceFolder(s);if(e)return Zt.relative(e.uri.fsPath,s.fsPath)}function ME(s){switch(s){case Te.DiagnosticSeverity.Error:return"error";case Te.DiagnosticSeverity.Warning:return"warning";case Te.DiagnosticSeverity.Information:return"information";case Te.DiagnosticSeverity.Hint:return"hint"}}function LE(s){return s===void 0?null:typeof s=="object"&&"value"in s?String(s.value):String(s)}Pe();var Bo="2025-06-18";var yf=[Bo,"2025-03-26","2024-11-05","2024-10-07"],Gn="2.0",bf=l.union([l.string(),l.number().int()]),xf=l.string(),NE=l.object({progressToken:l.optional(bf)}).passthrough(),pt=l.object({_meta:l.optional(NE)}).passthrough(),Xe=l.object({method:l.string(),params:l.optional(pt)}),Bs=l.object({_meta:l.optional(l.object({}).passthrough())}).passthrough(),Tt=l.object({method:l.string(),params:l.optional(Bs)}),ft=l.object({_meta:l.optional(l.object({}).passthrough())}).passthrough(),Kn=l.union([l.string(),l.number().int()]),wf=l.object({jsonrpc:l.literal(Gn),id:Kn}).merge(Xe).strict(),Pf=s=>wf.safeParse(s).success,Sf=l.object({jsonrpc:l.literal(Gn)}).merge(Tt).strict(),_f=s=>Sf.safeParse(s).success,Ef=l.object({jsonrpc:l.literal(Gn),id:Kn,result:ft}).strict(),zo=s=>Ef.safeParse(s).success,me;(function(s){s[s.ConnectionClosed=-32e3]="ConnectionClosed",s[s.RequestTimeout=-32001]="RequestTimeout",s[s.ParseError=-32700]="ParseError",s[s.InvalidRequest=-32600]="InvalidRequest",s[s.MethodNotFound=-32601]="MethodNotFound",s[s.InvalidParams=-32602]="InvalidParams",s[s.InternalError=-32603]="InternalError"})(me||(me={}));var Cf=l.object({jsonrpc:l.literal(Gn),id:Kn,error:l.object({code:l.number().int(),message:l.string(),data:l.optional(l.unknown())})}).strict(),Rf=s=>Cf.safeParse(s).success,Tf=l.union([wf,Sf,Ef,Cf]),Zn=ft.strict(),Jn=Tt.extend({method:l.literal("notifications/cancelled"),params:Bs.extend({requestId:Kn,reason:l.string().optional()})}),FE=l.object({src:l.string(),mimeType:l.optional(l.string()),sizes:l.optional(l.array(l.string()))}).passthrough(),zs=l.object({icons:l.array(FE).optional()}).passthrough(),Gs=l.object({name:l.string(),title:l.optional(l.string())}).passthrough(),Af=Gs.extend({version:l.string(),websiteUrl:l.optional(l.string())}).merge(zs),jE=l.object({experimental:l.optional(l.object({}).passthrough()),sampling:l.optional(l.object({}).passthrough()),elicitation:l.optional(l.object({}).passthrough()),roots:l.optional(l.object({listChanged:l.optional(l.boolean())}).passthrough())}).passthrough(),Go=Xe.extend({method:l.literal("initialize"),params:pt.extend({protocolVersion:l.string(),capabilities:jE,clientInfo:Af})});var qE=l.object({experimental:l.optional(l.object({}).passthrough()),logging:l.optional(l.object({}).passthrough()),completions:l.optional(l.object({}).passthrough()),prompts:l.optional(l.object({listChanged:l.optional(l.boolean())}).passthrough()),resources:l.optional(l.object({subscribe:l.optional(l.boolean()),listChanged:l.optional(l.boolean())}).passthrough()),tools:l.optional(l.object({listChanged:l.optional(l.boolean())}).passthrough())}).passthrough(),UE=ft.extend({protocolVersion:l.string(),capabilities:qE,serverInfo:Af,instructions:l.optional(l.string())}),Ko=Tt.extend({method:l.literal("notifications/initialized")});var Qn=Xe.extend({method:l.literal("ping")}),WE=l.object({progress:l.number(),total:l.optional(l.number()),message:l.optional(l.string())}).passthrough(),Xn=Tt.extend({method:l.literal("notifications/progress"),params:Bs.merge(WE).extend({progressToken:bf})}),Yn=Xe.extend({params:pt.extend({cursor:l.optional(xf)}).optional()}),ea=ft.extend({nextCursor:l.optional(xf)}),If=l.object({uri:l.string(),mimeType:l.optional(l.string()),_meta:l.optional(l.object({}).passthrough())}).passthrough(),kf=If.extend({text:l.string()}),Zo=l.string().refine(s=>{try{return atob(s),!0}catch{return!1}},{message:"Invalid Base64 string"}),Of=If.extend({blob:Zo}),Df=Gs.extend({uri:l.string(),description:l.optional(l.string()),mimeType:l.optional(l.string()),_meta:l.optional(l.object({}).passthrough())}).merge(zs),VE=Gs.extend({uriTemplate:l.string(),description:l.optional(l.string()),mimeType:l.optional(l.string()),_meta:l.optional(l.object({}).passthrough())}).merge(zs),ta=Yn.extend({method:l.literal("resources/list")}),HE=ea.extend({resources:l.array(Df)}),ra=Yn.extend({method:l.literal("resources/templates/list")}),BE=ea.extend({resourceTemplates:l.array(VE)}),sa=Xe.extend({method:l.literal("resources/read"),params:pt.extend({uri:l.string()})}),zE=ft.extend({contents:l.array(l.union([kf,Of]))}),GE=Tt.extend({method:l.literal("notifications/resources/list_changed")}),KE=Xe.extend({method:l.literal("resources/subscribe"),params:pt.extend({uri:l.string()})}),ZE=Xe.extend({method:l.literal("resources/unsubscribe"),params:pt.extend({uri:l.string()})}),JE=Tt.extend({method:l.literal("notifications/resources/updated"),params:Bs.extend({uri:l.string()})}),QE=l.object({name:l.string(),description:l.optional(l.string()),required:l.optional(l.boolean())}).passthrough(),XE=Gs.extend({description:l.optional(l.string()),arguments:l.optional(l.array(QE)),_meta:l.optional(l.object({}).passthrough())}).merge(zs),na=Yn.extend({method:l.literal("prompts/list")}),YE=ea.extend({prompts:l.array(XE)}),aa=Xe.extend({method:l.literal("prompts/get"),params:pt.extend({name:l.string(),arguments:l.optional(l.record(l.string()))})}),Jo=l.object({type:l.literal("text"),text:l.string(),_meta:l.optional(l.object({}).passthrough())}).passthrough(),Qo=l.object({type:l.literal("image"),data:Zo,mimeType:l.string(),_meta:l.optional(l.object({}).passthrough())}).passthrough(),Xo=l.object({type:l.literal("audio"),data:Zo,mimeType:l.string(),_meta:l.optional(l.object({}).passthrough())}).passthrough(),e0=l.object({type:l.literal("resource"),resource:l.union([kf,Of]),_meta:l.optional(l.object({}).passthrough())}).passthrough(),t0=Df.extend({type:l.literal("resource_link")}),$f=l.union([Jo,Qo,Xo,t0,e0]),r0=l.object({role:l.enum(["user","assistant"]),content:$f}).passthrough(),s0=ft.extend({description:l.optional(l.string()),messages:l.array(r0)}),n0=Tt.extend({method:l.literal("notifications/prompts/list_changed")}),a0=l.object({title:l.optional(l.string()),readOnlyHint:l.optional(l.boolean()),destructiveHint:l.optional(l.boolean()),idempotentHint:l.optional(l.boolean()),openWorldHint:l.optional(l.boolean())}).passthrough(),o0=Gs.extend({description:l.optional(l.string()),inputSchema:l.object({type:l.literal("object"),properties:l.optional(l.object({}).passthrough()),required:l.optional(l.array(l.string()))}).passthrough(),outputSchema:l.optional(l.object({type:l.literal("object"),properties:l.optional(l.object({}).passthrough()),required:l.optional(l.array(l.string()))}).passthrough()),annotations:l.optional(a0),_meta:l.optional(l.object({}).passthrough())}).merge(zs),oa=Yn.extend({method:l.literal("tools/list")}),i0=ea.extend({tools:l.array(o0)}),Mf=ft.extend({content:l.array($f).default([]),structuredContent:l.object({}).passthrough().optional(),isError:l.optional(l.boolean())}),iD=Mf.or(ft.extend({toolResult:l.unknown()})),ia=Xe.extend({method:l.literal("tools/call"),params:pt.extend({name:l.string(),arguments:l.optional(l.record(l.unknown()))})}),c0=Tt.extend({method:l.literal("notifications/tools/list_changed")}),Ks=l.enum(["debug","info","notice","warning","error","critical","alert","emergency"]),Yo=Xe.extend({method:l.literal("logging/setLevel"),params:pt.extend({level:Ks})}),l0=Tt.extend({method:l.literal("notifications/message"),params:Bs.extend({level:Ks,logger:l.optional(l.string()),data:l.unknown()})}),u0=l.object({name:l.string().optional()}).passthrough(),d0=l.object({hints:l.optional(l.array(u0)),costPriority:l.optional(l.number().min(0).max(1)),speedPriority:l.optional(l.number().min(0).max(1)),intelligencePriority:l.optional(l.number().min(0).max(1))}).passthrough(),p0=l.object({role:l.enum(["user","assistant"]),content:l.union([Jo,Qo,Xo])}).passthrough(),f0=Xe.extend({method:l.literal("sampling/createMessage"),params:pt.extend({messages:l.array(p0),systemPrompt:l.optional(l.string()),includeContext:l.optional(l.enum(["none","thisServer","allServers"])),temperature:l.optional(l.number()),maxTokens:l.number().int(),stopSequences:l.optional(l.array(l.string())),metadata:l.optional(l.object({}).passthrough()),modelPreferences:l.optional(d0)})}),ei=ft.extend({model:l.string(),stopReason:l.optional(l.enum(["endTurn","stopSequence","maxTokens"]).or(l.string())),role:l.enum(["user","assistant"]),content:l.discriminatedUnion("type",[Jo,Qo,Xo])}),h0=l.object({type:l.literal("boolean"),title:l.optional(l.string()),description:l.optional(l.string()),default:l.optional(l.boolean())}).passthrough(),m0=l.object({type:l.literal("string"),title:l.optional(l.string()),description:l.optional(l.string()),minLength:l.optional(l.number()),maxLength:l.optional(l.number()),format:l.optional(l.enum(["email","uri","date","date-time"]))}).passthrough(),g0=l.object({type:l.enum(["number","integer"]),title:l.optional(l.string()),description:l.optional(l.string()),minimum:l.optional(l.number()),maximum:l.optional(l.number())}).passthrough(),v0=l.object({type:l.literal("string"),title:l.optional(l.string()),description:l.optional(l.string()),enum:l.array(l.string()),enumNames:l.optional(l.array(l.string()))}).passthrough(),y0=l.union([h0,m0,g0,v0]),b0=Xe.extend({method:l.literal("elicitation/create"),params:pt.extend({message:l.string(),requestedSchema:l.object({type:l.literal("object"),properties:l.record(l.string(),y0),required:l.optional(l.array(l.string()))}).passthrough()})}),ti=ft.extend({action:l.enum(["accept","decline","cancel"]),content:l.optional(l.record(l.string(),l.unknown()))}),x0=l.object({type:l.literal("ref/resource"),uri:l.string()}).passthrough();var w0=l.object({type:l.literal("ref/prompt"),name:l.string()}).passthrough(),ca=Xe.extend({method:l.literal("completion/complete"),params:pt.extend({ref:l.union([w0,x0]),argument:l.object({name:l.string(),value:l.string()}).passthrough(),context:l.optional(l.object({arguments:l.optional(l.record(l.string(),l.string()))}))})}),P0=ft.extend({completion:l.object({values:l.array(l.string()).max(100),total:l.optional(l.number().int()),hasMore:l.optional(l.boolean())}).passthrough()}),S0=l.object({uri:l.string().startsWith("file://"),name:l.optional(l.string()),_meta:l.optional(l.object({}).passthrough())}).passthrough(),_0=Xe.extend({method:l.literal("roots/list")}),ri=ft.extend({roots:l.array(S0)}),E0=Tt.extend({method:l.literal("notifications/roots/list_changed")}),cD=l.union([Qn,Go,ca,Yo,aa,na,ta,ra,sa,KE,ZE,ia,oa]),lD=l.union([Jn,Xn,Ko,E0]),uD=l.union([Zn,ei,ti,ri]),dD=l.union([Qn,f0,b0,_0]),pD=l.union([Jn,Xn,l0,JE,GE,c0,n0]),fD=l.union([Zn,UE,P0,s0,YE,HE,BE,zE,Mf,i0]),ge=class extends Error{constructor(e,t,n){super(`MCP error ${e}: ${t}`),this.code=e,this.data=n,this.name="McpError"}};var Lf=require("node:crypto"),Nf=require("node:events"),Ff=G(require("node:readline"));Re();var la=class{socket;rl;started=!1;protocolVersion;sessionId;onerror;onmessage;disposables=[];constructor(e){this.socket=e,this.sessionId=(0,Lf.randomUUID)(),this.rl=Ff.default.createInterface({input:this.socket,crlfDelay:1/0}),this.onerror=this.handleError.bind(this)}async start(){if(this.started)throw new Error("UnixDomainSocketTransport already started.");this.started=!0,this.socket.setEncoding("utf8"),this.socket.on("error",this.handleSocketError),this.socket.on("close",this.handleSocketClose),this.rl.on("line",this.handleLine),this.rl.on("close",this.handleReadlineClose)}async send(e,t){if(!this.started)throw new Error("Transport not started.");let n=JSON.stringify(e)+`
`;this.socket.write(n)||await(0,Nf.once)(this.socket,"drain")}addDisposable(e){this.disposables.push(e)}close(){T().info("UnixDomainSocketTransport.close() called."),this.disposables.forEach(t=>t.dispose());let e=this.started;return this.started=!1,this.detachListeners(),e&&this.socket.end(),this.socket.destroy(),this.rl.close(),Promise.resolve()}setProtocolVersion(e){this.protocolVersion=e}handleError(e){T().error(`UnixDomainSocketTransport error: ${e.stack??e.message}`)}handleSocketError=e=>{let t=e instanceof Error?e:new Error(String(e));this.onerror(t)};handleSocketClose=()=>{this.detachListeners(),this.rl.close()};handleLine=e=>{if(e.trim())try{let t=Tf.parse(JSON.parse(e));this.onmessage?.(t)}catch(t){this.onerror(t instanceof Error?t:new Error(String(t)))}};handleReadlineClose=()=>{this.rl.removeAllListeners()};detachListeners(){this.socket.removeListener("error",this.handleSocketError),this.socket.removeListener("close",this.handleSocketClose),this.rl.removeListener("line",this.handleLine),this.rl.removeListener("close",this.handleReadlineClose)}};var jf=require("node:events"),si=require("node:fs"),qf=G(require("node:net")),ua=class{constructor(e){this.socketPath=e}server=null;transports=new Set;async listen(e){if(this.server)throw new Error("UnixDomainSocketServer is already listening.");await this.removeExistingSocket(),this.server=qf.default.createServer(t=>{let n=new la(t);this.transports.add(n),t.once("close",()=>{this.transports.delete(n)}),Promise.resolve(e(n)).catch(r=>{let a=r instanceof Error?r:new Error(String(r));n.onerror(a),n.close()})}),this.server.on("error",t=>{let n=t instanceof Error?t:new Error(String(t));process.stderr.write(`${n.stack??n.message}
`)}),this.server.listen(this.socketPath),this.server.listening||await(0,jf.once)(this.server,"listening")}async close(){let e=this.server;this.server=null;let t=[...this.transports].map(n=>n.close().catch(()=>{}));this.transports.clear(),await Promise.all(t),e&&e.listening&&await new Promise(n=>e.close(()=>n())),await this.removeExistingSocket()}async removeExistingSocket(){try{if((await si.promises.lstat(this.socketPath)).isSocket())await si.promises.unlink(this.socketPath);else throw new Error(`Cannot reuse ${this.socketPath}: existing path is not a socket.`)}catch(e){if(e.code!=="ENOENT")throw e}}};var C0=6e4,da=class{constructor(e){this._options=e,this._requestMessageId=0,this._requestHandlers=new Map,this._requestHandlerAbortControllers=new Map,this._notificationHandlers=new Map,this._responseHandlers=new Map,this._progressHandlers=new Map,this._timeoutInfo=new Map,this._pendingDebouncedNotifications=new Set,this.setNotificationHandler(Jn,t=>{let n=this._requestHandlerAbortControllers.get(t.params.requestId);n?.abort(t.params.reason)}),this.setNotificationHandler(Xn,t=>{this._onprogress(t)}),this.setRequestHandler(Qn,t=>({}))}_setupTimeout(e,t,n,r,a=!1){this._timeoutInfo.set(e,{timeoutId:setTimeout(r,t),startTime:Date.now(),timeout:t,maxTotalTimeout:n,resetTimeoutOnProgress:a,onTimeout:r})}_resetTimeout(e){let t=this._timeoutInfo.get(e);if(!t)return!1;let n=Date.now()-t.startTime;if(t.maxTotalTimeout&&n>=t.maxTotalTimeout)throw this._timeoutInfo.delete(e),new ge(me.RequestTimeout,"Maximum total timeout exceeded",{maxTotalTimeout:t.maxTotalTimeout,totalElapsed:n});return clearTimeout(t.timeoutId),t.timeoutId=setTimeout(t.onTimeout,t.timeout),!0}_cleanupTimeout(e){let t=this._timeoutInfo.get(e);t&&(clearTimeout(t.timeoutId),this._timeoutInfo.delete(e))}async connect(e){var t,n,r;this._transport=e;let a=(t=this.transport)===null||t===void 0?void 0:t.onclose;this._transport.onclose=()=>{a?.(),this._onclose()};let o=(n=this.transport)===null||n===void 0?void 0:n.onerror;this._transport.onerror=c=>{o?.(c),this._onerror(c)};let i=(r=this._transport)===null||r===void 0?void 0:r.onmessage;this._transport.onmessage=(c,u)=>{i?.(c,u),zo(c)||Rf(c)?this._onresponse(c):Pf(c)?this._onrequest(c,u):_f(c)?this._onnotification(c):this._onerror(new Error(`Unknown message type: ${JSON.stringify(c)}`))},await this._transport.start()}_onclose(){var e;let t=this._responseHandlers;this._responseHandlers=new Map,this._progressHandlers.clear(),this._pendingDebouncedNotifications.clear(),this._transport=void 0,(e=this.onclose)===null||e===void 0||e.call(this);let n=new ge(me.ConnectionClosed,"Connection closed");for(let r of t.values())r(n)}_onerror(e){var t;(t=this.onerror)===null||t===void 0||t.call(this,e)}_onnotification(e){var t;let n=(t=this._notificationHandlers.get(e.method))!==null&&t!==void 0?t:this.fallbackNotificationHandler;n!==void 0&&Promise.resolve().then(()=>n(e)).catch(r=>this._onerror(new Error(`Uncaught error in notification handler: ${r}`)))}_onrequest(e,t){var n,r;let a=(n=this._requestHandlers.get(e.method))!==null&&n!==void 0?n:this.fallbackRequestHandler,o=this._transport;if(a===void 0){o?.send({jsonrpc:"2.0",id:e.id,error:{code:me.MethodNotFound,message:"Method not found"}}).catch(u=>this._onerror(new Error(`Failed to send an error response: ${u}`)));return}let i=new AbortController;this._requestHandlerAbortControllers.set(e.id,i);let c={signal:i.signal,sessionId:o?.sessionId,_meta:(r=e.params)===null||r===void 0?void 0:r._meta,sendNotification:u=>this.notification(u,{relatedRequestId:e.id}),sendRequest:(u,d,f)=>this.request(u,d,{...f,relatedRequestId:e.id}),authInfo:t?.authInfo,requestId:e.id,requestInfo:t?.requestInfo};Promise.resolve().then(()=>a(e,c)).then(u=>{if(!i.signal.aborted)return o?.send({result:u,jsonrpc:"2.0",id:e.id})},u=>{var d;if(!i.signal.aborted)return o?.send({jsonrpc:"2.0",id:e.id,error:{code:Number.isSafeInteger(u.code)?u.code:me.InternalError,message:(d=u.message)!==null&&d!==void 0?d:"Internal error"}})}).catch(u=>this._onerror(new Error(`Failed to send response: ${u}`))).finally(()=>{this._requestHandlerAbortControllers.delete(e.id)})}_onprogress(e){let{progressToken:t,...n}=e.params,r=Number(t),a=this._progressHandlers.get(r);if(!a){this._onerror(new Error(`Received a progress notification for an unknown token: ${JSON.stringify(e)}`));return}let o=this._responseHandlers.get(r),i=this._timeoutInfo.get(r);if(i&&o&&i.resetTimeoutOnProgress)try{this._resetTimeout(r)}catch(c){o(c);return}a(n)}_onresponse(e){let t=Number(e.id),n=this._responseHandlers.get(t);if(n===void 0){this._onerror(new Error(`Received a response for an unknown message ID: ${JSON.stringify(e)}`));return}if(this._responseHandlers.delete(t),this._progressHandlers.delete(t),this._cleanupTimeout(t),zo(e))n(e);else{let r=new ge(e.error.code,e.error.message,e.error.data);n(r)}}get transport(){return this._transport}async close(){var e;await((e=this._transport)===null||e===void 0?void 0:e.close())}request(e,t,n){let{relatedRequestId:r,resumptionToken:a,onresumptiontoken:o}=n??{};return new Promise((i,c)=>{var u,d,f,h,p,g;if(!this._transport){c(new Error("Not connected"));return}((u=this._options)===null||u===void 0?void 0:u.enforceStrictCapabilities)===!0&&this.assertCapabilityForMethod(e.method),(d=n?.signal)===null||d===void 0||d.throwIfAborted();let y=this._requestMessageId++,v={...e,jsonrpc:"2.0",id:y};n?.onprogress&&(this._progressHandlers.set(y,n.onprogress),v.params={...e.params,_meta:{...((f=e.params)===null||f===void 0?void 0:f._meta)||{},progressToken:y}});let w=R=>{var A;this._responseHandlers.delete(y),this._progressHandlers.delete(y),this._cleanupTimeout(y),(A=this._transport)===null||A===void 0||A.send({jsonrpc:"2.0",method:"notifications/cancelled",params:{requestId:y,reason:String(R)}},{relatedRequestId:r,resumptionToken:a,onresumptiontoken:o}).catch(D=>this._onerror(new Error(`Failed to send cancellation: ${D}`))),c(R)};this._responseHandlers.set(y,R=>{var A;if(!(!((A=n?.signal)===null||A===void 0)&&A.aborted)){if(R instanceof Error)return c(R);try{let D=t.parse(R.result);i(D)}catch(D){c(D)}}}),(h=n?.signal)===null||h===void 0||h.addEventListener("abort",()=>{var R;w((R=n?.signal)===null||R===void 0?void 0:R.reason)});let C=(p=n?.timeout)!==null&&p!==void 0?p:C0,E=()=>w(new ge(me.RequestTimeout,"Request timed out",{timeout:C}));this._setupTimeout(y,C,n?.maxTotalTimeout,E,(g=n?.resetTimeoutOnProgress)!==null&&g!==void 0?g:!1),this._transport.send(v,{relatedRequestId:r,resumptionToken:a,onresumptiontoken:o}).catch(R=>{this._cleanupTimeout(y),c(R)})})}async notification(e,t){var n,r;if(!this._transport)throw new Error("Not connected");if(this.assertNotificationCapability(e.method),((r=(n=this._options)===null||n===void 0?void 0:n.debouncedNotificationMethods)!==null&&r!==void 0?r:[]).includes(e.method)&&!e.params&&!t?.relatedRequestId){if(this._pendingDebouncedNotifications.has(e.method))return;this._pendingDebouncedNotifications.add(e.method),Promise.resolve().then(()=>{var c;if(this._pendingDebouncedNotifications.delete(e.method),!this._transport)return;let u={...e,jsonrpc:"2.0"};(c=this._transport)===null||c===void 0||c.send(u,t).catch(d=>this._onerror(d))});return}let i={...e,jsonrpc:"2.0"};await this._transport.send(i,t)}setRequestHandler(e,t){let n=e.shape.method.value;this.assertRequestHandlerCapability(n),this._requestHandlers.set(n,(r,a)=>Promise.resolve(t(e.parse(r),a)))}removeRequestHandler(e){this._requestHandlers.delete(e)}assertCanSetRequestHandler(e){if(this._requestHandlers.has(e))throw new Error(`A request handler for ${e} already exists, which would be overridden`)}setNotificationHandler(e,t){this._notificationHandlers.set(e.shape.method.value,n=>Promise.resolve(t(e.parse(n))))}removeNotificationHandler(e){this._notificationHandlers.delete(e)}};function Uf(s,e){return Object.entries(e).reduce((t,[n,r])=>(r&&typeof r=="object"?t[n]=t[n]?{...t[n],...r}:r:t[n]=r,t),{...s})}var Vm=G(Wm(),1),Ia=class extends da{constructor(e,t){var n;super(t),this._serverInfo=e,this._loggingLevels=new Map,this.LOG_LEVEL_SEVERITY=new Map(Ks.options.map((r,a)=>[r,a])),this.isMessageIgnored=(r,a)=>{let o=this._loggingLevels.get(a);return o?this.LOG_LEVEL_SEVERITY.get(r)<this.LOG_LEVEL_SEVERITY.get(o):!1},this._capabilities=(n=t?.capabilities)!==null&&n!==void 0?n:{},this._instructions=t?.instructions,this.setRequestHandler(Go,r=>this._oninitialize(r)),this.setNotificationHandler(Ko,()=>{var r;return(r=this.oninitialized)===null||r===void 0?void 0:r.call(this)}),this._capabilities.logging&&this.setRequestHandler(Yo,async(r,a)=>{var o;let i=a.sessionId||((o=a.requestInfo)===null||o===void 0?void 0:o.headers["mcp-session-id"])||void 0,{level:c}=r.params,u=Ks.safeParse(c);return u.success&&this._loggingLevels.set(i,u.data),{}})}registerCapabilities(e){if(this.transport)throw new Error("Cannot register capabilities after connecting to transport");this._capabilities=Uf(this._capabilities,e)}assertCapabilityForMethod(e){var t,n,r;switch(e){case"sampling/createMessage":if(!(!((t=this._clientCapabilities)===null||t===void 0)&&t.sampling))throw new Error(`Client does not support sampling (required for ${e})`);break;case"elicitation/create":if(!(!((n=this._clientCapabilities)===null||n===void 0)&&n.elicitation))throw new Error(`Client does not support elicitation (required for ${e})`);break;case"roots/list":if(!(!((r=this._clientCapabilities)===null||r===void 0)&&r.roots))throw new Error(`Client does not support listing roots (required for ${e})`);break;case"ping":break}}assertNotificationCapability(e){switch(e){case"notifications/message":if(!this._capabilities.logging)throw new Error(`Server does not support logging (required for ${e})`);break;case"notifications/resources/updated":case"notifications/resources/list_changed":if(!this._capabilities.resources)throw new Error(`Server does not support notifying about resources (required for ${e})`);break;case"notifications/tools/list_changed":if(!this._capabilities.tools)throw new Error(`Server does not support notifying of tool list changes (required for ${e})`);break;case"notifications/prompts/list_changed":if(!this._capabilities.prompts)throw new Error(`Server does not support notifying of prompt list changes (required for ${e})`);break;case"notifications/cancelled":break;case"notifications/progress":break}}assertRequestHandlerCapability(e){switch(e){case"sampling/createMessage":if(!this._capabilities.sampling)throw new Error(`Server does not support sampling (required for ${e})`);break;case"logging/setLevel":if(!this._capabilities.logging)throw new Error(`Server does not support logging (required for ${e})`);break;case"prompts/get":case"prompts/list":if(!this._capabilities.prompts)throw new Error(`Server does not support prompts (required for ${e})`);break;case"resources/list":case"resources/templates/list":case"resources/read":if(!this._capabilities.resources)throw new Error(`Server does not support resources (required for ${e})`);break;case"tools/call":case"tools/list":if(!this._capabilities.tools)throw new Error(`Server does not support tools (required for ${e})`);break;case"ping":case"initialize":break}}async _oninitialize(e){let t=e.params.protocolVersion;return this._clientCapabilities=e.params.capabilities,this._clientVersion=e.params.clientInfo,{protocolVersion:yf.includes(t)?t:Bo,capabilities:this.getCapabilities(),serverInfo:this._serverInfo,...this._instructions&&{instructions:this._instructions}}}getClientCapabilities(){return this._clientCapabilities}getClientVersion(){return this._clientVersion}getCapabilities(){return this._capabilities}async ping(){return this.request({method:"ping"},Zn)}async createMessage(e,t){return this.request({method:"sampling/createMessage",params:e},ei,t)}async elicitInput(e,t){let n=await this.request({method:"elicitation/create",params:e},ti,t);if(n.action==="accept"&&n.content)try{let r=new Vm.default,a=r.compile(e.requestedSchema);if(!a(n.content))throw new ge(me.InvalidParams,`Elicitation response content does not match requested schema: ${r.errorsText(a.errors)}`)}catch(r){throw r instanceof ge?r:new ge(me.InternalError,`Error validating elicitation response: ${r}`)}return n}async listRoots(e,t){return this.request({method:"roots/list",params:e},ri,t)}async sendLoggingMessage(e,t){if(this._capabilities.logging&&!this.isMessageIgnored(e.level,t))return this.notification({method:"notifications/message",params:e})}async sendResourceUpdated(e){return this.notification({method:"notifications/resources/updated",params:e})}async sendResourceListChanged(){return this.notification({method:"notifications/resources/list_changed"})}async sendToolListChanged(){return this.notification({method:"notifications/tools/list_changed"})}async sendPromptListChanged(){return this.notification({method:"notifications/prompts/list_changed"})}};var Bm=Symbol("Let zodToJsonSchema decide on which parser to use");var Hm={name:void 0,$refStrategy:"root",basePath:["#"],effectStrategy:"input",pipeStrategy:"all",dateStrategy:"format:date-time",mapStrategy:"entries",removeAdditionalStrategy:"passthrough",allowedAdditionalProperties:!0,rejectedAdditionalProperties:!1,definitionPath:"definitions",target:"jsonSchema7",strictUnions:!1,definitions:{},errorMessages:!1,markdownDescription:!1,patternStrategy:"escape",applyRegexFlags:!1,emailStrategy:"format:email",base64Strategy:"contentEncoding:base64",nameStrategy:"ref",openAiAnyTypeName:"OpenAiAnyType"},zm=s=>typeof s=="string"?{...Hm,name:s}:{...Hm,...s};var Gm=s=>{let e=zm(s),t=e.name!==void 0?[...e.basePath,e.definitionPath,e.name]:e.basePath;return{...e,flags:{hasReferencedOpenAiAnyType:!1},currentPath:t,propertyPath:void 0,seen:new Map(Object.entries(e.definitions).map(([n,r])=>[r._def,{def:r._def,path:[...e.basePath,e.definitionPath,n],jsonSchema:void 0}]))}};function Ti(s,e,t,n){n?.errorMessages&&t&&(s.errorMessage={...s.errorMessage,[e]:t})}function oe(s,e,t,n,r){s[e]=t,Ti(s,e,n,r)}var ka=(s,e)=>{let t=0;for(;t<s.length&&t<e.length&&s[t]===e[t];t++);return[(s.length-t).toString(),...e.slice(t)].join("/")};function be(s){if(s.target!=="openAi")return{};let e=[...s.basePath,s.definitionPath,s.openAiAnyTypeName];return s.flags.hasReferencedOpenAiAnyType=!0,{$ref:s.$refStrategy==="relative"?ka(e,s.currentPath):e.join("/")}}function Km(s,e){let t={type:"array"};return s.type?._def&&s.type?._def?.typeName!==O.ZodAny&&(t.items=X(s.type._def,{...e,currentPath:[...e.currentPath,"items"]})),s.minLength&&oe(t,"minItems",s.minLength.value,s.minLength.message,e),s.maxLength&&oe(t,"maxItems",s.maxLength.value,s.maxLength.message,e),s.exactLength&&(oe(t,"minItems",s.exactLength.value,s.exactLength.message,e),oe(t,"maxItems",s.exactLength.value,s.exactLength.message,e)),t}function Zm(s,e){let t={type:"integer",format:"int64"};if(!s.checks)return t;for(let n of s.checks)switch(n.kind){case"min":e.target==="jsonSchema7"?n.inclusive?oe(t,"minimum",n.value,n.message,e):oe(t,"exclusiveMinimum",n.value,n.message,e):(n.inclusive||(t.exclusiveMinimum=!0),oe(t,"minimum",n.value,n.message,e));break;case"max":e.target==="jsonSchema7"?n.inclusive?oe(t,"maximum",n.value,n.message,e):oe(t,"exclusiveMaximum",n.value,n.message,e):(n.inclusive||(t.exclusiveMaximum=!0),oe(t,"maximum",n.value,n.message,e));break;case"multipleOf":oe(t,"multipleOf",n.value,n.message,e);break}return t}function Jm(){return{type:"boolean"}}function Oa(s,e){return X(s.type._def,e)}var Qm=(s,e)=>X(s.innerType._def,e);function Ai(s,e,t){let n=t??e.dateStrategy;if(Array.isArray(n))return{anyOf:n.map((r,a)=>Ai(s,e,r))};switch(n){case"string":case"format:date-time":return{type:"string",format:"date-time"};case"format:date":return{type:"string",format:"date"};case"integer":return aR(s,e)}}var aR=(s,e)=>{let t={type:"integer",format:"unix-time"};if(e.target==="openApi3")return t;for(let n of s.checks)switch(n.kind){case"min":oe(t,"minimum",n.value,n.message,e);break;case"max":oe(t,"maximum",n.value,n.message,e);break}return t};function Xm(s,e){return{...X(s.innerType._def,e),default:s.defaultValue()}}function Ym(s,e){return e.effectStrategy==="input"?X(s.schema._def,e):be(e)}function eg(s){return{type:"string",enum:Array.from(s.values)}}var oR=s=>"type"in s&&s.type==="string"?!1:"allOf"in s;function tg(s,e){let t=[X(s.left._def,{...e,currentPath:[...e.currentPath,"allOf","0"]}),X(s.right._def,{...e,currentPath:[...e.currentPath,"allOf","1"]})].filter(a=>!!a),n=e.target==="jsonSchema2019-09"?{unevaluatedProperties:!1}:void 0,r=[];return t.forEach(a=>{if(oR(a))r.push(...a.allOf),a.unevaluatedProperties===void 0&&(n=void 0);else{let o=a;if("additionalProperties"in a&&a.additionalProperties===!1){let{additionalProperties:i,...c}=a;o=c}else n=void 0;r.push(o)}}),r.length?{allOf:r,...n}:void 0}function rg(s,e){let t=typeof s.value;return t!=="bigint"&&t!=="number"&&t!=="boolean"&&t!=="string"?{type:Array.isArray(s.value)?"array":"object"}:e.target==="openApi3"?{type:t==="bigint"?"integer":t,enum:[s.value]}:{type:t==="bigint"?"integer":t,const:s.value}}var Ii,yt={cuid:/^[cC][^\s-]{8,}$/,cuid2:/^[0-9a-z]+$/,ulid:/^[0-9A-HJKMNP-TV-Z]{26}$/,email:/^(?!\.)(?!.*\.\.)([a-zA-Z0-9_'+\-\.]*)[a-zA-Z0-9_+-]@([a-zA-Z0-9][a-zA-Z0-9\-]*\.)+[a-zA-Z]{2,}$/,emoji:()=>(Ii===void 0&&(Ii=RegExp("^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$","u")),Ii),uuid:/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/,ipv4:/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,ipv4Cidr:/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/(3[0-2]|[12]?[0-9])$/,ipv6:/^(([a-f0-9]{1,4}:){7}|::([a-f0-9]{1,4}:){0,6}|([a-f0-9]{1,4}:){1}:([a-f0-9]{1,4}:){0,5}|([a-f0-9]{1,4}:){2}:([a-f0-9]{1,4}:){0,4}|([a-f0-9]{1,4}:){3}:([a-f0-9]{1,4}:){0,3}|([a-f0-9]{1,4}:){4}:([a-f0-9]{1,4}:){0,2}|([a-f0-9]{1,4}:){5}:([a-f0-9]{1,4}:){0,1})([a-f0-9]{1,4}|(((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2}))\.){3}((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2})))$/,ipv6Cidr:/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,base64:/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,base64url:/^([0-9a-zA-Z-_]{4})*(([0-9a-zA-Z-_]{2}(==)?)|([0-9a-zA-Z-_]{3}(=)?))?$/,nanoid:/^[a-zA-Z0-9_-]{21}$/,jwt:/^[A-Za-z0-9-_]+\.[A-Za-z0-9-_]+\.[A-Za-z0-9-_]*$/};function Da(s,e){let t={type:"string"};if(s.checks)for(let n of s.checks)switch(n.kind){case"min":oe(t,"minLength",typeof t.minLength=="number"?Math.max(t.minLength,n.value):n.value,n.message,e);break;case"max":oe(t,"maxLength",typeof t.maxLength=="number"?Math.min(t.maxLength,n.value):n.value,n.message,e);break;case"email":switch(e.emailStrategy){case"format:email":bt(t,"email",n.message,e);break;case"format:idn-email":bt(t,"idn-email",n.message,e);break;case"pattern:zod":Ge(t,yt.email,n.message,e);break}break;case"url":bt(t,"uri",n.message,e);break;case"uuid":bt(t,"uuid",n.message,e);break;case"regex":Ge(t,n.regex,n.message,e);break;case"cuid":Ge(t,yt.cuid,n.message,e);break;case"cuid2":Ge(t,yt.cuid2,n.message,e);break;case"startsWith":Ge(t,RegExp(`^${ki(n.value,e)}`),n.message,e);break;case"endsWith":Ge(t,RegExp(`${ki(n.value,e)}$`),n.message,e);break;case"datetime":bt(t,"date-time",n.message,e);break;case"date":bt(t,"date",n.message,e);break;case"time":bt(t,"time",n.message,e);break;case"duration":bt(t,"duration",n.message,e);break;case"length":oe(t,"minLength",typeof t.minLength=="number"?Math.max(t.minLength,n.value):n.value,n.message,e),oe(t,"maxLength",typeof t.maxLength=="number"?Math.min(t.maxLength,n.value):n.value,n.message,e);break;case"includes":{Ge(t,RegExp(ki(n.value,e)),n.message,e);break}case"ip":{n.version!=="v6"&&bt(t,"ipv4",n.message,e),n.version!=="v4"&&bt(t,"ipv6",n.message,e);break}case"base64url":Ge(t,yt.base64url,n.message,e);break;case"jwt":Ge(t,yt.jwt,n.message,e);break;case"cidr":{n.version!=="v6"&&Ge(t,yt.ipv4Cidr,n.message,e),n.version!=="v4"&&Ge(t,yt.ipv6Cidr,n.message,e);break}case"emoji":Ge(t,yt.emoji(),n.message,e);break;case"ulid":{Ge(t,yt.ulid,n.message,e);break}case"base64":{switch(e.base64Strategy){case"format:binary":{bt(t,"binary",n.message,e);break}case"contentEncoding:base64":{oe(t,"contentEncoding","base64",n.message,e);break}case"pattern:zod":{Ge(t,yt.base64,n.message,e);break}}break}case"nanoid":Ge(t,yt.nanoid,n.message,e);case"toLowerCase":case"toUpperCase":case"trim":break;default:}return t}function ki(s,e){return e.patternStrategy==="escape"?cR(s):s}var iR=new Set("ABCDEFGHIJKLMNOPQRSTUVXYZabcdefghijklmnopqrstuvxyz0123456789");function cR(s){let e="";for(let t=0;t<s.length;t++)iR.has(s[t])||(e+="\\"),e+=s[t];return e}function bt(s,e,t,n){s.format||s.anyOf?.some(r=>r.format)?(s.anyOf||(s.anyOf=[]),s.format&&(s.anyOf.push({format:s.format,...s.errorMessage&&n.errorMessages&&{errorMessage:{format:s.errorMessage.format}}}),delete s.format,s.errorMessage&&(delete s.errorMessage.format,Object.keys(s.errorMessage).length===0&&delete s.errorMessage)),s.anyOf.push({format:e,...t&&n.errorMessages&&{errorMessage:{format:t}}})):oe(s,"format",e,t,n)}function Ge(s,e,t,n){s.pattern||s.allOf?.some(r=>r.pattern)?(s.allOf||(s.allOf=[]),s.pattern&&(s.allOf.push({pattern:s.pattern,...s.errorMessage&&n.errorMessages&&{errorMessage:{pattern:s.errorMessage.pattern}}}),delete s.pattern,s.errorMessage&&(delete s.errorMessage.pattern,Object.keys(s.errorMessage).length===0&&delete s.errorMessage)),s.allOf.push({pattern:sg(e,n),...t&&n.errorMessages&&{errorMessage:{pattern:t}}})):oe(s,"pattern",sg(e,n),t,n)}function sg(s,e){if(!e.applyRegexFlags||!s.flags)return s.source;let t={i:s.flags.includes("i"),m:s.flags.includes("m"),s:s.flags.includes("s")},n=t.i?s.source.toLowerCase():s.source,r="",a=!1,o=!1,i=!1;for(let c=0;c<n.length;c++){if(a){r+=n[c],a=!1;continue}if(t.i){if(o){if(n[c].match(/[a-z]/)){i?(r+=n[c],r+=`${n[c-2]}-${n[c]}`.toUpperCase(),i=!1):n[c+1]==="-"&&n[c+2]?.match(/[a-z]/)?(r+=n[c],i=!0):r+=`${n[c]}${n[c].toUpperCase()}`;continue}}else if(n[c].match(/[a-z]/)){r+=`[${n[c]}${n[c].toUpperCase()}]`;continue}}if(t.m){if(n[c]==="^"){r+=`(^|(?<=[\r
]))`;continue}else if(n[c]==="$"){r+=`($|(?=[\r
]))`;continue}}if(t.s&&n[c]==="."){r+=o?`${n[c]}\r
`:`[${n[c]}\r
]`;continue}r+=n[c],n[c]==="\\"?a=!0:o&&n[c]==="]"?o=!1:!o&&n[c]==="["&&(o=!0)}try{new RegExp(r)}catch{return console.warn(`Could not convert regex pattern at ${e.currentPath.join("/")} to a flag-independent form! Falling back to the flag-ignorant source`),s.source}return r}function $a(s,e){if(e.target==="openAi"&&console.warn("Warning: OpenAI may not support records in schemas! Try an array of key-value pairs instead."),e.target==="openApi3"&&s.keyType?._def.typeName===O.ZodEnum)return{type:"object",required:s.keyType._def.values,properties:s.keyType._def.values.reduce((n,r)=>({...n,[r]:X(s.valueType._def,{...e,currentPath:[...e.currentPath,"properties",r]})??be(e)}),{}),additionalProperties:e.rejectedAdditionalProperties};let t={type:"object",additionalProperties:X(s.valueType._def,{...e,currentPath:[...e.currentPath,"additionalProperties"]})??e.allowedAdditionalProperties};if(e.target==="openApi3")return t;if(s.keyType?._def.typeName===O.ZodString&&s.keyType._def.checks?.length){let{type:n,...r}=Da(s.keyType._def,e);return{...t,propertyNames:r}}else{if(s.keyType?._def.typeName===O.ZodEnum)return{...t,propertyNames:{enum:s.keyType._def.values}};if(s.keyType?._def.typeName===O.ZodBranded&&s.keyType._def.type._def.typeName===O.ZodString&&s.keyType._def.type._def.checks?.length){let{type:n,...r}=Oa(s.keyType._def,e);return{...t,propertyNames:r}}}return t}function ng(s,e){if(e.mapStrategy==="record")return $a(s,e);let t=X(s.keyType._def,{...e,currentPath:[...e.currentPath,"items","items","0"]})||be(e),n=X(s.valueType._def,{...e,currentPath:[...e.currentPath,"items","items","1"]})||be(e);return{type:"array",maxItems:125,items:{type:"array",items:[t,n],minItems:2,maxItems:2}}}function ag(s){let e=s.values,n=Object.keys(s.values).filter(a=>typeof e[e[a]]!="number").map(a=>e[a]),r=Array.from(new Set(n.map(a=>typeof a)));return{type:r.length===1?r[0]==="string"?"string":"number":["string","number"],enum:n}}function og(s){return s.target==="openAi"?void 0:{not:be({...s,currentPath:[...s.currentPath,"not"]})}}function ig(s){return s.target==="openApi3"?{enum:["null"],nullable:!0}:{type:"null"}}var Js={ZodString:"string",ZodNumber:"number",ZodBigInt:"integer",ZodBoolean:"boolean",ZodNull:"null"};function lg(s,e){if(e.target==="openApi3")return cg(s,e);let t=s.options instanceof Map?Array.from(s.options.values()):s.options;if(t.every(n=>n._def.typeName in Js&&(!n._def.checks||!n._def.checks.length))){let n=t.reduce((r,a)=>{let o=Js[a._def.typeName];return o&&!r.includes(o)?[...r,o]:r},[]);return{type:n.length>1?n:n[0]}}else if(t.every(n=>n._def.typeName==="ZodLiteral"&&!n.description)){let n=t.reduce((r,a)=>{let o=typeof a._def.value;switch(o){case"string":case"number":case"boolean":return[...r,o];case"bigint":return[...r,"integer"];case"object":if(a._def.value===null)return[...r,"null"];case"symbol":case"undefined":case"function":default:return r}},[]);if(n.length===t.length){let r=n.filter((a,o,i)=>i.indexOf(a)===o);return{type:r.length>1?r:r[0],enum:t.reduce((a,o)=>a.includes(o._def.value)?a:[...a,o._def.value],[])}}}else if(t.every(n=>n._def.typeName==="ZodEnum"))return{type:"string",enum:t.reduce((n,r)=>[...n,...r._def.values.filter(a=>!n.includes(a))],[])};return cg(s,e)}var cg=(s,e)=>{let t=(s.options instanceof Map?Array.from(s.options.values()):s.options).map((n,r)=>X(n._def,{...e,currentPath:[...e.currentPath,"anyOf",`${r}`]})).filter(n=>!!n&&(!e.strictUnions||typeof n=="object"&&Object.keys(n).length>0));return t.length?{anyOf:t}:void 0};function ug(s,e){if(["ZodString","ZodNumber","ZodBigInt","ZodBoolean","ZodNull"].includes(s.innerType._def.typeName)&&(!s.innerType._def.checks||!s.innerType._def.checks.length))return e.target==="openApi3"?{type:Js[s.innerType._def.typeName],nullable:!0}:{type:[Js[s.innerType._def.typeName],"null"]};if(e.target==="openApi3"){let n=X(s.innerType._def,{...e,currentPath:[...e.currentPath]});return n&&"$ref"in n?{allOf:[n],nullable:!0}:n&&{...n,nullable:!0}}let t=X(s.innerType._def,{...e,currentPath:[...e.currentPath,"anyOf","0"]});return t&&{anyOf:[t,{type:"null"}]}}function dg(s,e){let t={type:"number"};if(!s.checks)return t;for(let n of s.checks)switch(n.kind){case"int":t.type="integer",Ti(t,"type",n.message,e);break;case"min":e.target==="jsonSchema7"?n.inclusive?oe(t,"minimum",n.value,n.message,e):oe(t,"exclusiveMinimum",n.value,n.message,e):(n.inclusive||(t.exclusiveMinimum=!0),oe(t,"minimum",n.value,n.message,e));break;case"max":e.target==="jsonSchema7"?n.inclusive?oe(t,"maximum",n.value,n.message,e):oe(t,"exclusiveMaximum",n.value,n.message,e):(n.inclusive||(t.exclusiveMaximum=!0),oe(t,"maximum",n.value,n.message,e));break;case"multipleOf":oe(t,"multipleOf",n.value,n.message,e);break}return t}function pg(s,e){let t=e.target==="openAi",n={type:"object",properties:{}},r=[],a=s.shape();for(let i in a){let c=a[i];if(c===void 0||c._def===void 0)continue;let u=uR(c);u&&t&&(c._def.typeName==="ZodOptional"&&(c=c._def.innerType),c.isNullable()||(c=c.nullable()),u=!1);let d=X(c._def,{...e,currentPath:[...e.currentPath,"properties",i],propertyPath:[...e.currentPath,"properties",i]});d!==void 0&&(n.properties[i]=d,u||r.push(i))}r.length&&(n.required=r);let o=lR(s,e);return o!==void 0&&(n.additionalProperties=o),n}function lR(s,e){if(s.catchall._def.typeName!=="ZodNever")return X(s.catchall._def,{...e,currentPath:[...e.currentPath,"additionalProperties"]});switch(s.unknownKeys){case"passthrough":return e.allowedAdditionalProperties;case"strict":return e.rejectedAdditionalProperties;case"strip":return e.removeAdditionalStrategy==="strict"?e.allowedAdditionalProperties:e.rejectedAdditionalProperties}}function uR(s){try{return s.isOptional()}catch{return!0}}var fg=(s,e)=>{if(e.currentPath.toString()===e.propertyPath?.toString())return X(s.innerType._def,e);let t=X(s.innerType._def,{...e,currentPath:[...e.currentPath,"anyOf","1"]});return t?{anyOf:[{not:be(e)},t]}:be(e)};var hg=(s,e)=>{if(e.pipeStrategy==="input")return X(s.in._def,e);if(e.pipeStrategy==="output")return X(s.out._def,e);let t=X(s.in._def,{...e,currentPath:[...e.currentPath,"allOf","0"]}),n=X(s.out._def,{...e,currentPath:[...e.currentPath,"allOf",t?"1":"0"]});return{allOf:[t,n].filter(r=>r!==void 0)}};function mg(s,e){return X(s.type._def,e)}function gg(s,e){let n={type:"array",uniqueItems:!0,items:X(s.valueType._def,{...e,currentPath:[...e.currentPath,"items"]})};return s.minSize&&oe(n,"minItems",s.minSize.value,s.minSize.message,e),s.maxSize&&oe(n,"maxItems",s.maxSize.value,s.maxSize.message,e),n}function vg(s,e){return s.rest?{type:"array",minItems:s.items.length,items:s.items.map((t,n)=>X(t._def,{...e,currentPath:[...e.currentPath,"items",`${n}`]})).reduce((t,n)=>n===void 0?t:[...t,n],[]),additionalItems:X(s.rest._def,{...e,currentPath:[...e.currentPath,"additionalItems"]})}:{type:"array",minItems:s.items.length,maxItems:s.items.length,items:s.items.map((t,n)=>X(t._def,{...e,currentPath:[...e.currentPath,"items",`${n}`]})).reduce((t,n)=>n===void 0?t:[...t,n],[])}}function yg(s){return{not:be(s)}}function bg(s){return be(s)}var xg=(s,e)=>X(s.innerType._def,e);var wg=(s,e,t)=>{switch(e){case O.ZodString:return Da(s,t);case O.ZodNumber:return dg(s,t);case O.ZodObject:return pg(s,t);case O.ZodBigInt:return Zm(s,t);case O.ZodBoolean:return Jm();case O.ZodDate:return Ai(s,t);case O.ZodUndefined:return yg(t);case O.ZodNull:return ig(t);case O.ZodArray:return Km(s,t);case O.ZodUnion:case O.ZodDiscriminatedUnion:return lg(s,t);case O.ZodIntersection:return tg(s,t);case O.ZodTuple:return vg(s,t);case O.ZodRecord:return $a(s,t);case O.ZodLiteral:return rg(s,t);case O.ZodEnum:return eg(s);case O.ZodNativeEnum:return ag(s);case O.ZodNullable:return ug(s,t);case O.ZodOptional:return fg(s,t);case O.ZodMap:return ng(s,t);case O.ZodSet:return gg(s,t);case O.ZodLazy:return()=>s.getter()._def;case O.ZodPromise:return mg(s,t);case O.ZodNaN:case O.ZodNever:return og(t);case O.ZodEffects:return Ym(s,t);case O.ZodAny:return be(t);case O.ZodUnknown:return bg(t);case O.ZodDefault:return Xm(s,t);case O.ZodBranded:return Oa(s,t);case O.ZodReadonly:return xg(s,t);case O.ZodCatch:return Qm(s,t);case O.ZodPipeline:return hg(s,t);case O.ZodFunction:case O.ZodVoid:case O.ZodSymbol:return;default:return(n=>{})(e)}};function X(s,e,t=!1){let n=e.seen.get(s);if(e.override){let i=e.override?.(s,e,n,t);if(i!==Bm)return i}if(n&&!t){let i=dR(n,e);if(i!==void 0)return i}let r={def:s,path:e.currentPath,jsonSchema:void 0};e.seen.set(s,r);let a=wg(s,s.typeName,e),o=typeof a=="function"?X(a(),e):a;if(o&&pR(s,e,o),e.postProcess){let i=e.postProcess(o,s,e);return r.jsonSchema=o,i}return r.jsonSchema=o,o}var dR=(s,e)=>{switch(e.$refStrategy){case"root":return{$ref:s.path.join("/")};case"relative":return{$ref:ka(e.currentPath,s.path)};case"none":case"seen":return s.path.length<e.currentPath.length&&s.path.every((t,n)=>e.currentPath[n]===t)?(console.warn(`Recursive reference detected at ${e.currentPath.join("/")}! Defaulting to any`),be(e)):e.$refStrategy==="seen"?be(e):void 0}},pR=(s,e,t)=>(s.description&&(t.description=s.description,e.markdownDescription&&(t.markdownDescription=s.description)),t);var Ma=(s,e)=>{let t=Gm(e),n=typeof e=="object"&&e.definitions?Object.entries(e.definitions).reduce((c,[u,d])=>({...c,[u]:X(d._def,{...t,currentPath:[...t.basePath,t.definitionPath,u]},!0)??be(t)}),{}):void 0,r=typeof e=="string"?e:e?.nameStrategy==="title"?void 0:e?.name,a=X(s._def,r===void 0?t:{...t,currentPath:[...t.basePath,t.definitionPath,r]},!1)??be(t),o=typeof e=="object"&&e.name!==void 0&&e.nameStrategy==="title"?e.name:void 0;o!==void 0&&(a.title=o),t.flags.hasReferencedOpenAiAnyType&&(n||(n={}),n[t.openAiAnyTypeName]||(n[t.openAiAnyTypeName]={type:["string","number","integer","boolean","array","null"],items:{$ref:t.$refStrategy==="relative"?"1":[...t.basePath,t.definitionPath,t.openAiAnyTypeName].join("/")}}));let i=r===void 0?n?{...a,[t.definitionPath]:n}:a:{$ref:[...t.$refStrategy==="relative"?[]:t.basePath,t.definitionPath,r].join("/"),[t.definitionPath]:{...n,[r]:a}};return t.target==="jsonSchema7"?i.$schema="http://json-schema.org/draft-07/schema#":(t.target==="jsonSchema2019-09"||t.target==="openAi")&&(i.$schema="https://json-schema.org/draft/2019-09/schema#"),t.target==="openAi"&&("anyOf"in i||"oneOf"in i||"allOf"in i||"type"in i&&Array.isArray(i.type))&&console.warn("Warning: OpenAI may not support schemas with unions as roots! Try wrapping it in an object property."),i};var Oi;(function(s){s.Completable="McpCompletable"})(Oi||(Oi={}));var hs=class extends te{_parse(e){let{ctx:t}=this._processInputParams(e),n=t.data;return this._def.type._parse({data:n,path:t.path,parent:t})}unwrap(){return this._def.type}};hs.create=(s,e)=>new hs({type:s,typeName:Oi.Completable,complete:e.complete,...fR(e)});function fR(s){if(!s)return{};let{errorMap:e,invalid_type_error:t,required_error:n,description:r}=s;if(e&&(t||n))throw new Error(`Can't use "invalid_type_error" or "required_error" in conjunction with custom error map.`);return e?{errorMap:e,description:r}:{errorMap:(o,i)=>{var c,u;let{message:d}=s;return o.code==="invalid_enum_value"?{message:d??i.defaultError}:typeof i.data>"u"?{message:(c=d??n)!==null&&c!==void 0?c:i.defaultError}:o.code!=="invalid_type"?{message:i.defaultError}:{message:(u=d??t)!==null&&u!==void 0?u:i.defaultError}},description:r}}var Na=class{constructor(e,t){this._registeredResources={},this._registeredResourceTemplates={},this._registeredTools={},this._registeredPrompts={},this._toolHandlersInitialized=!1,this._completionHandlerInitialized=!1,this._resourceHandlersInitialized=!1,this._promptHandlersInitialized=!1,this.server=new Ia(e,t)}async connect(e){return await this.server.connect(e)}async close(){await this.server.close()}setToolRequestHandlers(){this._toolHandlersInitialized||(this.server.assertCanSetRequestHandler(oa.shape.method.value),this.server.assertCanSetRequestHandler(ia.shape.method.value),this.server.registerCapabilities({tools:{listChanged:!0}}),this.server.setRequestHandler(oa,()=>({tools:Object.entries(this._registeredTools).filter(([,e])=>e.enabled).map(([e,t])=>{let n={name:e,title:t.title,description:t.description,inputSchema:t.inputSchema?Ma(t.inputSchema,{strictUnions:!0}):hR,annotations:t.annotations,_meta:t._meta};return t.outputSchema&&(n.outputSchema=Ma(t.outputSchema,{strictUnions:!0})),n})})),this.server.setRequestHandler(ia,async(e,t)=>{let n=this._registeredTools[e.params.name];if(!n)throw new ge(me.InvalidParams,`Tool ${e.params.name} not found`);if(!n.enabled)throw new ge(me.InvalidParams,`Tool ${e.params.name} disabled`);let r;if(n.inputSchema){let a=await n.inputSchema.safeParseAsync(e.params.arguments);if(!a.success)throw new ge(me.InvalidParams,`Invalid arguments for tool ${e.params.name}: ${a.error.message}`);let o=a.data,i=n.callback;try{r=await Promise.resolve(i(o,t))}catch(c){r={content:[{type:"text",text:c instanceof Error?c.message:String(c)}],isError:!0}}}else{let a=n.callback;try{r=await Promise.resolve(a(t))}catch(o){r={content:[{type:"text",text:o instanceof Error?o.message:String(o)}],isError:!0}}}if(n.outputSchema&&!r.isError){if(!r.structuredContent)throw new ge(me.InvalidParams,`Tool ${e.params.name} has an output schema but no structured content was provided`);let a=await n.outputSchema.safeParseAsync(r.structuredContent);if(!a.success)throw new ge(me.InvalidParams,`Invalid structured content for tool ${e.params.name}: ${a.error.message}`)}return r}),this._toolHandlersInitialized=!0)}setCompletionRequestHandler(){this._completionHandlerInitialized||(this.server.assertCanSetRequestHandler(ca.shape.method.value),this.server.registerCapabilities({completions:{}}),this.server.setRequestHandler(ca,async e=>{switch(e.params.ref.type){case"ref/prompt":return this.handlePromptCompletion(e,e.params.ref);case"ref/resource":return this.handleResourceCompletion(e,e.params.ref);default:throw new ge(me.InvalidParams,`Invalid completion reference: ${e.params.ref}`)}}),this._completionHandlerInitialized=!0)}async handlePromptCompletion(e,t){let n=this._registeredPrompts[t.name];if(!n)throw new ge(me.InvalidParams,`Prompt ${t.name} not found`);if(!n.enabled)throw new ge(me.InvalidParams,`Prompt ${t.name} disabled`);if(!n.argsSchema)return La;let r=n.argsSchema.shape[e.params.argument.name];if(!(r instanceof hs))return La;let o=await r._def.complete(e.params.argument.value,e.params.context);return Sg(o)}async handleResourceCompletion(e,t){let n=Object.values(this._registeredResourceTemplates).find(o=>o.resourceTemplate.uriTemplate.toString()===t.uri);if(!n){if(this._registeredResources[t.uri])return La;throw new ge(me.InvalidParams,`Resource template ${e.params.ref.uri} not found`)}let r=n.resourceTemplate.completeCallback(e.params.argument.name);if(!r)return La;let a=await r(e.params.argument.value,e.params.context);return Sg(a)}setResourceRequestHandlers(){this._resourceHandlersInitialized||(this.server.assertCanSetRequestHandler(ta.shape.method.value),this.server.assertCanSetRequestHandler(ra.shape.method.value),this.server.assertCanSetRequestHandler(sa.shape.method.value),this.server.registerCapabilities({resources:{listChanged:!0}}),this.server.setRequestHandler(ta,async(e,t)=>{let n=Object.entries(this._registeredResources).filter(([a,o])=>o.enabled).map(([a,o])=>({uri:a,name:o.name,...o.metadata})),r=[];for(let a of Object.values(this._registeredResourceTemplates)){if(!a.resourceTemplate.listCallback)continue;let o=await a.resourceTemplate.listCallback(t);for(let i of o.resources)r.push({...a.metadata,...i})}return{resources:[...n,...r]}}),this.server.setRequestHandler(ra,async()=>({resourceTemplates:Object.entries(this._registeredResourceTemplates).map(([t,n])=>({name:t,uriTemplate:n.resourceTemplate.uriTemplate.toString(),...n.metadata}))})),this.server.setRequestHandler(sa,async(e,t)=>{let n=new URL(e.params.uri),r=this._registeredResources[n.toString()];if(r){if(!r.enabled)throw new ge(me.InvalidParams,`Resource ${n} disabled`);return r.readCallback(n,t)}for(let a of Object.values(this._registeredResourceTemplates)){let o=a.resourceTemplate.uriTemplate.match(n.toString());if(o)return a.readCallback(n,o,t)}throw new ge(me.InvalidParams,`Resource ${n} not found`)}),this.setCompletionRequestHandler(),this._resourceHandlersInitialized=!0)}setPromptRequestHandlers(){this._promptHandlersInitialized||(this.server.assertCanSetRequestHandler(na.shape.method.value),this.server.assertCanSetRequestHandler(aa.shape.method.value),this.server.registerCapabilities({prompts:{listChanged:!0}}),this.server.setRequestHandler(na,()=>({prompts:Object.entries(this._registeredPrompts).filter(([,e])=>e.enabled).map(([e,t])=>({name:e,title:t.title,description:t.description,arguments:t.argsSchema?gR(t.argsSchema):void 0}))})),this.server.setRequestHandler(aa,async(e,t)=>{let n=this._registeredPrompts[e.params.name];if(!n)throw new ge(me.InvalidParams,`Prompt ${e.params.name} not found`);if(!n.enabled)throw new ge(me.InvalidParams,`Prompt ${e.params.name} disabled`);if(n.argsSchema){let r=await n.argsSchema.safeParseAsync(e.params.arguments);if(!r.success)throw new ge(me.InvalidParams,`Invalid arguments for prompt ${e.params.name}: ${r.error.message}`);let a=r.data,o=n.callback;return await Promise.resolve(o(a,t))}else{let r=n.callback;return await Promise.resolve(r(t))}}),this.setCompletionRequestHandler(),this._promptHandlersInitialized=!0)}resource(e,t,...n){let r;typeof n[0]=="object"&&(r=n.shift());let a=n[0];if(typeof t=="string"){if(this._registeredResources[t])throw new Error(`Resource ${t} is already registered`);let o=this._createRegisteredResource(e,void 0,t,r,a);return this.setResourceRequestHandlers(),this.sendResourceListChanged(),o}else{if(this._registeredResourceTemplates[e])throw new Error(`Resource template ${e} is already registered`);let o=this._createRegisteredResourceTemplate(e,void 0,t,r,a);return this.setResourceRequestHandlers(),this.sendResourceListChanged(),o}}registerResource(e,t,n,r){if(typeof t=="string"){if(this._registeredResources[t])throw new Error(`Resource ${t} is already registered`);let a=this._createRegisteredResource(e,n.title,t,n,r);return this.setResourceRequestHandlers(),this.sendResourceListChanged(),a}else{if(this._registeredResourceTemplates[e])throw new Error(`Resource template ${e} is already registered`);let a=this._createRegisteredResourceTemplate(e,n.title,t,n,r);return this.setResourceRequestHandlers(),this.sendResourceListChanged(),a}}_createRegisteredResource(e,t,n,r,a){let o={name:e,title:t,metadata:r,readCallback:a,enabled:!0,disable:()=>o.update({enabled:!1}),enable:()=>o.update({enabled:!0}),remove:()=>o.update({uri:null}),update:i=>{typeof i.uri<"u"&&i.uri!==n&&(delete this._registeredResources[n],i.uri&&(this._registeredResources[i.uri]=o)),typeof i.name<"u"&&(o.name=i.name),typeof i.title<"u"&&(o.title=i.title),typeof i.metadata<"u"&&(o.metadata=i.metadata),typeof i.callback<"u"&&(o.readCallback=i.callback),typeof i.enabled<"u"&&(o.enabled=i.enabled),this.sendResourceListChanged()}};return this._registeredResources[n]=o,o}_createRegisteredResourceTemplate(e,t,n,r,a){let o={resourceTemplate:n,title:t,metadata:r,readCallback:a,enabled:!0,disable:()=>o.update({enabled:!1}),enable:()=>o.update({enabled:!0}),remove:()=>o.update({name:null}),update:i=>{typeof i.name<"u"&&i.name!==e&&(delete this._registeredResourceTemplates[e],i.name&&(this._registeredResourceTemplates[i.name]=o)),typeof i.title<"u"&&(o.title=i.title),typeof i.template<"u"&&(o.resourceTemplate=i.template),typeof i.metadata<"u"&&(o.metadata=i.metadata),typeof i.callback<"u"&&(o.readCallback=i.callback),typeof i.enabled<"u"&&(o.enabled=i.enabled),this.sendResourceListChanged()}};return this._registeredResourceTemplates[e]=o,o}_createRegisteredPrompt(e,t,n,r,a){let o={title:t,description:n,argsSchema:r===void 0?void 0:l.object(r),callback:a,enabled:!0,disable:()=>o.update({enabled:!1}),enable:()=>o.update({enabled:!0}),remove:()=>o.update({name:null}),update:i=>{typeof i.name<"u"&&i.name!==e&&(delete this._registeredPrompts[e],i.name&&(this._registeredPrompts[i.name]=o)),typeof i.title<"u"&&(o.title=i.title),typeof i.description<"u"&&(o.description=i.description),typeof i.argsSchema<"u"&&(o.argsSchema=l.object(i.argsSchema)),typeof i.callback<"u"&&(o.callback=i.callback),typeof i.enabled<"u"&&(o.enabled=i.enabled),this.sendPromptListChanged()}};return this._registeredPrompts[e]=o,o}_createRegisteredTool(e,t,n,r,a,o,i,c){let u={title:t,description:n,inputSchema:r===void 0?void 0:l.object(r),outputSchema:a===void 0?void 0:l.object(a),annotations:o,_meta:i,callback:c,enabled:!0,disable:()=>u.update({enabled:!1}),enable:()=>u.update({enabled:!0}),remove:()=>u.update({name:null}),update:d=>{typeof d.name<"u"&&d.name!==e&&(delete this._registeredTools[e],d.name&&(this._registeredTools[d.name]=u)),typeof d.title<"u"&&(u.title=d.title),typeof d.description<"u"&&(u.description=d.description),typeof d.paramsSchema<"u"&&(u.inputSchema=l.object(d.paramsSchema)),typeof d.callback<"u"&&(u.callback=d.callback),typeof d.annotations<"u"&&(u.annotations=d.annotations),typeof d._meta<"u"&&(u._meta=d._meta),typeof d.enabled<"u"&&(u.enabled=d.enabled),this.sendToolListChanged()}};return this._registeredTools[e]=u,this.setToolRequestHandlers(),this.sendToolListChanged(),u}tool(e,...t){if(this._registeredTools[e])throw new Error(`Tool ${e} is already registered`);let n,r,a,o;if(typeof t[0]=="string"&&(n=t.shift()),t.length>1){let c=t[0];Pg(c)?(r=t.shift(),t.length>1&&typeof t[0]=="object"&&t[0]!==null&&!Pg(t[0])&&(o=t.shift())):typeof c=="object"&&c!==null&&(o=t.shift())}let i=t[0];return this._createRegisteredTool(e,void 0,n,r,a,o,void 0,i)}registerTool(e,t,n){if(this._registeredTools[e])throw new Error(`Tool ${e} is already registered`);let{title:r,description:a,inputSchema:o,outputSchema:i,annotations:c,_meta:u}=t;return this._createRegisteredTool(e,r,a,o,i,c,u,n)}prompt(e,...t){if(this._registeredPrompts[e])throw new Error(`Prompt ${e} is already registered`);let n;typeof t[0]=="string"&&(n=t.shift());let r;t.length>1&&(r=t.shift());let a=t[0],o=this._createRegisteredPrompt(e,void 0,n,r,a);return this.setPromptRequestHandlers(),this.sendPromptListChanged(),o}registerPrompt(e,t,n){if(this._registeredPrompts[e])throw new Error(`Prompt ${e} is already registered`);let{title:r,description:a,argsSchema:o}=t,i=this._createRegisteredPrompt(e,r,a,o,n);return this.setPromptRequestHandlers(),this.sendPromptListChanged(),i}isConnected(){return this.server.transport!==void 0}async sendLoggingMessage(e,t){return this.server.sendLoggingMessage(e,t)}sendResourceListChanged(){this.isConnected()&&this.server.sendResourceListChanged()}sendToolListChanged(){this.isConnected()&&this.server.sendToolListChanged()}sendPromptListChanged(){this.isConnected()&&this.server.sendPromptListChanged()}};var hR={type:"object",properties:{}};function Pg(s){return typeof s!="object"||s===null?!1:Object.keys(s).length===0||Object.values(s).some(mR)}function mR(s){return s!==null&&typeof s=="object"&&"parse"in s&&typeof s.parse=="function"&&"safeParse"in s&&typeof s.safeParse=="function"}function gR(s){return Object.entries(s.shape).map(([e,t])=>({name:e,description:t.description,required:!t.isOptional()}))}function Sg(s){return{completion:{values:s.slice(0,100),total:s.length,hasMore:s.length>100}}}var La={completion:{values:[],hasMore:!1}};var Fa=G(require("fs/promises")),_g=G(require("os")),Qs=G(require("path"));Re();var vR="codex-mcp-lsp";async function Eg(s,e){let t=Qs.join(_g.tmpdir(),"mcp-lsp-"),n=await Fa.mkdtemp(t),r=Qs.join(n,"mcp-lsp.sock"),a=Tn(e),o=new Di(s,r,a);return await o.initUnixDomainSocketServer(r),o}var Di=class{constructor(e,t,n){this.version=e;this.socketPath=t;this.codexExecutable=n}getCodexConfig(){return{[`mcp_servers.${vR}`]:{command:this.codexExecutable,args:["stdio-to-uds",this.socketPath]}}}async initUnixDomainSocketServer(e){await new ua(e).listen(async n=>{let r=yR(this.version);n.addDisposable({dispose:()=>r.close()});try{await r.connect(n)}catch(a){throw T().error(`MCP LSP server failed to connect: ${a}`),await n.close().catch(()=>{}),a}}),T().info(`MCP LSP server listening on ${e}`)}dispose(){let e=Qs.dirname(this.socketPath);Fa.rm(e,{recursive:!0,force:!0}).catch(t=>{T().error(`Failed to remove MCP LSP socket directory ${e}:`,t)})}};function yR(s){let e=new Na({name:"vscode-codex-mcp-lsp-server",version:s});return mf(e),e}var $i=G(require("vscode")),ja=class{shellIntegrationSubscription;pendingTerminals=new Map;constructor(){this.shellIntegrationSubscription=$i.window.onDidChangeTerminalShellIntegration(e=>{let{terminal:t}=e,n=this.pendingTerminals.get(t);n&&(n(t),this.pendingTerminals.delete(t))})}createTerminal(e){let t=$i.window.createTerminal(e);return new Promise(n=>{this.pendingTerminals.set(t,n)})}dispose(){this.shellIntegrationSubscription.dispose()}};function Rg(s){let e=[],t=s.length,n=0;function r(i,c){let u=s[i],d=c;for(;d<t&&s[d]===u;)d++;let f=qa(s,d),h=Cg(s,f,"TODO",!0),p=f;for(;p<t&&s[p]!==`
`&&s[p]!=="\r";)p++;if(h!==-1){let g=s.slice(h,p);e.push({body:g.trimEnd(),index:i})}return p}let a=null,o=!1;for(;n<t;){let i=s[n];if(a){o?o=!1:i==="\\"?o=!0:i===a&&(a=null),n++;continue}else if(i==='"'||i==="'"||i==="`"){a=i,n++;continue}if(i==="/"&&n+1<t){let c=s[n+1];if(c==="/"){n=r(n,n+2);continue}if(c==="*"){let u=n,d=n+2,f=s.indexOf("*/",d),h=f===-1?t:f+2,p=s.slice(d,f===-1?t:f);p=p.replace(/^(?:[ \t]*\*?[ \t]*(?:\r?\n|$))+/,"");let g=qa(p,0);p[g]==="*"&&(g=qa(p,g+1));let y=Cg(p,g,"TODO",!0);if(y!==-1){let v=p.slice(y);e.push({body:v.replace(/\s+$/,""),index:u})}n=h;continue}}else if(i==="#"){n=r(n,n+1);continue}else if(i==="-"&&n+1<t&&s[n+1]==="-"){n=r(n,n+2);continue}n++}return e}function bR(s){return s>=48&&s<=57||s>=65&&s<=90||s>=97&&s<=122||s===95}function qa(s,e){let t=e;for(;t<s.length;){let n=s.charCodeAt(t);if(n!==32&&n!==9)break;t++}return t}function Cg(s,e,t,n=!0){let r=s.slice(e,e+t.length),a=n?t.toUpperCase():t;if((n?r.toUpperCase():r)!==a)return-1;let o=s.charCodeAt(e+t.length);if(bR(o))return-1;let i=e+t.length;return(s[i]===":"||s[i]==="-")&&i++,i=qa(s,i),i}var Wa=G(require("vscode")),Ua=class{provideCodeLenses(e,t){let n=e.getText(),r=[];for(let{index:a,body:o}of Rg(n)){if(t?.isCancellationRequested)break;let i=e.positionAt(a),c=new Wa.Range(i,i);r.push(new Wa.CodeLens(c,{title:"Implement with Codex",command:"chatgpt.implementTodo",arguments:[{fileName:encodeURIComponent(e.uri.fsPath),line:i.line+1,comment:o}]}))}return r}};Pe();Re();var Va=class{constructor(e){this.codexWebviewProvider=e}async handleUri(e){T().info(`Handling URI: ${e.path}`);try{await Vt();let t=e.path||"/";this.codexWebviewProvider.navigateToRoute(t)}catch(t){T().error(`Failed to handle URI ${e.toString()}: ${t instanceof Error?t.message:String(t)}`)}}};var Ha=class{userAgent=null;getUserAgent(){return this.userAgent}setUserAgent(e){this.userAgent=e}};Ze();Re();var Le=G(require("vscode")),IR="chatgpt.newChat",kR="chatgpt.newCodexPanel",OR="sessionsViewPromotion";async function DR(s){let{subscriptions:e}=s;e.push(T()),T().info("Activating Codex extension");let t=new ja;e.push(t);let n=ze(De.USE_EXPERIMENTAL_MCP_LSP_SERVER,!1),r=null;if(n){let j=s.extension.packageJSON.version;r=await Eg(j,s.extensionUri),e.push(r)}let a=async()=>r?r.getCodexConfig():null,o=new Ha,i=new $n(s);e.push(i);let c=new qn(s),u=await c.get(rt.WINDOWS_SANDBOX_ENABLED)??!1,d=new An(s.extensionUri,o,u);e.push(d);let f=d.startCodexProcess();!f.success&&f.errorMessage&&T().error(f.errorMessage);let h=new Dn(d);e.push(h);let p=$R(d,i,h,c,e),g=nc(d),y=new Un;e.push(y);let v=new Fn(g,y,c,i,a),w=new Cn(g,v,o),C=new _n,E=new Ht(s.extensionUri,d,w,y,i,h,p??void 0,a,C);e.push(E);let R=new Va(E);if(e.push(Le.window.registerUriHandler(R)),e.push(Le.window.registerWebviewViewProvider(Ht.viewType,E,{webviewOptions:{retainContextWhenHidden:!0}})),e.push(Le.window.registerCustomEditorProvider(Ht.customEditorViewType,E,{webviewOptions:{retainContextWhenHidden:!0},supportsMultipleEditorsPerDocument:!1})),e.push(Le.commands.registerCommand("chatgpt.openSidebar",Vt)),e.push(Le.commands.registerCommand(kR,async j=>{j?.source===OR&&await c.update(rt.SHOW_COPILOT_LOGIN_FIRST,!0),E.createNewPanel()})),e.push(Le.commands.registerCommand("chatgpt.addToThread",async()=>rc(E))),e.push(Le.commands.registerCommand(IR,async()=>{await Vt(),E.triggerNewChatViaWebview()})),ze(De.COMMENT_CODELENS_ENABLED,!0)){let j=new Ua,V=[{scheme:"file"},{scheme:"untitled"}];e.push(Le.languages.registerCodeLensProvider(V,j))}ze(De.OPEN_ON_STARTUP,!1)&&Vt(),process.platform==="win32"&&e.push(Le.workspace.onDidChangeConfiguration(j=>{j.affectsConfiguration(`chatgpt.${De.RUN_CODEX_IN_WSL}`)&&(T().info("RUN_CODEX_IN_WSL changed, reloading window"),Le.commands.executeCommand("workbench.action.reloadWindow"))})),e.push(Le.commands.registerCommand("chatgpt.dumpNuxState",()=>{c.dumpNuxState()}),Le.commands.registerCommand("chatgpt.resetNuxState",()=>{c.resetNuxState()})),process.platform==="darwin"&&(async()=>{try{let j=await Promise.resolve().then(()=>(yv(),vv));typeof j.activate=="function"&&(j.activate(s),T().info("Work with apps desktop bridge initialized"))}catch(j){T().warn("Desktop bridge init failed: "+(j instanceof Error?j.message:String(j)))}})()}function $R(s,e,t,n,r){try{let a=new vn(s,e,t,n);return r.push(a),r.push(Le.chat.registerChatSessionItemProvider(Br,a)),a}catch(a){return T().info("Codex chat session item provider not registered: "+(a instanceof Error?a.message:String(a))),null}}0&&(module.exports={activate});
/*! Bundled license information:

uri-js/dist/es5/uri.all.js:
  (** @license URI.js v4.4.1 (c) 2011 Gary Court. License: http://github.com/garycourt/uri-js *)
*/
