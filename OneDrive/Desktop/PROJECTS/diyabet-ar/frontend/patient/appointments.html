<!doctype html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="utf-8">
  <script>
  const API_BASE_URL = "http://localhost:3001";
  window.API_BASE = API_BASE_URL + "/api";
</script>

  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>Ù…ÙˆØ§Ø¹ÙŠØ¯ÙŠ</title>

  <!-- Styles -->
  <link rel="stylesheet" href="../assets/css/patient-dashboard.css">
  <link rel="stylesheet" href="../assets/css/history.css">
  <link rel="stylesheet" href="../assets/css/appointments.css">
  <link rel="stylesheet" href="../assets/css/search.css">

    <style>
      /* Force Western numerals in Flatpickr input fields */
      input.flatpickr-input, input[type="text"].flatpickr-input {
        font-family: Arial, Helvetica, 'Liberation Sans', 'DejaVu Sans', sans-serif !important;
        font-variant-numeric: normal !important;
        direction: ltr !important;
        unicode-bidi: plaintext !important;
      }
      .flatpickr-current-month,
      .flatpickr-monthDropdown-months,
      .flatpickr-monthDropdown-years,
      .flatpickr-monthDropdown-month,
      .flatpickr-monthDropdown-year,
      .flatpickr-months .flatpickr-month,
      .flatpickr-monthDropdown-year input,
      .flatpickr-monthDropdown-month input,
      .flatpickr-monthDropdown-years input,
      .flatpickr-current-month input.cur-year {
        font-family: Arial, Helvetica, 'Liberation Sans', 'DejaVu Sans', sans-serif !important;
        font-variant-numeric: normal !important;
        direction: ltr !important;
        unicode-bidi: plaintext !important;
      }
      /* Force Western numerals for all Flatpickr numbers */
      .flatpickr-calendar * {
        font-family: Arial, Helvetica, 'Liberation Sans', 'DejaVu Sans', sans-serif !important;
        font-variant-numeric: normal !important;
        direction: ltr !important;
        unicode-bidi: plaintext !important;
      }
    </style>

    <!-- Flatpickr CSS/JS for Arabic date picker -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/flatpickr/dist/flatpickr.min.css">
    <script src="https://cdn.jsdelivr.net/npm/flatpickr"></script>
    <script src="https://cdn.jsdelivr.net/npm/flatpickr/dist/l10n/ar.js"></script>

  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600&display=swap" rel="stylesheet">
</head>

<body>

<!-- HEADER -->
<header class="pd-header">
  <div class="pd-header-inner">
    <div class="pd-left">
      <a href="/" class="logo">Ø£Ù†Ø§ Ù…Ø±ÙŠØ¶ Ø³ÙƒØ±ÙŠ</a>
    </div>
    <div class="pd-center">
      <button class="icon-btn search-btn" aria-label="Ø¨Ø­Ø«">ğŸ”</button>
    </div>
    <div class="pd-right">
      <button class="icon-btn chat-btn" id="chatBtn" aria-label="Ù…Ø­Ø§Ø¯Ø«Ø©" title="Ù…Ø­Ø§Ø¯Ø«Ø© Ù…Ø¹ Ø§Ù„Ø·Ø¨ÙŠØ¨">ğŸ’¬</button>
    </div>
  </div>
</header>

<main class="pd-main">

  <!-- SIDEBAR -->
  <aside class="pd-sidebar">
    <nav class="pd-nav">
      <ul>
        <li data-nav="daily">
          <span class="mc-icon">ğŸ©º</span>
          <span class="mc-title">Ø§Ù„Ù‚ÙŠØ§Ø³Ø§Øª Ø§Ù„ÙŠÙˆÙ…ÙŠØ©</span>
        </li>
        <li data-nav="history">
          <span class="mc-icon">ğŸ“„</span>
          <span class="mc-title">Ø³Ø¬Ù„ Ø§Ù„Ù‚ÙŠØ§Ø³Ø§Øª</span>
        </li>
        <li data-nav="appointments" class="active">
          <span class="mc-icon">ğŸ“…</span>
          <span class="mc-title">Ù…ÙˆØ§Ø¹ÙŠØ¯ÙŠ</span>
        </li>
        <li data-nav="prescriptions">
          <span class="mc-icon">ğŸ’Š</span>
          <span class="mc-title">ÙˆØµÙØ§ØªÙŠ</span>
        </li>
        <li data-nav="labs">
          <span class="mc-icon">ğŸ”¬</span>
          <span class="mc-title">Ù†ØªØ§Ø¦Ø¬ Ø§Ù„Ù…Ø®ØªØ¨Ø±</span>
        </li>
        <li data-nav="carb">
          <span class="mc-icon">ğŸ</span>
          <span class="mc-title">Ø­Ø§Ø³Ø¨Ø© Ø§Ù„ÙƒØ±Ø¨ÙˆÙ‡ÙŠØ¯Ø±Ø§Øª</span>
        </li>
        <li data-nav="personal-settings">
          <span class="mc-icon">âš™ï¸</span>
          <span class="mc-title">Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ø´Ø®ØµÙŠØ©</span>
        </li>
      </ul>
    </nav>

    <div style="margin-top:32px;text-align:center;">
      <button id="logoutBtn"
                    class="btn btn-outline"
                    style="min-width:120px;font-size:1rem;padding:10px 24px;border-radius:8px;">ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬</button>
    </div>
  </aside>

  <!-- CONTENT -->
  <section class="pd-content">

    <div class="card title-card">
      <h1>Ù…ÙˆØ§Ø¹ÙŠØ¯ÙŠ</h1>
      <div style="margin-top:12px;text-align:right">
        <button id="btn-request"
                class="btn btn-primary">Ø·Ù„Ø¨ Ù…ÙˆØ¹Ø¯ Ø¬Ø¯ÙŠØ¯</button>
      </div>
    </div>

    <div class="card results-card">
      <div id="appointments-list"></div>
      <div id="no-appointments"
           class="no-results">Ù„Ø§ ØªÙˆØ¬Ø¯ Ù…ÙˆØ§Ø¹ÙŠØ¯ Ù‚Ø§Ø¯Ù…Ø©.</div>
    </div>

  </section>
</main>

<!-- MODAL -->
<div id="request-modal" class="modal hidden" aria-hidden="true">
  <div class="modal-dialog card">

    <div class="card-header">
      <h2>Ø·Ù„Ø¨ Ù…ÙˆØ¹Ø¯ Ø¬Ø¯ÙŠØ¯</h2>
      <button id="modal-close" class="icon-btn" aria-label="Ø¥ØºÙ„Ø§Ù‚">âœ–</button>
    </div>

    <div class="card-body">
      <form id="appointment-request-form" class="appointment-form">

        <div class="form-group">
          <label>ØªØ§Ø±ÙŠØ® Ø§Ù„Ù…ÙˆØ¹Ø¯</label>
          <input id="requestedDate" type="text" placeholder="Ø§Ø®ØªØ± Ø§Ù„ØªØ§Ø±ÙŠØ®" autocomplete="off" required>
          <small>ÙŠØ±Ø¬Ù‰ Ø§Ø®ØªÙŠØ§Ø± ØªØ§Ø±ÙŠØ® Ù…Ø³ØªÙ‚Ø¨Ù„ÙŠ</small>
        </div>

        <div class="form-group">
          <label>Ø§Ù„ÙˆÙ‚Øª</label>
          <input id="requestedTime" type="text" placeholder="Ø§Ø®ØªØ± Ø§Ù„ÙˆÙ‚Øª" autocomplete="off" required readonly style="background:#f9f9f9;cursor:pointer;">
          <div id="slot-grid" style="margin:10px 0 0 0;"></div>
          <small>Ø§Ù„Ø£ÙˆÙ‚Ø§Øª Ø§Ù„Ø®Ø¶Ø±Ø§Ø¡ Ù…ØªØ§Ø­Ø©ØŒ ÙˆØ§Ù„Ø£ÙˆÙ‚Ø§Øª Ø§Ù„Ø­Ù…Ø±Ø§Ø¡ Ù…Ø­Ø¬ÙˆØ²Ø©.</small>
        </div>

        <div class="form-group">
          <label>Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø¥Ø¶Ø§ÙÙŠØ© (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)</label>
          <textarea id="note"
                    rows="4"
                    maxlength="500"
                    placeholder="Ø§ÙƒØªØ¨ Ø§Ù„Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„ØªÙŠ ØªØ±ÙŠØ¯ Ø¥Ø±Ø³Ø§Ù„Ù‡Ø§ Ø¥Ù„Ù‰ Ø·Ø¨ÙŠØ¨Ùƒ..."></textarea>
          <small id="char-count">0 / 500</small>
        </div>

        <div class="form-actions">
          <button type="submit" class="btn btn-primary btn-lg">Ø·Ù„Ø¨ Ù…ÙˆØ¹Ø¯ Ø¬Ø¯ÙŠØ¯</button>
          <button type="button"
                    id="modal-cancel"
                    class="btn btn-secondary btn-lg">Ø¥Ù„ØºØ§Ø¡</button>
        </div>

        <div class="form-note">
          <small>Ø³ÙŠØªÙ… Ø¥Ø±Ø³Ø§Ù„ Ø·Ù„Ø¨ Ø§Ù„Ù…ÙˆØ¹Ø¯ Ø¥Ù„Ù‰ Ø·Ø¨ÙŠØ¨Ùƒ. Ø³ÙŠØªÙ… Ø§Ù„Ø±Ø¯ Ø¹Ù„ÙŠÙƒ ÙÙŠ Ø£Ù‚Ø±Ø¨ ÙˆÙ‚Øª Ù…Ù…ÙƒÙ†.</small>
        </div>

      </form>
    </div>
  </div>
</div>

<!-- SCRIPTS -->

<script src="../assets/js/main.js"></script>
<script src="../assets/js/auth-guard.js"></script>
<script src="../assets/js/search.js"></script>
<script src="../assets/js/appointments.js"></script>
<script>
  document.addEventListener('DOMContentLoaded', function() {
    if (window.flatpickr) {
      flatpickr("#requestedDate", { dateFormat: "Y-m-d", locale: "ar" });
      // Removed Flatpickr time picker for #requestedTime to avoid interference with slot grid
    }
  });
</script>
<script src="settings.js"></script>

<script>
  document.addEventListener('DOMContentLoaded', function() {
    if (window.flatpickr) {
      flatpickr("#requestedDate", { dateFormat: "Y-m-d", locale: "ar" });
    }
  });
</script>
</body>
</html>
